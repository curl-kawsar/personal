{"version":3,"sources":["i18n.tsx","store/reducers/book.tsx","store/reducers/manager.tsx","store/reducers/progressPanel.tsx","utils/otherUtil.tsx","store/reducers/reader.tsx","store/reducers/viewArea.tsx","store/reducers/sidebar.tsx","store/reducers/backupPage.tsx","store/index.tsx","store/actions/manager.tsx","store/actions/reader.tsx","store/actions/sidebar.tsx","constants/readerConfig.tsx","containers/sidebar/component.tsx","containers/sidebar/index.tsx","store/actions/backupPage.tsx","components/searchBox/component.tsx","components/searchBox/index.tsx","model/Book.ts","utils/recordRecent.tsx","utils/mobiUtil.js","components/importLocal/component.tsx","components/importLocal/index.tsx","components/updateInfo/component.tsx","components/updateInfo/index.tsx","containers/header/component.tsx","containers/header/index.tsx","store/actions/book.tsx","utils/deleteUtil.tsx","utils/shelfUtil.tsx","utils/recordLocation.tsx","utils/addFavorite.tsx","containers/deleteDialog/component.tsx","containers/deleteDialog/index.tsx","containers/editDialog/component.tsx","containers/editDialog/index.tsx","containers/addDialog/component.tsx","containers/addDialog/index.tsx","containers/sortDialog/component.tsx","containers/sortDialog/index.tsx","containers/messageBox/component.tsx","containers/messageBox/index.tsx","utils/restoreUtil.tsx","utils/syncUtils/dropbox.tsx","utils/backupUtil.tsx","components/tokenDialog/component.tsx","components/tokenDialog/index.tsx","containers/backupDialog/component.tsx","containers/backupDialog/index.tsx","containers/welcomeDialog/component.tsx","containers/welcomeDialog/index.tsx","components/updataDialog/component.tsx","components/updataDialog/index.tsx","components/settingDialog/component.tsx","components/settingDialog/index.tsx","containers/actionDialog/component.tsx","containers/actionDialog/index.tsx","components/bookCardtem/component.tsx","components/bookCardtem/index.tsx","components/bookListItem/component.tsx","components/bookListItem/index.tsx","utils/sortUtil.tsx","components/deletePopup/component.tsx","components/deletePopup/index.tsx","containers/emptyPage/component.tsx","containers/emptyPage/index.tsx","containers/bookList/component.tsx","containers/bookList/index.tsx","containers/bookmarkPage/component.tsx","containers/bookmarkPage/index.tsx","store/actions/viewArea.tsx","utils/tagUtil.tsx","components/deleteIcon/component.tsx","components/deleteIcon/index.tsx","components/cardList/component.tsx","components/cardList/index.tsx","components/noteTag/component.tsx","components/noteTag/index.tsx","containers/noteList/component.tsx","containers/noteList/index.tsx","containers/digestList/component.tsx","containers/digestList/index.tsx","containers/loadingPage/component.tsx","containers/loadingPage/index.tsx","router/routes.tsx","pages/manager/component.tsx","pages/manager/index.tsx","store/actions/progressPanel.tsx","model/Note.ts","components/popupNote/component.tsx","components/popupNote/index.tsx","components/colorOption/component.tsx","components/colorOption/index.tsx","components/popupOption/component.tsx","components/popupOption/index.tsx","components/popupTrans/component.tsx","components/popupTrans/index.tsx","containers/popupMenu/component.tsx","containers/popupMenu/index.tsx","utils/styleUtil.tsx","components/imageViewer/component.tsx","components/imageViewer/index.tsx","containers/viewArea/component.tsx","containers/viewArea/index.tsx","containers/background/component.tsx","containers/background/index.tsx","components/themeList/component.tsx","components/themeList/index.tsx","components/sliderList/component.tsx","components/sliderList/index.tsx","components/dropdownList/component.tsx","components/dropdownList/index.tsx","components/modeControl/component.tsx","components/modeControl/index.tsx","containers/settingPanel/component.tsx","containers/settingPanel/index.tsx","components/contentList/component.tsx","components/contentList/index.tsx","components/navList/component.tsx","components/navList/index.tsx","containers/navigationPanel/component.tsx","containers/navigationPanel/index.tsx","model/Bookmark.ts","utils/readingTime.tsx","containers/operationPanel/component.tsx","containers/operationPanel/index.tsx","containers/progressPanel/component.tsx","containers/progressPanel/index.tsx","utils/mouseEvent.tsx","containers/epubViewer/component.tsx","containers/epubViewer/index.tsx","pages/epubReader/component.tsx","pages/epubReader/index.tsx","utils/syncUtils/common.tsx","pages/redirect/component.tsx","pages/redirect/index.tsx","router/index.tsx","serviceWorker.ts","index.tsx"],"names":["resources","en","translation","zh","cht","i18n","use","detector","reactI18nextModule","init","lng","fallbackLng","keySeparator","interpolation","escapeValue","initState","isOpenEditDialog","isOpenDeleteDialog","isOpenAddDialog","isOpenActionDialog","isReading","currentBook","currentEpub","books","searchResults","isSearch","isSort","isFirst","isSettingOpen","isList","isSortDisplay","sortCode","sort","order","isMessage","message","percentage","locations","OtherUtil","list","keyWord","arr","i","length","match","push","arr1","arr2","_arr","flag","j","keyword","document","querySelector","value","bookNameArr","AuthorNameArr","forEach","item","name","toLowerCase","author","bookResults","this","fuzzyQuery","authorResults","MergeArray","event","keyCode","target","notes","noteArr","textArr","text","noteResults","textResults","orderCode","json","localStorage","getItem","JSON","stringify","obj","parse","setItem","key","readerConfig","bookmarks","digests","chapters","currentChapter","flattenChapters","color","noteKey","originalText","readerMode","getReaderConfig","selection","isOpenMenu","menuMode","isChangeDirection","isShowBookmark","mode","shelfIndex","isBackup","isOpenTokenDialog","rootReducer","combineReducers","book","state","action","type","payload","isRedirect","manager","reader","section","progressPanel","viewArea","isOpenHighlight","dialogLocation","sidebar","backupPage","store","createStore","compose","applyMiddleware","thunk","window","devToolsExtension","f","handleSearchResults","handleSearch","handleSetting","handleMessage","handleMessageBox","isShow","handleSortDisplay","handleFirst","handleSortCode","handleFetchBooks","dispatch","localforage","err","a","handleFetchList","handleBookmarks","handleNoteKey","handleFetchNotes","filter","handleFetchBookmarks","handleShelfIndex","handleMode","themeList","id","theme","updateLog","dropdownList","title","option","sideMenu","icon","config","callback_url","token_url","dropbox_client_id","googledrive_client_id","onedrive_client_id","driveList","url","emptyList","main","sub","welcomeMessage","Sidebar","props","handleSidebar","index","setState","isCollapse","history","indexOf","className","src","alt","map","onClick","React","Component","withRouter","actionCreator","connect","withNamespaces","handleBackupDialog","handleTokenDialog","SearchBox","handleMouse","refs","searchBox","isNavSearch","search","results","tabMode","MouseNoteSearch","MouseSearch","handleSearchState","handleKey","KeyNoteSearch","KeySearch","q","doSearch","then","result","searchList","excerpt","replace","handleSearchList","Promise","all","spine","spineItems","load","bind","find","finally","unload","resolve","concat","apply","handleCancel","focus","style","position","ref","onKeyDown","onFocus","placeholder","width","height","paddingRight","right","Book","description","md5","cover","RecordRecent","bookKey","bookArr","splice","unshift","ab2str","buf","ArrayBuffer","Uint8Array","TextDecoder","decode","domParser","DOMParser","Buffer","capacity","fragment_list","cur_fragment","Fragment","byte","write","idx","fi","frag","size","get","s","total_buffer","offset","full","set","buffer","slice","MobiFile","data","view","DataView","header","v","getUint8","getUint16","getUint32","_of","flags","pos","extra","res","buffer_get_varlen","l","byte_count","shift","text_end","palm_header","record_count","buffers","read_text_record","total_size","copagesne_uint8array","mobi_header","extra_flags","begin","reclist","end","ex","get_record_extrasize","compression","char","next","distance","lz_length","buffer_size","uncompression_lz77","shrink","first_image_idx","Blob","load_pdbheader","load_reclist","load_record0","getStr","attr","version","ctime","mtime","btime","mod_num","appinfo_offset","sortinfo_offset","creator","uid","next_rec","record_num","record","load_record0_header","load_mobi_header","p_header","first_record","setoffset","skip","text_length","record_size","encryption_type","start_offset","identifier","header_length","mobi_type","text_encoding","generator_version","first_nonbook_index","full_name_offset","full_name_length","language","input_language","output_language","min_version","huff_rec_index","huff_rec_count","datp_rec_index","datp_rec_count","exth_flags","drm_offset","drm_count","drm_size","drm_flags","content","read_text","bookDoc","parseFromString","documentElement","pages","Array","from","getElementsByTagName","parseContent","len","childNodes","innerText","join","imgDoms","imgDom","getAttribute","blob","read_image","imgReader","FileReader","onload","e","readAsDataURL","pdfjsLib","ImportLocal","handleAddBook","reject","setRecent","catch","doIncrementalTest","file","blobSlice","File","prototype","mozSlice","webkitSlice","chunks","Math","ceil","currentChunk","spark","SparkMD5","fileReader","Error","appendBinary","loadNext","handleBook","start","readAsBinaryString","call","extension","split","isRepeat","readAsArrayBuffer","getDocument","promise","pdfDoc_","pdfDoc","getMetadata","metadata","getPage","page","viewport","getViewport","scale","canvas","getElementById","context","getContext","viewBox","render","canvasContext","toDataURL","info","Title","Author","Date","getTime","BookModel","console","log","isElectron","file_content","iconv","encode","blobTemp","fileTemp","lastModified","formData","FormData","append","axios","post","headers","responseType","epub","ePub","loaded","coverUrl","fetch","r","onloadend","require","ipcRenderer","sendSync","onDrop","acceptedFiles","accept","multiple","getRootProps","getInputProps","UpdateInfo","handleJump","shell","openExternal","downlownLink","compareVersion","ver1","ver2","ver1Arr","ver2Arr","parseInt","download","navigator","platform","display","Header","handleSortBooks","isOnlyLocal","isBookImported","isNewVersion","href","rel","handleEditDialog","handleDeleteDialog","handleAddDialog","handleActionDialog","handleReadingState","handleReadingBook","handleReadingEpub","DeleteUtil","defaultShelf","New","Study","Work","Entertainment","ShelfUtil","shelfTitle","undefined","currentShelfTitle","Object","keys","RecordLocation","cfi","AddFavorite","DeleteDialog","handleDeleteOther","bookmarkArr","deleteBookmarks","removeItem","deleteNotes","handleComfirm","clearShelf","deleteBook","clear","deletefromAllShelf","EditDialog","isCheck","nameBox","authorBox","AddDialog","inputElement","shelfList","getShelf","shelfTitles","isNew","hasOwnProperty","setShelf","handleChange","onChange","t","renderShelfList","disabled","SortDialog","handleSort","code","setSortCode","handleOrder","onMouseLeave","MessageBox","JSZip","RestoreUtil","importBooks","handleFinish","zip","loadAsync","files","async","restore","Dropbox","DropboxUitl","showMessage","ACCESS_TOKEN","accessToken","filesUpload","path","contents","response","error","filesDownload","fileBlob","lastModifiedDate","BackupUtil","backup","driveIndex","epubZip","folder","year","getFullYear","month","getMonth","day","getDate","generateAsync","FileSaver","saveAs","DropboxUtil","UploadFile","TokenDialog","token","setReaderConfig","driveName","copy","BackupDialog","handleClose","currentStep","handleRestoreToLocal","preventDefault","handleDrive","currentDrive","DownloadFile","dialogProps","opacity","marginLeft","WelcomeDialog","handleSkip","handleCloseWelcome","handlePrevious","currentIndex","handleNext","isOpenWelcome","left","backgroundColor","UpdateDialog","renderList","handleUpdateDialog","SettingDialog","changeLanguage","handleChangeTouch","isTouch","open","handleChangeFont","isUseFont","handleExpandContent","isExpandContent","handleChangeOpen","isOpenBook","handleChangeBackground","isUseBackground","handleFooterHeader","isShowFooter","float","ActionDialog","handleDeleteBook","handleEditBook","handleAddShelf","top","BookCardItem","handleMoreAction","x","clientX","body","clientWidth","clientY","handleLoveBook","setFavorite","isFavorite","handleCancelLoveBook","handleConfig","isOpenConfig","RecentBooks","location","getAllFavorite","getAllRecent","actionProps","onMouseOver","BookListItem","isDeleteDialog","getCfi","round","BookItem","getBookName","nameArr","getBookIndex","oldNameArr","indexArr","SortUtil","reverse","DeletePopup","handleDeletePopup","handleDeleteOpearion","EmptyPage","visibility","BookList","handleOldVersion","reload","handleFavorite","items","itemArr","subItem","handleRecent","setAllRecent","handleFilter","renderBookList","handleShelf","sortBooks","zIndex","handleShelfItem","handleDeleteShelf","removeShelf","toString","selected","isOpenDelete","favoriteBooks","to","currentShelfList","deletePopupProps","BookmarkPage","handleRedirect","recordCfi","bookKeyArr","bookmarkObj","chapter","renderBookmarklistItem","handleOpenMenu","handleMenuMode","handleChangeDirection","handleShowBookmark","handleSelection","TagUtil","tagName","tagArr","DeleteIcon","handleDelete","deleteItems","getAllTags","deleteFunc","itemKey","handleChangeTag","deleteIndex","CardList","handleBookName","bookName","handleShowDelete","deleteKey","cards","cardArr","dateArr","date","temp","cardObj","card","cardProps","bottom","NoteTag","tagToIndex","tag","indextoTag","tagIndex","indexResult","handleTag","handleAddTag","isInput","setTags","handleInput","nextProps","onBlur","NoteList","filterTag","noteProps","DigestList","LoadingPage","marginTop","routes","component","Manager","timer","isUpdated","totalBooks","isAuthed","isError","isCopied","handleFetchSortCode","setTimeout","clearTimeout","updateDialogProps","isMobileOnly","ele","getSortCode","handlePercentage","Note","chapterIndex","range","PopupNote","noteIndex","textArea","currentLocation","rendition","chapterHref","label","trim","iframe","doc","contentDocument","charRange","rangy","getSelection","saveCharacterRanges","note","createNote","ColorOption","handleChangeOptiion","isLine","border","handleColor","borderBottom","About","PopupOption","handleNote","posY","rect","_layout","y","posX","rightEdge","popupMenu","setAttribute","handleCopy","execCommand","empty","handleTrans","sel","handleOriginalText","handleDigest","digest","PopupTrans","translatedText","script","createElement","head","appendChild","handleCallback","trans_result","dst","PopupMenu","highlighter","showNote","isFirstShow","cfiRange","getHighlighter","createHighlighter","ignoreWhiteSpace","elementTagName","elementProperties","onclick","getRangeAt","getBoundingClientRect","showMenu","handleClickHighlighter","currentTarget","dataset","stopPropagation","onElementCreate","element","applier","createClassApplier","addClassApplier","dialog","renderHighlighters","highlighters","highlightersByChapter","iWin","contentWindow","defaultView","removeAllHighlights","classes","restoreCharacterRanges","warn","highlightSelection","openMenu","isCollapsed","on","addEventListener","handleHighlight","PopupProps","styleUtil","css","getDefaultCss","background","textContent","colors","lines","ImageViewer","showImage","handleLeaveReader","parentNode","isShowImage","img","Image","direction","naturalWidth","naturalHeight","imageRatio","image","hideImage","handleZoomIn","zoomIndex","handleZoomOut","handleSave","toLocaleDateString","handleClock","rotateIndex","transform","handleCounterClock","StyleUtil","addDefaultCss","ViewArea","previourChapter","nextChapter","loading","percentageFromCfi","themes","default","popupMenuProps","handleEnterReader","Background","isSingle","prevPage","nextPage","handleFetchLocations","displayed","i18nKey","count","parseFloat","boxShadow","generate","ThemeList","currentBackgroundIndex","findIndex","handleChangeColor","SliderList","onValueChange","fontSize","onValueInput","defaultValue","max","maxValue","min","minValue","step","onInput","DropdownList","currentFontFamilyIndex","currentLineHeightIndex","children","handleView","fontFamily","ModeControl","handleChangeMode","SettingPanel","handleChangeAudio","isAudioOn","speechSynthesis","cancel","handleAudio","cfibase","cfistart","cfiend","getRange","msg","SpeechSynthesisUtterance","speak","onend","elapsedTime","isSupported","ContentList","navigation","toc","renderContentList","level","subitems","NavList","currentData","currentTab","bookmarkProps","onMouseEnter","cursor","floor","NavigationPanel","handleChangeTab","renderSearchList","Parser","renderSearchPage","startIndex","pageList","total","searchProps","margin","time","Bookmark","ReadingTime","OperationPanel","timeStamp","speed","isFullScreen","isBookmark","currentPercentage","timeLeft","now","handleExitFullScreen","handleFullScreen","de","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fullscreenElement","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","bookmark","close","abs","handleExit","handleAddBookmark","handleScreen","ProgressPanel","onProgressChange","cfiFromPercentage","onProgressInput","displayPercentage","currentChapterIndex","handleJumpChapter","handleJumpPage","currentPage","totalPage","onMouseUp","onTouchEnd","Hammer","MouseEvent","isFirefox","userAgent","lock","arrowKeys","prev","mouseFirefox","detail","mouseChrome","wheelDelta","gesture","bindEvent","Reader","messageTimer","tickTimer","isOpenSettingPanel","isOpenNavPanel","isOpenOperationPanel","isOpenProgressPanel","handleFetchPercentage","handleFetchChapters","renderTo","flow","snap","setInterval","clearInterval","setTime","renditionProps","handleChapters","flatChapter","newChapter","EpubReader","_","getParamsFromUrl","hashParams","hash","substring","exec","decodeURIComponent","Redirect","params","access_token","hot","_Redirect","Boolean","hostname","ReactDOM","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.cd00813c.chunk.js","sourcesContent":["import i18n from \"i18next\";\nimport { reactI18nextModule } from \"react-i18next\";\nimport detector from \"i18next-browser-languagedetector\";\nimport translationEN from \"./assets/locales/en/translation.json\";\nimport translationCN from \"./assets/locales/cn/translation.json\";\nimport translationTW from \"./assets/locales/tw/translation.json\";\n\n// the translations\nconst resources = {\n  en: {\n    translation: translationEN,\n  },\n  zh: {\n    translation: translationCN,\n  },\n  cht: {\n    translation: translationTW,\n  },\n};\n\ni18n\n  .use(detector)\n  .use(reactI18nextModule as any) // passes i18n down to react-i18next\n  .init({\n    resources,\n    lng: \"zh\",\n    fallbackLng: \"en\",\n    keySeparator: false, // we do not use keys in form messages.welcome\n    interpolation: {\n      escapeValue: false, // react already safes from xss\n    },\n  });\n\nexport default i18n;\n","const initState = {\n  isOpenEditDialog: false,\n  isOpenDeleteDialog: false,\n  isOpenAddDialog: false,\n  isOpenActionDialog: false,\n  isReading: false,\n  currentBook: {},\n  currentEpub: {},\n};\nexport function book(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_EDIT_DIALOG\":\n      return {\n        ...state,\n        isOpenEditDialog: action.payload,\n      };\n    case \"HANDLE_DELETE_DIALOG\":\n      return {\n        ...state,\n        isOpenDeleteDialog: action.payload,\n      };\n\n    case \"HANDLE_ADD_DIALOG\":\n      return {\n        ...state,\n        isOpenAddDialog: action.payload,\n      };\n    case \"HANDLE_ACTION_DIALOG\":\n      return {\n        ...state,\n        isOpenActionDialog: action.payload,\n      };\n    case \"HANDLE_READING_STATE\":\n      return {\n        ...state,\n        isReading: action.payload,\n      };\n    case \"HANDLE_READING_BOOK\":\n      return {\n        ...state,\n        currentBook: action.payload,\n      };\n\n    case \"HANDLE_READING_EPUB\":\n      return {\n        ...state,\n        currentEpub: action.payload,\n      };\n    case \"HANDLE_REDIRECT\":\n      return {\n        ...state,\n        isRedirect: true,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  books: null,\n  searchResults: [],\n  isSearch: false,\n  isSort: false,\n  isFirst: \"no\",\n  isSettingOpen: false,\n  isList: \"card\",\n  isSortDisplay: false,\n  sortCode: { sort: 2, order: 2 },\n  isMessage: false,\n  message: \"Add Successfully\",\n};\nexport function manager(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_BOOKS\":\n      return {\n        ...state,\n        books: action.payload,\n      };\n    case \"HANDLE_SEARCH_BOOKS\":\n      return {\n        ...state,\n        searchResults: action.payload,\n      };\n    case \"HANDLE_SEARCH\":\n      return {\n        ...state,\n        isSearch: action.payload,\n      };\n    case \"HANDLE_SETTING\":\n      return {\n        ...state,\n        isSettingOpen: action.payload,\n      };\n    case \"HANDLE_SORT\":\n      return {\n        ...state,\n        isSort: action.payload,\n      };\n    case \"HANDLE_FIRST\":\n      return {\n        ...state,\n        isFirst: action.payload,\n      };\n    case \"HANDLE_LIST\":\n      return {\n        ...state,\n        isList: action.payload,\n      };\n    case \"HANDLE_SORT_DISPLAY\":\n      return {\n        ...state,\n        isSortDisplay: action.payload,\n      };\n    case \"HANDLE_MESSAGE\":\n      return {\n        ...state,\n        message: action.payload,\n      };\n    case \"HANDLE_MESSAGE_BOX\":\n      return {\n        ...state,\n        isMessage: action.payload,\n      };\n    case \"HANDLE_SORT_CODE\":\n      return {\n        ...state,\n        sortCode: { sort: action.payload.sort, order: action.payload.order },\n      };\n    case \"HANDLE_NOTES\":\n      return {\n        ...state,\n        notes: action.payload,\n      };\n    case \"HANDLE_BOOKMARKS\":\n      return {\n        ...state,\n        bookmarks: action.payload,\n      };\n\n    default:\n      return state;\n  }\n}\n","const initState = {\n  percentage: null,\n  locations: null,\n};\nexport function progressPanel(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_PERCENTAGE\":\n      return {\n        ...state,\n        percentage: action.payload,\n      };\n\n    case \"HANDLE_SECTION\":\n      return {\n        ...state,\n        section: action.payload,\n      };\n    case \"HANDLE_LOCATIONS\":\n      return {\n        ...state,\n        locations: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","import BookModel from \"../model/Book\";\nimport NoteModel from \"../model/Note\";\n\nclass OtherUtil {\n  static fuzzyQuery(list: string[], keyWord: string) {\n    var arr = [];\n    for (var i = 0; i < list.length; i++) {\n      if (list[i].match(keyWord) != null) {\n        arr.push(i);\n      }\n    }\n    return arr;\n  }\n  static MergeArray(arr1: number[], arr2: number[]) {\n    var _arr = [];\n    for (let i = 0; i < arr1.length; i++) {\n      _arr.push(arr1[i]);\n    }\n    for (let i = 0; i < arr2.length; i++) {\n      var flag = true;\n      for (let j = 0; j < arr1.length; j++) {\n        if (arr2[i] === arr1[j]) {\n          flag = false;\n          break;\n        }\n      }\n      if (flag) {\n        _arr.push(arr2[i]);\n      }\n    }\n    return _arr;\n  }\n  static MouseSearch(books: BookModel[]) {\n    let keyword = (document.querySelector(\n      \".header-search-box\"\n    ) as HTMLInputElement).value;\n    let bookNameArr: string[] = [];\n    let AuthorNameArr: string[] = [];\n    books.forEach((item) => {\n      bookNameArr.push(item.name.toLowerCase());\n      AuthorNameArr.push(item.author.toLowerCase());\n    });\n    let bookResults = this.fuzzyQuery(bookNameArr, keyword);\n    let authorResults = this.fuzzyQuery(AuthorNameArr, keyword);\n    let results = this.MergeArray(bookResults, authorResults);\n    return results;\n  }\n  static KeySearch(event: any, books: BookModel[]) {\n    if (event && event.keyCode === 13) {\n      let bookNameArr: string[] = [];\n      let AuthorNameArr: string[] = [];\n      books.forEach((item) => {\n        bookNameArr.push(item.name.toLowerCase());\n        AuthorNameArr.push(item.author.toLowerCase());\n      });\n      let bookResults = this.fuzzyQuery(bookNameArr, event.target.value);\n      let authorResults = this.fuzzyQuery(AuthorNameArr, event.target.value);\n      let results = this.MergeArray(bookResults, authorResults);\n      return results;\n    }\n  }\n  static MouseNoteSearch(notes: NoteModel[]) {\n    let keyword = (document.querySelector(\n      \".header-search-box\"\n    ) as HTMLInputElement).value;\n    let noteArr: string[] = [];\n    let textArr: string[] = [];\n    notes.forEach((item: NoteModel) => {\n      noteArr.push(item.notes.toLowerCase());\n      textArr.push(item.text.toLowerCase());\n    });\n    let noteResults = this.fuzzyQuery(noteArr, keyword);\n    let textResults = this.fuzzyQuery(textArr, keyword);\n    let results = this.MergeArray(noteResults, textResults);\n    return results;\n  }\n  static KeyNoteSearch(event: any, notes: NoteModel[]) {\n    if (event && event.keyCode === 13) {\n      let noteArr: string[] = [];\n      let textArr: string[] = [];\n      notes.forEach((item: NoteModel) => {\n        noteArr.push(item.notes.toLowerCase());\n        textArr.push(item.text.toLowerCase());\n      });\n      let noteResults = this.fuzzyQuery(noteArr, event.target.value);\n      let textResults = this.fuzzyQuery(textArr, event.target.value);\n      let results = this.MergeArray(noteResults, textResults);\n      return results;\n    }\n  }\n  static setSortCode(sortCode: number, orderCode: number) {\n    let json =\n      localStorage.getItem(\"sordCode\") || JSON.stringify({ sort: 2, order: 2 });\n    let obj = json ? JSON.parse(json) : { sort: 2, order: 2 };\n    obj.sort = sortCode;\n    obj.order = orderCode;\n    localStorage.setItem(\"sortCode\", JSON.stringify(obj));\n  }\n\n  static getSortCode() {\n    let json =\n      localStorage.getItem(\"sordCode\") || JSON.stringify({ sort: 2, order: 2 });\n    let obj = JSON.parse(json) || { sort: 2, order: 2 };\n    return obj || null;\n  }\n  static getReaderConfig(key: string) {\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\n    return readerConfig[key];\n  }\n  static setReaderConfig(key: string, value: string) {\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\n    readerConfig[key] = value;\n    localStorage.setItem(\"readerConfig\", JSON.stringify(readerConfig));\n  }\n}\n\nexport default OtherUtil;\n","import OtherUtil from \"../../utils/otherUtil\";\nconst initState = {\n  bookmarks: [],\n  notes: [],\n  digests: [],\n  chapters: null,\n  currentChapter: \"\",\n  flattenChapters: null,\n  color: 0,\n  noteKey: \"\",\n  originalText: \"\",\n  readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\n};\nexport function reader(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_BOOKMARKS\":\n      return {\n        ...state,\n        bookmarks: action.payload,\n      };\n    case \"HANDLE_NOTES\":\n      return {\n        ...state,\n        notes: action.payload,\n      };\n    case \"HANDLE_ORIGINAL_TEXT\":\n      return {\n        ...state,\n        originalText: action.payload,\n      };\n    case \"HANDLE_COLOR\":\n      return {\n        ...state,\n        color: action.payload,\n      };\n    case \"HANDLE_NOTE_KEY\":\n      return {\n        ...state,\n        noteKey: action.payload,\n      };\n    case \"HANDLE_DIGESTS\":\n      return {\n        ...state,\n        digests: action.payload,\n      };\n    case \"HANDLE_SECTION\":\n      return {\n        ...state,\n        section: action.payload,\n      };\n    case \"HANDLE_CHAPTERS\":\n      return {\n        ...state,\n        chapters: action.payload,\n      };\n    case \"HANDLE_FLATTEN_CHAPTERS\":\n      return {\n        ...state,\n        flattenChapters: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  selection: null,\n  isOpenMenu: false,\n  menuMode: \"menu\",\n  isChangeDirection: false,\n  isShowBookmark: false,\n};\nexport function viewArea(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_OPEN_MENU\":\n      return {\n        ...state,\n        isOpenMenu: action.payload,\n      };\n    case \"HANDLE_OPEN_HIGHLIGHT\":\n      return {\n        ...state,\n        isOpenHighlight: action.payload,\n      };\n\n    case \"HANDLE_SHOW_BOOKMARK\":\n      return {\n        ...state,\n        isShowBookmark: action.payload,\n      };\n    case \"HANDLE_SELECTION\":\n      return {\n        ...state,\n        selection: action.payload,\n      };\n    case \"HANDLE_DIALOG_LOCATION\":\n      return {\n        ...state,\n        dialogLocation: action.payload,\n      };\n    case \"HANDLE_MENU_MODE\":\n      return {\n        ...state,\n        menuMode: action.payload,\n      };\n    case \"HANDLE_CHANGE_DIRECTION\":\n      return {\n        ...state,\n        isChangeDirection: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  mode: \"home\",\n  shelfIndex: -1,\n};\nexport function sidebar(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_MODE\":\n      return {\n        ...state,\n        mode: action.payload,\n      };\n    case \"HANDLE_SHELF_INDEX\":\n      return {\n        ...state,\n        shelfIndex: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  isBackup: false,\n  isOpenTokenDialog: false,\n};\nexport function backupPage(\n  state = initState,\n  action: { type: string; payload: boolean }\n) {\n  switch (action.type) {\n    case \"HANDLE_BACKUP\":\n      return {\n        ...state,\n        isBackup: action.payload,\n      };\n    case \"HANDLE_TOKEN_DIALOG\":\n      return {\n        ...state,\n        isOpenTokenDialog: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","import { createStore, applyMiddleware, compose, combineReducers } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport { book } from \"./reducers/book\";\nimport { manager } from \"./reducers/manager\";\nimport { progressPanel } from \"./reducers/progressPanel\";\nimport { reader } from \"./reducers/reader\";\nimport { viewArea } from \"./reducers/viewArea\";\nimport { sidebar } from \"./reducers/sidebar\";\nimport { backupPage } from \"./reducers/backupPage\";\nimport BookModel from \"../model/Book\";\nimport NoteModel from \"../model/Note\";\nimport BookmarkModel from \"../model/Bookmark\";\nconst rootReducer = combineReducers({\n  book,\n  manager,\n  reader,\n  progressPanel,\n  viewArea,\n  sidebar,\n  backupPage,\n});\nconst store = createStore(\n  rootReducer,\n  compose(\n    applyMiddleware(thunk),\n    (window as any).devToolsExtension\n      ? (window as any).devToolsExtension()\n      : (f: any) => f\n  )\n);\nexport default store;\nexport type stateType = {\n  manager: {\n    books: BookModel[];\n    searchResults: number[];\n    isSearch: boolean;\n    isSort: boolean;\n    isSettingOpen: boolean;\n    isFirst: string;\n    isList: string;\n    isSortDisplay: boolean;\n    sortCode: { sort: number; order: number };\n    isMessage: boolean;\n    message: string;\n  };\n  book: {\n    isOpenEditDialog: boolean;\n    isOpenDeleteDialog: boolean;\n    isOpenAddDialog: boolean;\n    isOpenActionDialog: boolean;\n    isReading: boolean;\n    currentBook: BookModel;\n    currentEpub: any;\n  };\n  backupPage: {\n    isBackup: boolean;\n    isOpenTokenDialog: boolean;\n  };\n  progressPanel: {\n    percentage: number;\n    locations: any[];\n  };\n  reader: {\n    bookmarks: BookmarkModel[];\n    notes: NoteModel[];\n    digests: NoteModel[];\n    color: number;\n    chapters: any[];\n    flattenChapters: any;\n    noteKey: string;\n    originalText: string;\n  };\n  sidebar: {\n    mode: string;\n    shelfIndex: number;\n  };\n  viewArea: {\n    selection: string;\n    menuMode: string;\n    isOpenMenu: boolean;\n    isChangeDirection: boolean;\n    isShowBookmark: boolean;\n  };\n};\n","import localforage from \"localforage\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport BookModel from \"../../model/Book\";\nimport BookmarkModel from \"../../model/Bookmark\";\nimport NoteModel from \"../../model/Note\";\nimport { Dispatch } from \"redux\";\n\ndeclare var window: any;\n\nexport function handleNotes(notes: NoteModel[]) {\n  return { type: \"HANDLE_NOTES\", payload: notes };\n}\nexport function handleBooks(books: BookModel[]) {\n  return { type: \"HANDLE_BOOKS\", payload: books };\n}\nexport function handleSearchResults(searchResults: number[]) {\n  return { type: \"HANDLE_SEARCH_BOOKS\", payload: searchResults };\n}\nexport function handleSearch(isSearch: boolean) {\n  return { type: \"HANDLE_SEARCH\", payload: isSearch };\n}\nexport function handleSetting(isSettingOpen: boolean) {\n  return { type: \"HANDLE_SETTING\", payload: isSettingOpen };\n}\nexport function handleList(mode: string) {\n  return { type: \"HANDLE_LIST\", payload: mode };\n}\nexport function handleMessage(message: string) {\n  return { type: \"HANDLE_MESSAGE\", payload: message };\n}\nexport function handleMessageBox(isShow: boolean) {\n  return { type: \"HANDLE_MESSAGE_BOX\", payload: isShow };\n}\nexport function handleSortDisplay(isSortDisplay: boolean) {\n  return { type: \"HANDLE_SORT_DISPLAY\", payload: isSortDisplay };\n}\nexport function handleSort(isSort: boolean) {\n  return { type: \"HANDLE_SORT\", payload: isSort };\n}\nexport function handleFirst(isFirst: string) {\n  return { type: \"HANDLE_FIRST\", payload: isFirst };\n}\nexport function handleSortCode(sortCode: { sort: number; order: number }) {\n  return { type: \"HANDLE_SORT_CODE\", payload: sortCode };\n}\n\nexport function handleBookmarks(bookmarks: BookmarkModel[]) {\n  return { type: \"HANDLE_BOOKMARKS\", payload: bookmarks };\n}\nexport function handleFetchBooks() {\n  return (dispatch: Dispatch) => {\n    localforage.getItem(\"books\", async (err, value) => {\n      let bookArr: any = value;\n      dispatch(handleBooks(bookArr));\n    });\n  };\n}\nexport function handleFetchSortCode() {\n  return (dispatch: Dispatch) => {\n    let sortCode = OtherUtil.getSortCode();\n    dispatch(handleSortCode(sortCode));\n  };\n}\nexport function handleFetchList() {\n  return (dispatch: Dispatch) => {\n    let isList = OtherUtil.getReaderConfig(\"isList\") || \"card\";\n    dispatch(handleList(isList));\n  };\n}\n","import localforage from \"localforage\";\nimport NoteModel from \"../../model/Note\";\nimport BookmarkModel from \"../../model/Bookmark\";\nexport function handleNotes(notes: NoteModel[]) {\n  return { type: \"HANDLE_NOTES\", payload: notes };\n}\nexport function handleOriginalText(originalText: string) {\n  return { type: \"HANDLE_ORIGINAL_TEXT\", payload: originalText };\n}\nexport function handleColor(color: number) {\n  return { type: \"HANDLE_COLOR\", payload: color };\n}\nexport function handleBookmarks(bookmarks: BookmarkModel[]) {\n  return { type: \"HANDLE_BOOKMARKS\", payload: bookmarks };\n}\nexport function handleDigests(digests: NoteModel[]) {\n  return { type: \"HANDLE_DIGESTS\", payload: digests };\n}\n\nexport function handleCurrentChapter(currentChapter: string) {\n  return { type: \"HANDLE_CURRENT_CHAPTER\", payload: currentChapter };\n}\nexport function handleChapters(chapters: any) {\n  return { type: \"HANDLE_CHAPTERS\", payload: chapters };\n}\nexport function handleFlattenChapters(flattenChapters: any) {\n  return { type: \"HANDLE_FLATTEN_CHAPTERS\", payload: flattenChapters };\n}\nexport function handleNoteKey(key: string) {\n  return { type: \"HANDLE_NOTE_KEY\", payload: key };\n}\nexport function handleFetchNotes() {\n  return (dispatch: (arg0: { type: string; payload: NoteModel[] }) => void) => {\n    localforage.getItem(\"notes\", (err, value) => {\n      let noteArr: any;\n      if (value === null || value === []) {\n        noteArr = [];\n      } else {\n        noteArr = value;\n      }\n      dispatch(handleNotes(noteArr));\n      dispatch(\n        handleDigests(\n          noteArr.filter((item: NoteModel) => {\n            return item.notes === \"\";\n          })\n        )\n      );\n    });\n  };\n}\nexport function flatChapter(chapters: any) {\n  let newChapter: any = [];\n  for (let i = 0; i < chapters.length; i++) {\n    if (chapters[i].subitems[0]) {\n      newChapter.push(chapters[i]);\n      newChapter = newChapter.concat(flatChapter(chapters[i].subitems));\n    } else {\n      newChapter.push(chapters[i]);\n    }\n  }\n  return newChapter;\n}\nexport function handleFetchChapters(epub: any) {\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\n    epub.loaded.navigation\n      .then((chapters: any) => {\n        dispatch(handleChapters(chapters.toc));\n        dispatch(handleFlattenChapters(flatChapter(chapters.toc)));\n      })\n      .catch(() => {\n        console.log(\"Error occurs\");\n      });\n  };\n}\nexport function handleFetchBookmarks() {\n  return (\n    dispatch: (arg0: { type: string; payload: BookmarkModel[] }) => void\n  ) => {\n    localforage.getItem(\"bookmarks\", (err, value) => {\n      let bookmarkArr: any;\n      if (value === null || value === []) {\n        bookmarkArr = [];\n      } else {\n        bookmarkArr = value;\n      }\n      dispatch(handleBookmarks(bookmarkArr));\n    });\n  };\n}\n","export function handleShelfIndex(shelfIndex: number) {\n  return { type: \"HANDLE_SHELF_INDEX\", payload: shelfIndex };\n}\n\nexport function handleMode(mode: string) {\n  return { type: \"HANDLE_MODE\", payload: mode };\n}\n","export const themeList = [\n  { id: 1, theme: \"rgba(235,255,231,1)\" },\n  { id: 2, theme: \"rgba(244,232,211,0.4)\" },\n  { id: 3, theme: \"rgba(242,219,187,0.8)\" },\n  { id: 4, theme: \"rgba(255,255,255,1)\" },\n  { id: 5, theme: \"rgba(44,47,49,1)\" },\n];\n\nexport const updateLog = {\n  date: \"2020.10.18\",\n  version: \"1.1.7\",\n  new: [\n    \"增加对 pdf 格式的支持，暂不支持笔记，书签等功能\",\n    \"增加对 mobi 格式的支持，仅客户端支持，暂不支持图片功能\",\n    \"增加对 txt 格式的支持，仅客户端支持\",\n    \"使用 React Router 重构代码\",\n    \"进一步减少内存占用\",\n    \"设置新增是否默认展开所有目录\",\n    \"网页版支持同时打开多本图书\",\n    \"客户端打开图书时，窗口自动最大化\",\n    \"技术原因，暂时下线了 OneDrive 同步功能\",\n  ],\n  fix: [\n    \"修复多级目录无法展开的问题\",\n    \"修复字体，字体大小换章失效的问题\",\n    \"修复进度条无法跳转的问题\",\n    \"修复英文界面的排版问题\",\n  ],\n};\n\nexport const dropdownList = [\n  {\n    id: 1,\n    title: \"Font Family\",\n    value: \"fontFamily\",\n    option: [\n      \"Helvetica\",\n      \"Times New Roman\",\n      \"Microsoft YaHei\",\n      \"SimSun\",\n      \"SimHei\",\n      \"Arial\",\n    ],\n  },\n  {\n    id: 2,\n    title: \"Line Height\",\n    value: \"lineHeight\",\n    option: [\"1.25\", \"1\", \"1.25\", \"1.5\", \"1.75\", \"2\"],\n  },\n];\nexport const sideMenu = [\n  {\n    name: \"All Books\",\n    icon: \"home\",\n    mode: \"home\",\n  },\n  {\n    name: \"My Favorites\",\n    icon: \"love\",\n    mode: \"favorite\",\n  },\n  {\n    name: \"My Bookmarks\",\n    icon: \"bookmark\",\n    mode: \"bookmark\",\n  },\n  {\n    name: \"My Notes\",\n    icon: \"idea\",\n    mode: \"note\",\n  },\n\n  {\n    name: \"My Digests\",\n    icon: \"digest\",\n    mode: \"digest\",\n  },\n];\nexport const config = {\n  callback_url:\n    process.env.NODE_ENV === \"production\"\n      ? \"https://reader.960960.xyz\"\n      : \"http://localhost:3000\",\n  token_url:\n    process.env.NODE_ENV === \"production\"\n      ? \"http://localhost:3366\"\n      : \"http://localhost:3366\",\n  dropbox_client_id: \"e3zgg310xbizvaf\",\n  googledrive_client_id:\n    \"99440516227-ifr1ann33f2j610i3ri17ej0i51c7m6e.apps.googleusercontent.com\",\n  onedrive_client_id: \"ac96f9bf-94f2-49c0-8418-999b919bc236\",\n};\nexport const driveList = [\n  {\n    id: 1,\n    name: \"Local\",\n    icon: \"local\",\n    url: \"\",\n  },\n  {\n    id: 2,\n    name: \"Dropbox\",\n    icon: \"dropbox\",\n    url: `https://www.dropbox.com/oauth2/authorize?response_type=token&client_id=${config.dropbox_client_id}&redirect_uri=${config.callback_url}`,\n  },\n\n  {\n    id: 3,\n    name: \"Google Drive\",\n    icon: \"googledrive\",\n    url: \"\",\n  },\n  // {\n  //   id: 4,\n  //   name: \"OneDrive\",\n  //   icon: \"onedrive\",\n  //   url: `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${config.onedrive_client_id}&scope=files.readwrite offline_access&response_type=code&redirect_uri=${config.callback_url}`,\n  // },\n  {\n    id: 5,\n    name: \"WebDav\",\n    icon: \"webdav\",\n    url: \"\",\n  },\n];\nexport const emptyList = [\n  {\n    mode: \"home\",\n    main: \"Empty Library\",\n    sub: \"Click the top-right button to add books\",\n  },\n  {\n    mode: \"favorite\",\n    main: \"No Favorite Books\",\n    sub:\n      \"Move your mouse on the top of any book, click the heart icon to add it to your favorite books\",\n  },\n  {\n    mode: \"bookmark\",\n    main: \"Empty Bookmark\",\n    sub: \"Move your mouse on the top edge of the reader\",\n  },\n  {\n    mode: \"note\",\n    main: \"Empty Note\",\n    sub: \"Select any text and click the Add-Note button on the popup Menu\",\n  },\n  {\n    mode: \"digest\",\n    main: \"Empty Digest\",\n    sub: \"Select any text and click the Collect button on the popup Menu\",\n  },\n  {\n    mode: \"shelf\",\n    main: \"Empty Shelf\",\n    sub: \"Move your mouse on the top of any book\",\n  },\n];\nexport const welcomeMessage = [\n  {\n    main: \"This is a free and open-source Epub reader\",\n    sub:\n      \"Koodo Reader works on multiple platforms with backup and restore support\",\n  },\n  {\n    main: \"For better reading experience\",\n    sub:\n      \"Supports for theme changing, reading history, book managerment, shelf managerment and more\",\n  },\n  {\n    main: \"Fluent and easy operation\",\n    sub:\n      \"Move your mouse to the edge of the reader to trigger menu,use mouse wheel and keyborad to switch pages\",\n  },\n  {\n    main: \"Go to Add your first book\",\n    sub: \"That's all for the tutorial\",\n  },\n];\n","import React from \"react\";\nimport \"./sidebar.css\";\nimport { sideMenu } from \"../../constants/readerConfig\";\nimport { Trans } from \"react-i18next\";\nimport { SidebarProps, SidebarState } from \"./interface\";\nimport { withRouter } from \"react-router-dom\";\n\nclass Sidebar extends React.Component<SidebarProps, SidebarState> {\n  constructor(props: SidebarProps) {\n    super(props);\n    this.state = {\n      index: [\"home\", \"favorite\", \"bookmark\", \"note\", \"digest\"].indexOf(\n        this.props.mode\n      ),\n      isCollapse: true,\n      shelfIndex: -1,\n    };\n  }\n  handleSidebar = (mode: string, index: number) => {\n    this.setState({ index: index });\n    this.setState({ shelfIndex: -1 });\n    this.setState({ isCollapse: true });\n    this.props.history.push(`/manager/${mode}`);\n    this.props.handleMode(mode);\n    this.props.handleSearch(false);\n  };\n  render() {\n    const renderSideMenu = () => {\n      return sideMenu.map((item, index) => {\n        return (\n          <li\n            key={item.name}\n            className={\n              this.state.index === index && this.state.shelfIndex === -1\n                ? \"active side-menu-item\"\n                : \"side-menu-item\"\n            }\n            id={`sidebar-${item.icon}`}\n            onClick={() => {\n              this.handleSidebar(item.mode, index);\n            }}\n          >\n            {this.state.index === index && this.state.shelfIndex === -1 ? (\n              <div className=\"side-menu-selector-container\"></div>\n            ) : null}\n            <div\n              className={\n                this.state.index === index && this.state.shelfIndex === -1\n                  ? \"side-menu-selector active-selector\"\n                  : \"side-menu-selector \"\n              }\n            >\n              <span\n                className={\n                  this.state.index === index && this.state.shelfIndex === -1\n                    ? `icon-${item.icon} side-menu-icon  active-icon`\n                    : `icon-${item.icon} side-menu-icon`\n                }\n              ></span>\n              <Trans>{item.name}</Trans>\n            </div>\n          </li>\n        );\n      });\n    };\n    return (\n      <div className=\"sidebar\">\n        <img\n          src={\n            process.env.NODE_ENV === \"production\"\n              ? \"./assets/logo.png\"\n              : \"../../assets/logo.png\"\n          }\n          alt=\"\"\n          className=\"logo\"\n        />\n        <div className=\"side-menu-container-parent\">\n          <ul className=\"side-menu-container\">{renderSideMenu()}</ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(Sidebar);\n","import { handleMode } from \"../../store/actions/sidebar\";\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport Sidebar from \"./component\";\nimport { handleSearch } from \"../../store/actions/manager\";\n\nconst mapStateToProps = (state: stateType) => {\n  return { mode: state.sidebar.mode };\n};\nconst actionCreator = { handleMode, handleSearch };\n\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(Sidebar as any));\n","export function handleBackupDialog(mode: boolean) {\n  return { type: \"HANDLE_BACKUP\", payload: mode };\n}\nexport function handleTokenDialog(mode: boolean) {\n  return { type: \"HANDLE_TOKEN_DIALOG\", payload: mode };\n}\n","//搜索框\nimport React from \"react\";\nimport \"./searchBox.css\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport { Trans } from \"react-i18next\";\nimport { SearchBoxProps } from \"./interface\";\nclass SearchBox extends React.Component<SearchBoxProps> {\n  componentDidMount() {\n    if (this.props.isNavSearch) {\n      let searchBox: any = document.querySelector(\".header-search-box\");\n      searchBox && searchBox.focus();\n    }\n  }\n  handleMouse = () => {\n    let value = (this.refs.searchBox as any).value;\n    if (this.props.isNavSearch) {\n      value && this.search(value);\n    }\n    if (this.props.mode === \"nav\") {\n      this.props.handleSearchState(true);\n      return;\n    }\n    let results =\n      this.props.tabMode === \"note\"\n        ? OtherUtil.MouseNoteSearch(\n            this.props.notes.filter((item) => item.notes !== \"\")\n          )\n        : this.props.tabMode === \"digest\"\n        ? OtherUtil.MouseNoteSearch(this.props.digests)\n        : OtherUtil.MouseSearch(this.props.books);\n    this.props.handleSearchResults(results);\n    this.props.handleSearch(true);\n  };\n  handleKey = (event: any) => {\n    if (event.keyCode !== 13) {\n      return;\n    }\n    let value = (this.refs.searchBox as any).value;\n    if (this.props.isNavSearch) {\n      value && this.search(value);\n    }\n    let results =\n      this.props.tabMode === \"note\"\n        ? OtherUtil.KeyNoteSearch(\n            event,\n            this.props.notes.filter((item) => item.notes !== \"\")\n          )\n        : this.props.tabMode === \"digest\"\n        ? OtherUtil.KeyNoteSearch(event, this.props.digests)\n        : OtherUtil.KeySearch(event, this.props.books);\n    if (results) {\n      this.props.handleSearchResults(results);\n      this.props.handleSearch(true);\n    }\n  };\n  search = (q: string) => {\n    this.doSearch(q).then((result) => {\n      let searchList = result.map((item: any) => {\n        item.excerpt = item.excerpt.replace(\n          q,\n          `<span class=\"content-search-text\">${q}</span>`\n        );\n        return item;\n      });\n      this.props.handleSearchList(searchList);\n    });\n  };\n  doSearch = (q: string) => {\n    return Promise.all(\n      this.props.currentEpub.spine.spineItems.map((item: any) =>\n        item\n          .load(this.props.currentEpub.load.bind(this.props.currentEpub))\n          .then(item.find.bind(item, q))\n          .finally(item.unload.bind(item))\n      )\n    ).then((results: any) => Promise.resolve([].concat.apply([], results)));\n  };\n  handleCancel = () => {\n    if (this.props.isNavSearch) {\n      this.props.handleSearchList(null);\n    }\n    this.props.handleSearch(false);\n    (document.querySelector(\".header-search-box\") as HTMLInputElement).value =\n      \"\";\n  };\n\n  render() {\n    return (\n      <div style={{ position: \"relative\" }}>\n        <input\n          type=\"text\"\n          ref=\"searchBox\"\n          className=\"header-search-box\"\n          onKeyDown={(event) => {\n            this.handleKey(event);\n          }}\n          onFocus={() => {\n            this.props.mode === \"nav\" && this.props.handleSearchState(true);\n          }}\n          placeholder={\n            this.props.isNavSearch || this.props.mode === \"nav\"\n              ? \"搜索全书\"\n              : this.props.tabMode === \"note\"\n              ? \"搜索我的笔记\"\n              : this.props.tabMode === \"digest\"\n              ? \"搜索我的书摘\"\n              : \"搜索我的书库\"\n          }\n          style={\n            this.props.mode === \"nav\"\n              ? { width: this.props.width, height: this.props.height }\n              : { paddingRight: \"50px\" }\n          }\n        />\n        {this.props.isSearch ? (\n          <span\n            className=\"header-search-text\"\n            onClick={() => {\n              this.handleCancel();\n            }}\n            style={this.props.mode === \"nav\" ? { right: \"-9px\" } : {}}\n          >\n            <Trans>Cancel</Trans>\n          </span>\n        ) : (\n          <span\n            className=\"icon-search header-search-icon\"\n            onClick={() => {\n              this.handleMouse();\n            }}\n            style={this.props.mode === \"nav\" ? { right: \"5px\" } : {}}\n          ></span>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default SearchBox;\n","import { connect } from \"react-redux\";\nimport { handleSearchResults, handleSearch } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport SearchBox from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    isSearch: state.manager.isSearch,\n    currentEpub: state.book.currentEpub,\n    tabMode: state.sidebar.mode,\n    shelfIndex: state.sidebar.shelfIndex,\n  };\n};\nconst actionCreator = {\n  handleSearchResults,\n  handleSearch,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(SearchBox as any));\n","class Book {\n  key: string;\n  name: string;\n  author: string;\n  description: string;\n  md5: string;\n  cover: string;\n  constructor(\n    key: string,\n    name: string,\n    author: string,\n    description: string,\n    md5: string,\n    cover: string\n  ) {\n    this.key = key; // 数据库的键\n    this.name = name; // 书籍名\n    this.author = author; // 作者\n    this.description = description; // 书籍的描述\n    this.md5 = md5; //epub的md5值，防止重复导入\n    this.cover = cover;\n  }\n}\n\nexport default Book;\n","// 记录书本打开记录\nimport BookModel from \"../model/Book\";\nclass RecordRecent {\n  static setRecent(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n  static setAllRecent(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n  static getAllRecent() {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default RecordRecent;\n","function ab2str(buf) {\n  if (buf instanceof ArrayBuffer) {\n    buf = new Uint8Array(buf);\n  }\n  return new TextDecoder(\"utf-8\").decode(buf);\n}\n\nvar domParser = new DOMParser();\n\nclass Buffer {\n  constructor(capacity) {\n    this.capacity = capacity;\n    this.fragment_list = [];\n    this.cur_fragment = new Fragment(capacity);\n    this.fragment_list.push(this.cur_fragment);\n  }\n  write(byte) {\n    var result = this.cur_fragment.write(byte);\n    if (!result) {\n      this.cur_fragment = new Fragment(this.capacity);\n      this.fragment_list.push(this.cur_fragment);\n      this.cur_fragment.write(byte);\n    }\n  }\n  get(idx) {\n    var fi = 0;\n    while (fi < this.fragment_list.length) {\n      var frag = this.fragment_list[fi];\n      if (idx < frag.size) {\n        return frag.get(idx);\n      }\n      idx -= frag.size;\n      fi += 1;\n    }\n    return null;\n  }\n  size() {\n    var s = 0;\n    for (var i = 0; i < this.fragment_list.length; i++) {\n      s += this.fragment_list[i].size;\n    }\n    return s;\n  }\n  shrink() {\n    var total_buffer = new Uint8Array(this.size());\n    var offset = 0;\n    for (var i = 0; i < this.fragment_list.length; i++) {\n      var frag = this.fragment_list[i];\n      if (frag.full()) {\n        total_buffer.set(frag.buffer, offset);\n      } else {\n        total_buffer.set(frag.buffer.slice(0, frag.size), offset);\n      }\n      offset += frag.size;\n    }\n    return total_buffer;\n  }\n}\n\nvar copagesne_uint8array = function (buffers) {\n  var total_size = 0;\n  for (let i = 0; i < buffers.length; i++) {\n    var buffer = buffers[i];\n    total_size += buffer.length;\n  }\n  var total_buffer = new Uint8Array(total_size);\n  var offset = 0;\n  for (let i = 0; i < buffers.length; i++) {\n    buffer = buffers[i];\n    total_buffer.set(buffer, offset);\n    offset += buffer.length;\n  }\n  return total_buffer;\n};\n\nclass Fragment {\n  constructor(capacity) {\n    this.buffer = new Uint8Array(capacity);\n    this.capacity = capacity;\n    this.size = 0;\n  }\n\n  write(byte) {\n    if (this.size >= this.capacity) {\n      return false;\n    }\n    this.buffer[this.size] = byte;\n    this.size += 1;\n    return true;\n  }\n  full() {\n    return this.size === this.capacity;\n  }\n  get(idx) {\n    return this.buffer[idx];\n  }\n}\n\nvar uncompression_lz77 = function (data) {\n  var length = data.length;\n  var offset = 0; // Current offset into data\n  var buffer = new Buffer(data.length);\n\n  while (offset < length) {\n    var char = data[offset];\n    offset += 1;\n\n    if (char === 0) {\n      buffer.write(char);\n    } else if (char <= 8) {\n      for (var i = offset; i < offset + char; i++) {\n        buffer.write(data[i]);\n      }\n      offset += char;\n    } else if (char <= 0x7f) {\n      buffer.write(char);\n    } else if (char <= 0xbf) {\n      var next = data[offset];\n      offset += 1;\n      var distance = (((char << 8) | next) >> 3) & 0x7ff;\n      var lz_length = (next & 0x7) + 3;\n\n      var buffer_size = buffer.size();\n      for (let i = 0; i < lz_length; i++) {\n        buffer.write(buffer.get(buffer_size - distance));\n        buffer_size += 1;\n      }\n    } else {\n      buffer.write(32);\n      buffer.write(char ^ 0x80);\n    }\n  }\n  return buffer;\n};\n\nclass MobiFile {\n  constructor(data) {\n    this.view = new DataView(data);\n    this.buffer = this.view.buffer;\n    this.offset = 0;\n    this.header = null;\n  }\n\n  parse() {}\n\n  getUint8() {\n    var v = this.view.getUint8(this.offset);\n    this.offset += 1;\n    return v;\n  }\n\n  getUint16() {\n    var v = this.view.getUint16(this.offset);\n    this.offset += 2;\n    return v;\n  }\n\n  getUint32() {\n    var v = this.view.getUint32(this.offset);\n    this.offset += 4;\n    return v;\n  }\n\n  getStr(size) {\n    var v = ab2str(this.buffer.slice(this.offset, this.offset + size));\n    this.offset += size;\n    return v;\n  }\n\n  skip(size) {\n    this.offset += size;\n  }\n\n  setoffset(_of) {\n    this.offset = _of;\n  }\n\n  get_record_extrasize(data, flags) {\n    var pos = data.length - 1;\n    var extra = 0;\n    for (var i = 15; i > 0; i--) {\n      if (flags & (1 << i)) {\n        var res = this.buffer_get_varlen(data, pos);\n        var size = res[0];\n        var l = res[1];\n        pos = res[2];\n        pos -= size - l;\n        extra += size;\n      }\n    }\n    if (flags & 1) {\n      var a = data[pos];\n      extra += (a & 0x3) + 1;\n    }\n    return extra;\n  }\n\n  // data should be uint8array\n  buffer_get_varlen(data, pos) {\n    var l = 0;\n    var size = 0;\n    var byte_count = 0;\n    var mask = 0x7f;\n    var stop_flag = 0x80;\n    var shift = 0;\n    for (var i = 0; ; i++) {\n      var byte = data[pos];\n      size |= (byte & mask) << shift;\n      shift += 7;\n      l += 1;\n      byte_count += 1;\n      pos -= 1;\n\n      var to_stop = byte & stop_flag;\n      if (byte_count >= 4 || to_stop > 0) {\n        break;\n      }\n    }\n    return [size, l, pos];\n  }\n  // 读出文本内容\n  read_text() {\n    var text_end = this.palm_header.record_count;\n    var buffers = [];\n    for (var i = 1; i <= text_end; i++) {\n      buffers.push(this.read_text_record(i));\n    }\n    var all = copagesne_uint8array(buffers);\n    return ab2str(all);\n  }\n\n  read_text_record(i) {\n    var flags = this.mobi_header.extra_flags;\n    var begin = this.reclist[i].offset;\n    var end = this.reclist[i + 1].offset;\n\n    var data = new Uint8Array(this.buffer.slice(begin, end));\n    var ex = this.get_record_extrasize(data, flags);\n\n    data = new Uint8Array(this.buffer.slice(begin, end - ex));\n    if (this.palm_header.compression === 2) {\n      var buffer = uncompression_lz77(data);\n      return buffer.shrink();\n    } else {\n      return data;\n    }\n  }\n  // 从buffer中读出image\n  read_image(idx) {\n    var first_image_idx = this.mobi_header.first_image_idx;\n    var begin = this.reclist[first_image_idx + idx].offset;\n    var end = this.reclist[first_image_idx + idx + 1].offset;\n    var data = new Uint8Array(this.buffer.slice(begin, end));\n    return new Blob([data.buffer]);\n  }\n\n  load() {\n    this.header = this.load_pdbheader();\n    this.reclist = this.load_reclist();\n    this.load_record0();\n  }\n\n  load_pdbheader() {\n    var header = {};\n    header.name = this.getStr(32);\n    header.attr = this.getUint16();\n    header.version = this.getUint16();\n    header.ctime = this.getUint32();\n    header.mtime = this.getUint32();\n    header.btime = this.getUint32();\n    header.mod_num = this.getUint32();\n    header.appinfo_offset = this.getUint32();\n    header.sortinfo_offset = this.getUint32();\n    header.type = this.getStr(4);\n    header.creator = this.getStr(4);\n    header.uid = this.getUint32();\n    header.next_rec = this.getUint32();\n    header.record_num = this.getUint16();\n    return header;\n  }\n\n  load_reclist() {\n    var reclist = [];\n    for (var i = 0; i < this.header.record_num; i++) {\n      var record = {};\n      record.offset = this.getUint32();\n      // TODO(zz) change\n      record.attr = this.getUint32();\n      reclist.push(record);\n    }\n    return reclist;\n  }\n  load_record0() {\n    this.palm_header = this.load_record0_header();\n    this.mobi_header = this.load_mobi_header();\n  }\n\n  load_record0_header() {\n    var p_header = {};\n    var first_record = this.reclist[0];\n    this.setoffset(first_record.offset);\n\n    p_header.compression = this.getUint16();\n    this.skip(2);\n    p_header.text_length = this.getUint32();\n    p_header.record_count = this.getUint16();\n    p_header.record_size = this.getUint16();\n    p_header.encryption_type = this.getUint16();\n    this.skip(2);\n\n    return p_header;\n  }\n\n  load_mobi_header() {\n    var mobi_header = {};\n\n    var start_offset = this.offset;\n\n    mobi_header.identifier = this.getUint32();\n    mobi_header.header_length = this.getUint32();\n    mobi_header.mobi_type = this.getUint32();\n    mobi_header.text_encoding = this.getUint32();\n    mobi_header.uid = this.getUint32();\n    mobi_header.generator_version = this.getUint32();\n\n    this.skip(40);\n\n    mobi_header.first_nonbook_index = this.getUint32();\n    mobi_header.full_name_offset = this.getUint32();\n    mobi_header.full_name_length = this.getUint32();\n\n    mobi_header.language = this.getUint32();\n    mobi_header.input_language = this.getUint32();\n    mobi_header.output_language = this.getUint32();\n    mobi_header.min_version = this.getUint32();\n    mobi_header.first_image_idx = this.getUint32();\n\n    mobi_header.huff_rec_index = this.getUint32();\n    mobi_header.huff_rec_count = this.getUint32();\n    mobi_header.datp_rec_index = this.getUint32();\n    mobi_header.datp_rec_count = this.getUint32();\n\n    mobi_header.exth_flags = this.getUint32();\n\n    this.skip(36);\n\n    mobi_header.drm_offset = this.getUint32();\n    mobi_header.drm_count = this.getUint32();\n    mobi_header.drm_size = this.getUint32();\n    mobi_header.drm_flags = this.getUint32();\n\n    this.skip(8);\n\n    // TODO (zz) fdst_index\n    this.skip(4);\n\n    this.skip(46);\n\n    mobi_header.extra_flags = this.getUint16();\n\n    this.setoffset(start_offset + mobi_header.header_length);\n\n    return mobi_header;\n  }\n  load_exth_header() {\n    // TODO\n    return {};\n  }\n\n  render() {\n    this.load();\n    var content = this.read_text();\n    var bookDoc = domParser.parseFromString(content, \"text/html\")\n      .documentElement;\n    const pages = Array.from(bookDoc.getElementsByTagName(\"mbp:pagebreak\"));\n    let parseContent = [];\n    for (let i = 0, len = pages.length; i < len - 1; i++) {\n      pages[i].childNodes &&\n        pages[i].childNodes.forEach((item) => {\n          item.innerText.length < 1000 && parseContent.push(item.innerText);\n        });\n    }\n    return parseContent.join(\"\\n    \\n\");\n  }\n  render_image(imgDoms, i) {\n    var imgDom = imgDoms[i];\n    var idx = +imgDom.getAttribute(\"recindex\");\n    var blob = this.read_image(idx - 1);\n    var imgReader = new FileReader();\n    imgReader.onload = function (e) {\n      imgDom.src = e.target.result;\n    };\n    imgReader.readAsDataURL(blob);\n  }\n}\n\nexport default MobiFile;\n","//从本地导入书籍\nimport React from \"react\";\nimport \"./importLocal.css\";\nimport BookModel from \"../../model/Book\";\nimport localforage from \"localforage\";\nimport SparkMD5 from \"spark-md5\";\nimport { Trans } from \"react-i18next\";\nimport Dropzone from \"react-dropzone\";\nimport { ImportLocalProps, ImportLocalState } from \"./interface\";\nimport RecordRecent from \"../../utils/recordRecent\";\nimport axios from \"axios\";\nimport { config } from \"../../constants/readerConfig\";\nimport MobiFile from \"../../utils/mobiUtil\";\nimport iconv from \"iconv-lite\";\nimport isElectron from \"is-electron\";\nimport { withRouter } from \"react-router-dom\";\n\ndeclare var window: any;\nvar pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\n\nclass ImportLocal extends React.Component<ImportLocalProps, ImportLocalState> {\n  componentDidMount() {\n    if (isElectron()) {\n      const { ipcRenderer } = window.require(\"electron\");\n      ipcRenderer.sendSync(\"start-server\", \"ping\");\n    }\n  }\n  handleAddBook = (book: BookModel) => {\n    return new Promise((resolve, reject) => {\n      let bookArr = this.props.books;\n      if (bookArr == null) {\n        bookArr = [];\n      }\n      bookArr.push(book);\n      RecordRecent.setRecent(book.key);\n      localforage\n        .setItem(\"books\", bookArr)\n        .then(() => {\n          this.props.handleFetchBooks();\n          this.props.handleMessage(\"Add Successfully\");\n          this.props.handleMessageBox(true);\n          this.props.history.push(\"/manager/home\");\n          resolve();\n        })\n        .catch(() => {\n          reject();\n        });\n    });\n  };\n  //获取书籍md5\n  doIncrementalTest = (file: any) => {\n    return new Promise((resolve, reject) => {\n      //这里假设直接将文件选择框的dom引用传入\n      //这里需要用到File的slice( )方法，以下是兼容写法\n\n      var blobSlice =\n          (File as any).prototype.slice ||\n          (File as any).prototype.mozSlice ||\n          (File as any).prototype.webkitSlice,\n        chunkSize = 2097152, // 以每片2MB大小来逐次读取\n        chunks = Math.ceil(file.size / chunkSize),\n        currentChunk = 0,\n        spark = new SparkMD5(), //创建SparkMD5的实例\n        fileReader = new FileReader();\n\n      fileReader.onload = async (e) => {\n        if (!e.target) {\n          reject();\n          throw new Error();\n        }\n        spark.appendBinary(e.target.result as any); // append array buffer\n        currentChunk += 1;\n        if (currentChunk < chunks) {\n          loadNext();\n        } else {\n          let md5 = spark.end(); // 完成计算，返回结果\n          await this.handleBook(file, md5);\n          resolve();\n        }\n      };\n\n      const loadNext = () => {\n        var start = currentChunk * chunkSize,\n          end = start + chunkSize >= file.size ? file.size : start + chunkSize;\n\n        fileReader.readAsBinaryString(blobSlice.call(file, start, end));\n      };\n\n      loadNext();\n    });\n  };\n  handleBook = (file: any, md5: string) => {\n    let extension = file.name.split(\".\")[file.name.split(\".\").length - 1];\n    return new Promise((resolve, reject) => {\n      //md5重复不导入\n      let isRepeat = false;\n      if (this.props.books) {\n        this.props.books.forEach((item) => {\n          if (item.md5 === md5) {\n            isRepeat = true;\n            this.props.handleMessage(\"Duplicate Book\");\n            this.props.handleMessageBox(true);\n            resolve();\n          }\n        });\n      }\n      //解析图书，获取图书数据\n      if (!isRepeat) {\n        let reader = new FileReader();\n        reader.readAsArrayBuffer(file);\n        reader.onload = async (e) => {\n          if (!e.target) {\n            this.props.handleMessage(\"Import Failed\");\n            this.props.handleMessageBox(true);\n            reject();\n            throw new Error();\n          }\n          if (extension === \"pdf\") {\n            if (!e.target) {\n              reject();\n              throw new Error();\n            }\n            pdfjsLib\n              .getDocument({ data: e.target.result })\n              .promise.then((pdfDoc_: any) => {\n                let pdfDoc = pdfDoc_;\n                pdfDoc.getMetadata().then((metadata: any) => {\n                  pdfDoc.getPage(1).then((page: any) => {\n                    var scale = 1.5;\n                    var viewport = page.getViewport({\n                      scale: scale,\n                    });\n                    var canvas: any = document.getElementById(\"the-canvas\");\n                    var context = canvas.getContext(\"2d\");\n                    canvas.height =\n                      viewport.height ||\n                      viewport.viewBox[3]; /* viewport.height is NaN */\n                    canvas.width =\n                      viewport.width ||\n                      viewport.viewBox[2]; /* viewport.width is also NaN */\n                    var task = page.render({\n                      canvasContext: context,\n                      viewport: viewport,\n                    });\n                    task.promise.then(async () => {\n                      let cover: any = canvas.toDataURL(\"image/jpeg\");\n                      let key: string,\n                        name: string,\n                        author: string,\n                        description: string;\n                      [name, author, description] = [\n                        metadata.info.Title || file.name,\n                        metadata.info.Author,\n                        \"pdf\",\n                      ];\n                      key = new Date().getTime() + \"\";\n                      let book = new BookModel(\n                        key,\n                        name,\n                        author,\n                        description,\n                        md5,\n                        cover\n                      );\n                      await this.handleAddBook(book);\n                      localforage.setItem(key, e.target!.result);\n                      resolve();\n                    });\n                  });\n                });\n              })\n              .catch((err: any) => {\n                this.props.handleMessage(\"Import Failed\");\n                this.props.handleMessageBox(true);\n                console.log(\"Error occurs\");\n                reject();\n              });\n          } else if (extension === \"mobi\") {\n            if (!isElectron()) {\n              this.props.handleMessage(\"Only Desktop support this format\");\n              this.props.handleMessageBox(true);\n              console.log(\"Error occurs\");\n              reject();\n              return;\n            }\n            var reader = new FileReader();\n            reader.onload = (event) => {\n              const file_content = (event.target as any).result;\n              let mobiFile = new MobiFile(file_content);\n\n              let content = mobiFile.render();\n              let buf = iconv.encode(content, \"GBK\");\n              let blobTemp: any = new Blob([buf], { type: \"text/plain\" });\n              let fileTemp = new File(\n                [blobTemp],\n                file.name.split(\".\")[0] + \".txt\",\n                {\n                  lastModified: new Date().getTime(),\n                  type: blobTemp.type,\n                }\n              );\n\n              this.doIncrementalTest(fileTemp);\n            };\n            reader.readAsArrayBuffer(file);\n          } else if (extension === \"txt\") {\n            if (!isElectron()) {\n              this.props.handleMessage(\"Only Desktop support this format\");\n              this.props.handleMessageBox(true);\n              console.log(\"Error occurs\");\n              reject();\n              return;\n            }\n            let formData = new FormData();\n            formData.append(\"file\", file);\n            axios\n              .post(`${config.token_url}/ebook_parser`, formData, {\n                headers: {\n                  \"Content-Type\": \"multipart/form-data\",\n                },\n                responseType: \"blob\",\n              })\n              .then((res) => {\n                let type = \"application/octet-stream\";\n                console.log(res, \"res\");\n                let blobTemp: any = new Blob([res.data], { type: type });\n                let fileTemp = new File(\n                  [blobTemp],\n                  file.name.split(\".\")[0] + \".epub\",\n                  {\n                    lastModified: new Date().getTime(),\n                    type: blobTemp.type,\n                  }\n                );\n\n                this.doIncrementalTest(fileTemp);\n              })\n              .catch((err) => {\n                this.props.handleMessage(\"Import Failed\");\n                this.props.handleMessageBox(true);\n                console.log(err, \"Error occurs\");\n                reject();\n              });\n          } else {\n            let cover: any = \"\";\n            const epub = window.ePub(e.target.result);\n            epub.loaded.metadata\n              .then((metadata: any) => {\n                if (!e.target) {\n                  reject();\n                  throw new Error();\n                }\n                epub\n                  .coverUrl()\n                  .then(async (url: string) => {\n                    if (url) {\n                      var reader = new FileReader();\n                      let blob = await fetch(url).then((r) => r.blob());\n                      reader.readAsDataURL(blob);\n                      reader.onloadend = async () => {\n                        cover = reader.result;\n                        let key: string,\n                          name: string,\n                          author: string,\n                          description: string;\n                        [name, author, description] = [\n                          metadata.title,\n                          metadata.creator,\n                          metadata.description,\n                        ];\n                        key = new Date().getTime() + \"\";\n                        let book = new BookModel(\n                          key,\n                          name,\n                          author,\n                          description,\n                          md5,\n                          cover\n                        );\n                        await this.handleAddBook(book);\n                        localforage.setItem(key, e.target!.result);\n                        resolve();\n                      };\n                    } else {\n                      cover = \"noCover\";\n                      let key: string,\n                        name: string,\n                        author: string,\n                        description: string;\n                      [name, author, description] = [\n                        metadata.title,\n                        metadata.creator,\n                        metadata.description,\n                      ];\n                      key = new Date().getTime() + \"\";\n                      let book = new BookModel(\n                        key,\n                        name,\n                        author,\n                        description,\n                        md5,\n                        cover\n                      );\n                      await this.handleAddBook(book);\n                      localforage.setItem(key, e.target!.result);\n                      resolve();\n                    }\n                  })\n                  .catch((err: any) => {\n                    console.log(err, \"err\");\n                    reject();\n                  });\n              })\n              .catch(() => {\n                this.props.handleMessage(\"Import Failed\");\n                this.props.handleMessageBox(true);\n                console.log(\"Error occurs\");\n                reject();\n              });\n          }\n        };\n      }\n    });\n  };\n\n  render() {\n    return (\n      <Dropzone\n        onDrop={async (acceptedFiles) => {\n          if (acceptedFiles.length > 9) {\n            this.props.handleMessage(\"Please import less than 10 books\");\n            this.props.handleMessageBox(true);\n            return;\n          }\n\n          for (let i = 0; i < acceptedFiles.length; i++) {\n            //异步解析文件\n            await this.doIncrementalTest(acceptedFiles[i]);\n          }\n        }}\n        accept={[\".epub\", \".pdf\", \".txt\", \".mobi\"]}\n        multiple={true}\n      >\n        {({ getRootProps, getInputProps }) => (\n          <div className=\"import-from-local\" {...getRootProps()}>\n            <Trans>Import from Local</Trans>\n            <input\n              type=\"file\"\n              id=\"import-book-box\"\n              className=\"import-book-box\"\n              name=\"file\"\n              {...getInputProps()}\n            />\n          </div>\n        )}\n      </Dropzone>\n    );\n  }\n}\n\nexport default withRouter(ImportLocal);\n","//从本地导入书籍\nimport \"./importLocal.css\";\nimport { connect } from \"react-redux\";\nimport {\n  handleMessageBox,\n  handleMessage,\n  handleFetchBooks,\n} from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport ImportLocal from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {\n  handleMessageBox,\n  handleMessage,\n  handleFetchBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(ImportLocal as any));\n","//提示更新的文字\nimport React from \"react\";\nimport \"./updateInfo.css\";\nimport { UpdateInfoProps, UpdateInfoState } from \"./interface\";\nimport { updateLog } from \"../../constants/readerConfig\";\nimport { Trans } from \"react-i18next\";\nimport axios from \"axios\";\nconst isElectron = require(\"is-electron\");\n\ndeclare var window: any;\n\nclass UpdateInfo extends React.Component<UpdateInfoProps, UpdateInfoState> {\n  constructor(props: UpdateInfoProps) {\n    super(props);\n    this.state = { downlownLink: \"\" };\n  }\n  componentDidMount() {\n    !this.props.currentBook.key &&\n      axios\n        .get(\"https://koodo.960960.xyz/api/update\")\n        .then((res) => {\n          console.log(res);\n          const download = res.data.download;\n          const version = res.data.log.version;\n          if (this.compareVersion(updateLog.version, version)) {\n            navigator.platform === \"Win32\"\n              ? this.setState({ downlownLink: download[0].url })\n              : this.setState({ downlownLink: download[1].url });\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n  }\n\n  handleJump = () => {\n    isElectron() &&\n      window.require(\"electron\").shell.openExternal(this.state.downlownLink);\n  };\n  compareVersion = (ver1: string, ver2: string) => {\n    const ver1Arr = ver1.split(\".\");\n    const ver2Arr = ver2.split(\".\");\n\n    for (let i = 0; i < ver1Arr.length; i++) {\n      if (parseInt(ver1Arr[i]) < parseInt(ver2Arr[i])) {\n        return true;\n      }\n    }\n    return false;\n  };\n  render() {\n    return (\n      <div\n        className=\"update-info-container\"\n        style={this.state.downlownLink ? {} : { display: \"none\" }}\n        onClick={() => {\n          this.handleJump();\n        }}\n      >\n        <Trans>New Version Available</Trans>\n      </div>\n    );\n  }\n}\n\nexport default UpdateInfo;\n","//左下角的图标外链\nimport { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport UpdateInfo from \"./component\";\nimport { withNamespaces } from \"react-i18next\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(UpdateInfo as any));\n","//header 页面\nimport React from \"react\";\nimport \"./header.css\";\nimport SearchBox from \"../../components/searchBox\";\nimport ImportLocal from \"../../components/importLocal\";\nimport { Trans } from \"react-i18next\";\nimport { HeaderProps, HeaderState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport UpdateInfo from \"../../components/updateInfo\";\n\nclass Header extends React.Component<HeaderProps, HeaderState> {\n  constructor(props: HeaderProps) {\n    super(props);\n    this.state = {\n      isOnlyLocal: false,\n      isBookImported:\n        OtherUtil.getReaderConfig(\"totalBooks\") &&\n        OtherUtil.getReaderConfig(\"totalBooks\") > 0\n          ? true\n          : false,\n      language: OtherUtil.getReaderConfig(\"lang\"),\n      isNewVersion: false,\n    };\n  }\n\n  handleSortBooks = () => {\n    if (this.props.isSortDisplay) {\n      this.props.handleSortDisplay(false);\n    } else {\n      this.props.handleSortDisplay(true);\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"header\">\n        <div className=\"header-search-container\">\n          <SearchBox />\n        </div>\n\n        <div\n          className=\"header-sort-container\"\n          onClick={() => {\n            this.handleSortBooks();\n          }}\n        >\n          <span className=\"header-sort-text\">\n            <Trans>Sort</Trans>\n          </span>\n          <span className=\"icon-sort header-sort-icon\"></span>\n        </div>\n        <div className=\"setting-icon-container\">\n          <span\n            className=\"icon-setting setting-icon\"\n            onClick={() => {\n              this.props.handleSetting(true);\n            }}\n          ></span>\n        </div>\n\n        <a href=\"./assets/demo.epub\" target=\"_blank\" rel=\"noopener noreferrer\">\n          <div\n            className=\"download-demo-book\"\n            style={this.state.isBookImported ? { display: \"none\" } : {}}\n          >\n            <Trans>Download Demo Book</Trans>\n          </div>\n        </a>\n        <div\n          className=\"import-from-cloud\"\n          onClick={() => {\n            this.props.handleBackupDialog(true);\n          }}\n        >\n          <Trans>Backup and Restore</Trans>\n        </div>\n        <ImportLocal />\n        <UpdateInfo />\n      </div>\n    );\n  }\n}\n\nexport default Header;\n","//header 页面\nimport { connect } from \"react-redux\";\nimport { withNamespaces } from \"react-i18next\";\nimport {\n  handleSortDisplay,\n  handleMessageBox,\n  handleMessage,\n  handleSetting,\n} from \"../../store/actions/manager\";\nimport { handleBackupDialog } from \"../../store/actions/backupPage\";\nimport { stateType } from \"../../store\";\nimport Header from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isSearch: state.manager.isSearch,\n    isSortDisplay: state.manager.isSortDisplay,\n  };\n};\nconst actionCreator = {\n  handleSortDisplay,\n  handleMessageBox,\n  handleMessage,\n  handleBackupDialog,\n  handleSetting,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(Header as any));\n","import BookModel from \"../../model/Book\";\nexport function handleEditDialog(mode: boolean) {\n  return { type: \"HANDLE_EDIT_DIALOG\", payload: mode };\n}\nexport function handleDeleteDialog(mode: boolean) {\n  return { type: \"HANDLE_DELETE_DIALOG\", payload: mode };\n}\nexport function handleAddDialog(mode: boolean) {\n  return { type: \"HANDLE_ADD_DIALOG\", payload: mode };\n}\nexport function handleActionDialog(mode: boolean) {\n  return { type: \"HANDLE_ACTION_DIALOG\", payload: mode };\n}\nexport function handleReadingState(state: boolean) {\n  return { type: \"HANDLE_READING_STATE\", payload: state };\n}\nexport function handleReadingBook(book: BookModel) {\n  return { type: \"HANDLE_READING_BOOK\", payload: book };\n}\nexport function handleReadingEpub(epub: any) {\n  return { type: \"HANDLE_READING_EPUB\", payload: epub };\n}\n","import BookModel from \"../model/Book\";\nimport NoteModel from \"../model/Note\";\nimport BookmarkModel from \"../model/Bookmark\";\nclass DeleteUtil {\n  static deleteBook(books: BookModel[], bookKey: string) {\n    books = books.filter((item) => item.key !== bookKey);\n    return books;\n  }\n  static deleteBookmarks(bookmarks: BookmarkModel[], bookKey: string) {\n    bookmarks = bookmarks.filter((item) => item.bookKey !== bookKey);\n    return bookmarks;\n  }\n  static deleteNotes(notes: NoteModel[], bookKey: string) {\n    notes = notes.filter((item) => item.bookKey !== bookKey);\n    return notes;\n  }\n}\n\nexport default DeleteUtil;\n","// 记录书本打开记录\nconst defaultShelf = {\n  New: null,\n  Study: [],\n  Work: [],\n  Entertainment: [],\n};\nclass ShelfUtil {\n  static setShelf(shelfTitle: string, bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    if (obj[shelfTitle] === undefined) {\n      obj[shelfTitle] = [];\n    }\n    if (obj[shelfTitle].indexOf(bookKey) === -1) {\n      obj[shelfTitle].unshift(bookKey);\n    }\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n\n  static getShelf() {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    return obj;\n  }\n  static clearShelf(shelfIndex: number, bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    let shelfTitle = Object.keys(obj);\n    let currentShelfTitle = shelfTitle[shelfIndex];\n    let index = obj[currentShelfTitle].indexOf(bookKey);\n    obj[currentShelfTitle].splice(index, 1);\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n  static deletefromAllShelf(bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    let shelfTitle = Object.keys(obj);\n    shelfTitle.splice(0, 1);\n    shelfTitle.forEach((item) => {\n      let index = obj[item].indexOf(bookKey);\n      if (index > -1) {\n        obj[item].splice(index, 1);\n      }\n    });\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n  static removeShelf(shelfTitle: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    delete obj[shelfTitle];\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n}\n\nexport default ShelfUtil;\n","// 阅读期间自动记录当前阅读位置\nclass RecordLocation {\n  static recordCfi(bookKey: string, cfi: string, percentage: number) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    obj[bookKey] = { cfi: cfi, percentage: percentage };\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n  }\n\n  static getCfi(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    return obj[bookKey] || {};\n  }\n\n  static clear(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json!) || {};\n    delete obj[bookKey];\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n  }\n}\n\nexport default RecordLocation;\n","// 记录书本打开记录\nimport BookModel from \"../model/Book\";\nclass AddFavorite {\n  static setFavorite(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static setAllFavorite(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static getAllFavorite() {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default AddFavorite;\n","import React from \"react\";\nimport \"./deleteDialog.css\";\nimport DeleteUtil from \"../../utils/deleteUtil\";\nimport localforage from \"localforage\";\nimport ShelfUtil from \"../../utils/shelfUtil\";\nimport RecordRecent from \"../../utils/recordRecent\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport AddFavorite from \"../../utils/addFavorite\";\nimport { Trans } from \"react-i18next\";\nimport { DeleteDialogProps } from \"./interface\";\nimport { withRouter } from \"react-router-dom\";\n\nclass DeleteDialog extends React.Component<DeleteDialogProps> {\n  handleCancel = () => {\n    this.props.handleDeleteDialog(false);\n  };\n  handleDeleteOther = () => {\n    if (this.props.bookmarks[0]) {\n      let bookmarkArr = DeleteUtil.deleteBookmarks(\n        this.props.bookmarks,\n        this.props.currentBook.key\n      );\n      if (bookmarkArr.length === 0) {\n        localforage.removeItem(\"bookmarks\").then(() => {\n          this.props.handleFetchBookmarks();\n        });\n      } else {\n        localforage.setItem(\"bookmarks\", bookmarkArr).then(() => {\n          this.props.handleFetchBookmarks();\n        });\n      }\n    }\n    if (this.props.notes) {\n      let noteArr = DeleteUtil.deleteNotes(\n        this.props.notes,\n        this.props.currentBook.key\n      );\n      if (noteArr.length === 0) {\n        localforage.removeItem(\"notes\").then(() => {\n          this.props.handleFetchNotes();\n        });\n      } else {\n        localforage.setItem(\"notes\", noteArr).then(() => {\n          this.props.handleFetchNotes();\n        });\n      }\n    }\n  };\n  handleComfirm = () => {\n    //从列表删除和从图书库删除判断\n    if (this.props.mode === \"shelf\") {\n      ShelfUtil.clearShelf(this.props.shelfIndex, this.props.currentBook.key);\n      this.props.handleDeleteDialog(false);\n    } else {\n      this.props.books &&\n        localforage\n          .setItem(\n            \"books\",\n            DeleteUtil.deleteBook(this.props.books, this.props.currentBook.key)\n          )\n          .then(() => {\n            localforage.removeItem(this.props.currentBook.key).then(() => {\n              this.props.handleDeleteDialog(false);\n              this.props.handleFetchBooks();\n            });\n          });\n      //从喜爱的图书中删除\n      AddFavorite.clear(this.props.currentBook.key);\n      //从书架删除\n      ShelfUtil.deletefromAllShelf(this.props.currentBook.key);\n      //从阅读记录删除\n      RecordRecent.clear(this.props.currentBook.key);\n      //删除阅读历史\n      RecordLocation.clear(this.props.currentBook.key);\n      //删除书签，笔记，书摘，高亮\n      this.handleDeleteOther();\n      this.props.handleActionDialog(false);\n      if (this.props.books.length === 1) {\n        this.props.history.push(\"/manager/empty\");\n      }\n    }\n\n    this.props.handleMessage(\"Delete Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  render() {\n    return (\n      <div className=\"delete-dialog-container\">\n        {this.props.mode !== \"shelf\" ? (\n          <div className=\"delete-dialog-title\">\n            <Trans>Delete This Book</Trans>\n          </div>\n        ) : (\n          <div className=\"delete-dialog-title\">\n            <Trans>Delete from Shelf</Trans>\n          </div>\n        )}\n\n        <div className=\"delete-dialog-book\">\n          <div className=\"delete-dialog-book-title\">\n            {this.props.currentBook.name}\n          </div>\n        </div>\n        {this.props.mode !== \"shelf\" ? (\n          <div className=\"delete-dialog-other-option\">\n            <Trans>\n              This action will delete all the notes, bookmarks and digests of\n              this book\n            </Trans>\n          </div>\n        ) : (\n          <div className=\"delete-dialog-other-option\">\n            <Trans>This action won't delete the original book</Trans>\n          </div>\n        )}\n        <div\n          className=\"delete-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"delete-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Delete</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(DeleteDialog);\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchBooks,\n  handleMessageBox,\n  handleMessage,\n} from \"../../store/actions/manager\";\nimport {\n  handleDeleteDialog,\n  handleActionDialog,\n} from \"../../store/actions/book\";\nimport {\n  handleFetchBookmarks,\n  handleFetchNotes,\n} from \"../../store/actions/reader\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport DeleteDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    mode: state.sidebar.mode,\n    shelfIndex: state.sidebar.shelfIndex,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleDeleteDialog,\n  handleFetchBookmarks,\n  handleFetchNotes,\n  handleMessageBox,\n  handleMessage,\n  handleActionDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(DeleteDialog as any));\n","//编辑图书对话框\nimport React from \"react\";\nimport \"./editDialog.css\";\nimport localforage from \"localforage\";\nimport { Trans } from \"react-i18next\";\nimport { EditDialogProps, EditDialogState } from \"./interface\";\n\nclass EditDialog extends React.Component<EditDialogProps, EditDialogState> {\n  constructor(props: EditDialogProps) {\n    super(props);\n    this.state = { isCheck: false };\n  }\n  componentDidMount() {\n    const nameBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-name-box\"\n    ) as HTMLInputElement;\n    const authorBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-author-box\"\n    ) as HTMLInputElement;\n    nameBox.value = this.props.currentBook.name;\n    authorBox.value = this.props.currentBook.author;\n  }\n\n  handleCancel = () => {\n    this.props.handleEditDialog(false);\n  };\n  handleComfirm = () => {\n    const nameBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-name-box\"\n    ) as HTMLInputElement;\n    let name = nameBox.value;\n    const authorBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-author-box\"\n    ) as HTMLInputElement;\n    let author = authorBox.value;\n    let { books } = this.props;\n    books.forEach((item) => {\n      if (item.key === this.props.currentBook.key) {\n        item.name = name;\n        item.author = author;\n        return false;\n      }\n    });\n    localforage.setItem(\"books\", books).then(() => {\n      this.props.handleEditDialog(false);\n      this.props.handleFetchBooks();\n    });\n    this.props.handleMessage(\"Edit Successfully\");\n    this.props.handleMessageBox(true);\n    this.props.handleActionDialog(false);\n  };\n  render() {\n    return (\n      <div className=\"edit-dialog-container\">\n        <div className=\"edit-dialog-title\">\n          <Trans>Edit Book</Trans>\n        </div>\n        <div className=\"edit-dialog-book-name-container\">\n          <div className=\"edit-dialog-book-name-text\">\n            <Trans>Book Name</Trans>\n          </div>\n          <input className=\"edit-dialog-book-name-box\" />\n        </div>\n        <div className=\"edit-dialog-book-author-container\">\n          <div className=\"edit-dialog-book-author-text\">\n            <Trans>Author</Trans>\n          </div>\n          <input className=\"edit-dialog-book-author-box\" />\n        </div>\n        <div\n          className=\"edit-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"edit-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Confirm</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default EditDialog;\n","//编辑图书对话框\nimport { connect } from \"react-redux\";\nimport \"./editDialog.css\";\nimport {\n  handleFetchBooks,\n  handleMessageBox,\n  handleMessage,\n} from \"../../store/actions/manager\";\nimport { handleEditDialog, handleActionDialog } from \"../../store/actions/book\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport EditDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleEditDialog,\n  handleActionDialog,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(EditDialog as any));\n","//添加图书到书架的对话框\nimport React, { Component } from \"react\";\nimport \"./addDialog.css\";\nimport ShelfUtil from \"../../utils/shelfUtil\";\nimport { Trans, NamespacesConsumer } from \"react-i18next\";\nimport { AddDialogProps, AddDialogState } from \"./interface\";\n\nclass AddDialog extends Component<AddDialogProps, AddDialogState> {\n  constructor(props: AddDialogProps) {\n    super(props);\n    this.state = { isNew: true, shelfTitle: \"\" };\n  }\n\n  handleCancel = () => {\n    this.props.handleAddDialog(false);\n  };\n  handleComfirm = () => {\n    const inputElement: HTMLInputElement = document.querySelector(\n      \".add-dialog-new-shelf-box\"\n    ) as HTMLInputElement;\n    let shelfTitle: string = this.state.shelfTitle;\n    let shelfList = ShelfUtil.getShelf();\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\n    let shelfIndex = this.state.isNew\n      ? shelfTitles.length\n      : shelfTitles.indexOf(inputElement.value);\n    if (this.state.isNew) {\n      shelfTitle = inputElement.value;\n      if (shelfList.hasOwnProperty(shelfTitle)) {\n        this.props.handleMessage(\"Duplicate Shelf\");\n        this.props.handleMessageBox(true);\n        return;\n      }\n    }\n    //未填书架名提醒\n    if (!shelfTitle) {\n      this.props.handleMessage(\"Empty Shelf Title\");\n      this.props.handleMessageBox(true);\n      return;\n    }\n    //判断书架中是否已有该图书\n    if (\n      shelfList[`${shelfTitle}`] &&\n      shelfList[`${shelfTitle}`].indexOf(this.props.currentBook.key) > -1\n    ) {\n      this.props.handleMessage(\"Duplicate Book\");\n      this.props.handleMessageBox(true);\n      return;\n    }\n\n    ShelfUtil.setShelf(shelfTitle, this.props.currentBook.key);\n    this.props.handleAddDialog(false);\n    this.props.handleMessage(\"Add Successfully\");\n    this.props.handleMessageBox(true);\n    this.props.handleActionDialog(false);\n    this.props.handleMode(\"shelf\");\n    this.props.handleShelfIndex(shelfIndex);\n  };\n  //如果是添加到已存在的书架就diable新建图书的input框\n  handleChange = (shelfTitle: string) => {\n    if (shelfTitle === \"New\") {\n      this.setState({ isNew: true });\n    } else {\n      this.setState({ shelfTitle });\n      this.setState({ isNew: false });\n    }\n  };\n  render() {\n    const renderShelfList = () => {\n      let shelfList = ShelfUtil.getShelf();\n      let shelfTitle = Object.keys(shelfList);\n      return shelfTitle.map((item) => {\n        return (\n          <NamespacesConsumer>\n            {(t) => (\n              <option\n                value={item}\n                key={item}\n                className=\"add-dialog-shelf-list-option\"\n              >\n                {t(item)}\n              </option>\n            )}\n          </NamespacesConsumer>\n        );\n      });\n    };\n    return (\n      <div className=\"add-dialog-container\">\n        <div className=\"add-dialog-title\">\n          <Trans>Add to Shelf</Trans>\n        </div>\n        <div className=\"add-dialog-shelf-list-container\">\n          <div className=\"add-dialog-shelf-list-text\">\n            <Trans>Select</Trans>\n          </div>\n          <select\n            className=\"add-dialog-shelf-list-box\"\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\n              this.handleChange(event.target.value);\n            }}\n          >\n            {renderShelfList()}\n          </select>\n        </div>\n        <div className=\"add-dialog-new-shelf-container\">\n          <div className=\"add-dialog-new-shelf-text\">\n            <Trans>New Shelf</Trans>\n          </div>\n          <input\n            className=\"add-dialog-new-shelf-box\"\n            disabled={!this.state.isNew}\n          />\n        </div>\n        <div\n          className=\"add-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"add-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Confirm</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AddDialog;\n","//添加图书到书架的对话框\nimport { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { handleAddDialog, handleActionDialog } from \"../../store/actions/book\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport AddDialog from \"./component\";\nimport { handleMode, handleShelfIndex } from \"../../store/actions/sidebar\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {\n  handleAddDialog,\n  handleActionDialog,\n  handleMessageBox,\n  handleMessage,\n  handleMode,\n  handleShelfIndex,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(AddDialog as any));\n","//排序弹窗\nimport React from \"react\";\nimport \"./sortDialog.css\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport { Trans } from \"react-i18next\";\nimport { SortDialogProps } from \"./interface\";\n\nclass SortDialog extends React.Component<SortDialogProps> {\n  handleSort = (code: number) => {\n    let sortCode = this.props.sortCode;\n    sortCode.sort = code;\n    this.setState({ sortCode });\n    this.props.handleSortCode(sortCode);\n    this.props.handleSort(true);\n    OtherUtil.setSortCode(code, this.props.sortCode.order);\n  };\n  handleOrder = (code: number) => {\n    let sortCode = this.props.sortCode;\n    sortCode.order = code;\n    this.setState({ sortCode });\n    this.props.handleSort(true);\n    OtherUtil.setSortCode(this.props.sortCode.sort, code);\n    this.props.handleSortCode(sortCode);\n  };\n  handleSortBooks = () => {\n    if (this.props.isSortDisplay) {\n      this.props.handleSortDisplay(false);\n    } else {\n      this.props.handleSortDisplay(true);\n    }\n  };\n  render() {\n    return (\n      <div\n        className=\"sort-dialog-container\"\n        onMouseLeave={() => {\n          this.handleSortBooks();\n        }}\n      >\n        <ul className=\"sort-by-category\">\n          <li\n            className=\"sort-by-category-list\"\n            onClick={() => {\n              this.handleSort(1);\n            }}\n            style={\n              this.props.sortCode.sort === 1\n                ? { color: \"rgba(75, 75, 75, 1)\" }\n                : {}\n            }\n          >\n            <Trans>Sort by Name</Trans>\n          </li>\n          <li\n            className=\"sort-by-category-list\"\n            onClick={() => {\n              this.handleSort(2);\n            }}\n            style={\n              this.props.sortCode.sort === 2\n                ? { color: \"rgba(75, 75, 75, 1)\" }\n                : {}\n            }\n          >\n            <Trans>Sort by Date</Trans>\n          </li>\n        </ul>\n        <div className=\"sort-dialog-seperator\"></div>\n        <ul className=\"sort-by-order\">\n          <li\n            className=\"sort-by-order-list\"\n            onClick={() => {\n              this.handleOrder(1);\n            }}\n            style={\n              this.props.sortCode.order === 1\n                ? { color: \"rgba(75, 75, 75, 1)\" }\n                : {}\n            }\n          >\n            <Trans>Ascending Order</Trans>\n          </li>\n          <li\n            className=\"sort-by-order-list\"\n            onClick={() => {\n              this.handleOrder(2);\n            }}\n            style={\n              this.props.sortCode.order === 2\n                ? { color: \"rgba(75, 75, 75, 1)\" }\n                : {}\n            }\n          >\n            <Trans>Descending Order</Trans>\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default SortDialog;\n","import { connect } from \"react-redux\";\nimport {\n  handleSortCode,\n  handleSortDisplay,\n  handleSort,\n} from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport SortDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    sortCode: state.manager.sortCode,\n    isSortDisplay: state.manager.isSortDisplay,\n  };\n};\nconst actionCreator = {\n  handleSortCode,\n  handleSortDisplay,\n  handleSort,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(SortDialog as any));\n","//消息提示\nimport React from \"react\";\nimport \"./messageBox.css\";\nimport { Trans } from \"react-i18next\";\nimport { MessageBoxProps } from \"./interface\";\n\nclass MessageBox extends React.Component<MessageBoxProps> {\n  render() {\n    return (\n      <div className=\"message-box-container\">\n        <span className=\"icon-success  message-box-icon\"></span>\n        <div className=\"message-content\">\n          <Trans>{this.props.message}</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default MessageBox;\n","//消息提示\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport MessageBox from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    message: state.manager.message,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(MessageBox as any));\n","import localforage from \"localforage\";\nimport BookModel from \"../model/Book\";\n\nlet JSZip = (window as any).JSZip;\n\nclass RestoreUtil {\n  importBooks = (books: BookModel[], file: any, handleFinish: () => void) => {\n    let zip = new JSZip();\n    books.forEach((item, index) => {\n      zip\n        .loadAsync(file)\n        .then((content: any) => {\n          // you now have every files contained in the loaded zip\n          return content.files[`epub/${item.name}.epub`].async(\"arraybuffer\"); // a promise of \"Hello World\\n\"\n        })\n        .then((book: any) => {\n          localforage.setItem(item.key, book);\n          // item.content = book;\n        })\n        .then(() => {\n          if (index === books.length - 1) {\n            localforage.setItem(\"books\", books).then(() => {\n              handleFinish();\n            });\n          }\n        })\n        .catch(() => {\n          console.log(\"Error occurs\");\n        });\n    });\n  };\n  static restore = (file: any, handleFinish: () => void) => {\n    let dataArr = [\n      \"notes\",\n      \"books\",\n      \"bookmarks\",\n      \"readerConfig\",\n      \"noteTags\",\n      \"sortCode\",\n      \"readingTime\",\n      \"recentBooks\",\n      \"favoriteBooks\",\n      \"shelfList\",\n      \"recordLocation\",\n    ];\n    let zip = new JSZip();\n    // more files !\n    dataArr.forEach((item) => {\n      zip\n        .loadAsync(file)\n        .then((content: any) => {\n          // you now have every files contained in the loaded zip\n          return content.files[`data/${item}.json`].async(\"text\"); // a promise of \"Hello World\\n\"\n        })\n        .then((text: any) => {\n          if (text) {\n            if (item === \"notes\" || item === \"books\" || item === \"bookmarks\") {\n              localforage.setItem(item, JSON.parse(text));\n            } else {\n              localStorage.setItem(item, text);\n            }\n          }\n        })\n        .then(() => {\n          if (item === \"books\") {\n            localforage.getItem(\"books\").then((value: any) => {\n              let zip = new JSZip();\n              value &&\n                value.forEach((item: any) => {\n                  zip\n                    .loadAsync(file)\n                    .then((content: any) => {\n                      // you now have every files contained in the loaded zip\n                      return content.files[`epub/${item.name}.epub`].async(\n                        \"arraybuffer\"\n                      ); // a promise of \"Hello World\\n\"\n                    })\n                    .then((book: any) => {\n                      localforage.setItem(item.key, book).then(() => {\n                        handleFinish();\n                      });\n                    })\n                    .catch(() => {\n                      console.log(\"Error occurs\");\n                    });\n                });\n            });\n          }\n        })\n        .catch(() => {\n          console.log(\"Error happen\");\n        });\n    });\n  };\n}\n\nexport default RestoreUtil;\n","import RestoreUtil from \"../restoreUtil\";\nimport OtherUtil from \"../otherUtil\";\n\nvar Dropbox = (window as any).Dropbox;\n\nclass DropboxUitl {\n  static UploadFile(\n    file: any,\n    handleFinish: () => void,\n    showMessage: (message: string) => void\n  ) {\n    var ACCESS_TOKEN = OtherUtil.getReaderConfig(\"dropbox_token\") || \"\";\n    var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\n    dbx\n      .filesUpload({\n        path: \"/Apps/KoodoReader/data.zip\",\n        contents: file,\n        mode: { \".tag\": \"overwrite\" },\n      })\n      .then(function (response: any) {\n        console.log(response, \"上传成功\");\n        handleFinish();\n      })\n      .catch(function (error: any) {\n        console.error(error, \"上传失败\");\n        showMessage(\"Upload failed, check your connection\");\n      });\n    return false;\n  }\n  static DownloadFile(\n    handleFinish: () => void,\n    showMessage: (message: string) => void\n  ) {\n    var ACCESS_TOKEN = OtherUtil.getReaderConfig(\"dropbox_token\") || \"\";\n    var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\n    dbx\n      .filesDownload({\n        path: \"/Apps/KoodoReader/data.zip\",\n      })\n      .then(function (data: any) {\n        let file = data.fileBlob;\n        file.lastModifiedDate = new Date();\n        file.name = \"data.zip\";\n        RestoreUtil.restore(file, handleFinish);\n      })\n      .catch(function (error: any) {\n        showMessage(\"Download failed,network problem or no backup\");\n\n        console.error(error);\n      });\n\n    return false;\n  }\n}\n\nexport default DropboxUitl;\n","import FileSaver from \"file-saver\";\nimport BookModel from \"../model/Book\";\nimport NoteModel from \"../model/Note\";\nimport BookmarkModel from \"../model/Bookmark\";\nimport DropboxUtil from \"./syncUtils/dropbox\";\nimport localforage from \"localforage\";\n\nlet JSZip = (window as any).JSZip;\nclass BackupUtil {\n  static backup = async (\n    bookArr: BookModel[],\n    notes: NoteModel[],\n    bookmarks: BookmarkModel[],\n    handleFinish: () => void,\n    driveIndex: number,\n    showMessage: (message: string) => void\n  ) => {\n    let zip = new JSZip();\n    let books = bookArr;\n    let epubZip = zip.folder(\"epub\");\n    let data: any = [];\n    books &&\n      books.forEach((item) => {\n        data.push(localforage.getItem(item.key));\n        // let result = localforage.getItem(item.key);\n        // console.log(result);\n        // results.forEach((item) => {\n        //   epubZip.file(`${item.name}.epub`, item.content);\n        // });\n        // epubZip.file(`${item.name}.epub`, result);\n      });\n    let results = await Promise.all(data);\n    console.log(results);\n    for (let i = 0; i < books.length; i++) {\n      epubZip.file(`${books[i].name}.epub`, results[i]);\n    }\n    let dataZip = zip.folder(\"data\");\n    dataZip\n      .file(\"notes.json\", JSON.stringify(notes))\n      .file(\"books.json\", JSON.stringify(books))\n      .file(\"bookmarks.json\", JSON.stringify(bookmarks))\n      .file(\"readerConfig.json\", localStorage.getItem(\"readerConfig\") || \"\")\n      .file(\n        \"sortCode.json\",\n        localStorage.getItem(\"sortCode\") || \"{ sort: 2, order: 2 }\"\n      )\n      .file(\"readingTime.json\", localStorage.getItem(\"readingTime\") || \"\")\n      .file(\"recentBooks.json\", localStorage.getItem(\"recentBooks\") || [])\n      .file(\"favoriteBooks.json\", localStorage.getItem(\"favoriteBooks\") || [])\n      .file(\"shelfList.json\", localStorage.getItem(\"shelfList\") || [])\n      .file(\"noteTags.json\", localStorage.getItem(\"noteTags\") || [])\n      .file(\n        \"recordLocation.json\",\n        localStorage.getItem(\"recordLocation\") || \"\"\n      );\n\n    let year = new Date().getFullYear(),\n      month = new Date().getMonth() + 1,\n      day = new Date().getDate();\n\n    zip\n      .generateAsync({ type: \"blob\" })\n      .then(function (blob: any) {\n        switch (driveIndex) {\n          case 0:\n            handleFinish();\n            FileSaver.saveAs(\n              blob,\n              `${year}-${month <= 9 ? \"0\" + month : month}-${\n                day <= 9 ? \"0\" + day : day\n              }.zip`\n            );\n            break;\n          case 1:\n            DropboxUtil.UploadFile(blob, handleFinish, showMessage);\n            break;\n          case 2:\n            break;\n          case 3:\n            break;\n          default:\n            break;\n        }\n      })\n      .catch((err: any) => {\n        console.log(err);\n      });\n  };\n}\n\nexport default BackupUtil;\n","//绑定网盘的弹窗\nimport React, { Component } from \"react\";\nimport \"./tokenDialog.css\";\nimport copy from \"copy-text-to-clipboard\";\nimport { Trans } from \"react-i18next\";\nimport { TokenDialogProps, TokenDialogState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass TokenDialog extends Component<TokenDialogProps, TokenDialogState> {\n  constructor(props: TokenDialogProps) {\n    super(props);\n    this.state = { isNew: false };\n  }\n\n  handleCancel = () => {\n    this.props.handleTokenDialog(false);\n  };\n  handleComfirm = () => {\n    let token: string = (document.querySelector(\n      \".token-dialog-token-box\"\n    ) as HTMLTextAreaElement).value;\n    OtherUtil.setReaderConfig(`${this.props.driveName}_token`, token);\n    this.props.handleTokenDialog(false);\n    this.props.handleMessage(\"Add Successfully\");\n    this.props.handleMessageBox(true);\n  };\n\n  render() {\n    return (\n      <div className=\"token-dialog-container\">\n        <div className=\"token-dialog-box\">\n          <div className=\"token-dialog-title\">\n            <Trans>Bind</Trans>\n            {this.props.driveName}\n            <Trans>Token</Trans>\n          </div>\n          <div className=\"token-dialog-info-text\">\n            <Trans>Token Info</Trans>\n          </div>\n          <div\n            className=\"token-dialog-link-text\"\n            onClick={() => {\n              copy(this.props.url);\n              this.props.handleMessage(\"Copy Successfully\");\n              this.props.handleMessageBox(true);\n            }}\n          >\n            <Trans>Copy Link</Trans>\n          </div>\n          <textarea className=\"token-dialog-token-box\" />\n          <div\n            className=\"token-dialog-cancel\"\n            onClick={() => {\n              this.handleCancel();\n            }}\n          >\n            <Trans>Cancel</Trans>\n          </div>\n          <div\n            className=\"token-dialog-comfirm\"\n            onClick={() => {\n              this.handleComfirm();\n            }}\n          >\n            <Trans>Confirm</Trans>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default TokenDialog;\n","//添加图书到书架的对话框\nimport { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { handleTokenDialog } from \"../../store/actions/backupPage\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport TokenDialog from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {\n  handleTokenDialog,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(TokenDialog as any));\n","//备份和恢复页面\nimport React from \"react\";\nimport \"./backupDialog.css\";\nimport { driveList } from \"../../constants/readerConfig\";\nimport BackupUtil from \"../../utils/backupUtil\";\nimport RestoreUtil from \"../../utils/restoreUtil\";\nimport { Trans } from \"react-i18next\";\nimport DropboxUtil from \"../../utils/syncUtils/dropbox\";\nimport { BackupDialogProps, BackupDialogState } from \"./interface\";\nimport TokenDialog from \"../../components/tokenDialog\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass BackupDialog extends React.Component<\n  BackupDialogProps,\n  BackupDialogState\n> {\n  constructor(props: BackupDialogProps) {\n    super(props);\n    this.state = {\n      currentStep: 0,\n      isBackup: \"\",\n      currentDrive: 0,\n    };\n  }\n  handleClose = () => {\n    this.props.handleBackupDialog(false);\n  };\n\n  handleFinish = () => {\n    this.setState({ currentStep: 2 });\n  };\n  handleRestoreToLocal = (event: any) => {\n    event.preventDefault();\n    RestoreUtil.restore(event.target.files[0], this.handleFinish);\n  };\n  showMessage = (message: string) => {\n    this.props.handleMessage(message);\n    this.props.handleMessageBox(true);\n  };\n  handleDrive = (index: number) => {\n    this.setState({ currentDrive: index }, () => {\n      switch (index) {\n        case 0:\n          BackupUtil.backup(\n            this.props.books,\n            this.props.notes,\n            this.props.bookmarks,\n            this.handleFinish,\n            0,\n            this.showMessage\n          );\n          break;\n        case 1:\n          if (!OtherUtil.getReaderConfig(\"dropbox_token\")) {\n            this.props.handleTokenDialog(true);\n            break;\n          }\n          if (this.state.isBackup === \"yes\") {\n            this.showMessage(\"Uploading\");\n            BackupUtil.backup(\n              this.props.books,\n              this.props.notes,\n              this.props.bookmarks,\n              this.handleFinish,\n              1,\n              this.showMessage\n            );\n          } else {\n            this.showMessage(\"Downloading\");\n            DropboxUtil.DownloadFile(this.handleFinish, this.showMessage);\n          }\n\n          break;\n        case 2:\n          this.showMessage(\"Coming Soon\");\n          break;\n\n        case 3:\n          this.showMessage(\"Coming Soon\");\n          break;\n        default:\n          break;\n      }\n    });\n  };\n  render() {\n    const renderDrivePage = () => {\n      return driveList.map((item, index) => {\n        return (\n          <li\n            key={item.id}\n            className=\"backup-page-list-item\"\n            onClick={() => {\n              this.handleDrive(index);\n            }}\n            style={index === 0 || index === 1 ? { opacity: 1 } : {}}\n          >\n            <div className=\"backup-page-list-item-container\">\n              <span\n                className={`icon-${item.icon} backup-page-list-icon`}\n              ></span>\n              <div className=\"backup-page-list-title\">\n                <Trans>{item.name}</Trans>\n              </div>\n            </div>\n          </li>\n        );\n      });\n    };\n    const dialogProps = {\n      driveName: driveList[this.state.currentDrive!].icon,\n      url: driveList[this.state.currentDrive!].url,\n    };\n    return (\n      <div className=\"backup-page-container\">\n        {this.props.isOpenTokenDialog ? <TokenDialog {...dialogProps} /> : null}\n        {this.state.currentStep === 0 ? (\n          <div className=\"backup-page-title\">\n            <Trans>Do you want to backup or restore?</Trans>\n          </div>\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"yes\" ? (\n          <div className=\"backup-page-title\">\n            <Trans>Where to keep your data?</Trans>\n          </div>\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"no\" ? (\n          <div className=\"backup-page-title\">\n            <Trans>Where is your data?</Trans>\n          </div>\n        ) : null}\n        {this.state.currentStep === 0 ? (\n          <div className=\"backup-page-option\">\n            <div\n              className={\n                this.state.isBackup === \"yes\"\n                  ? \"backup-page-backup active\"\n                  : \"backup-page-backup\"\n              }\n              onClick={() => {\n                this.setState({ isBackup: \"yes\" });\n              }}\n            >\n              <span className=\"icon-backup\"></span>\n              <div>\n                <Trans>I want to backup</Trans>\n              </div>\n            </div>\n\n            <div\n              className={\n                this.state.isBackup === \"no\"\n                  ? \"backup-page-backup active\"\n                  : \"backup-page-backup\"\n              }\n              onClick={() => {\n                this.setState({ isBackup: \"no\" });\n              }}\n            >\n              <span className=\"icon-restore\"></span>\n              <div>\n                <Trans>I want to restore</Trans>\n              </div>\n            </div>\n          </div>\n        ) : this.state.currentStep === 1 ? (\n          <div className=\"backup-page-drive-container\">\n            <div>{renderDrivePage()}</div>\n            {this.state.isBackup === \"no\" ? (\n              <input\n                type=\"file\"\n                id=\"restore-file\"\n                accept=\"application/zip\"\n                className=\"restore-file\"\n                name=\"file\"\n                multiple={false}\n                onChange={(event) => {\n                  this.handleRestoreToLocal(event);\n                }}\n              />\n            ) : null}\n          </div>\n        ) : (\n          <div className=\"backup-page-finish-container\">\n            <div className=\"backup-page-finish\">\n              <span className=\"icon-message backup-page-finish-icon\"></span>\n              <div className=\"backup-page-finish-text\">\n                <Trans>\n                  {this.state.isBackup === \"yes\"\n                    ? \"Backup Successfully\"\n                    : \"Restore Successfully\"}\n                </Trans>\n              </div>\n              {this.state.isBackup ? null : (\n                <div style={{ opacity: 0.6 }}>\n                  <Trans>Try refresh or restart</Trans>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n        {this.state.isBackup === \"yes\" && this.state.currentStep === 0 ? (\n          <div className=\"backup-page-backup-selector\"></div>\n        ) : null}\n        {this.state.isBackup === \"no\" && this.state.currentStep === 0 ? (\n          <div\n            className=\"backup-page-backup-selector\"\n            style={{ marginLeft: \"252px\" }}\n          ></div>\n        ) : null}\n        <span\n          className=\"icon-close backup-page-close-icon\"\n          onClick={() => {\n            this.handleClose();\n          }}\n        ></span>\n        {this.state.currentStep === 1 ? (\n          <div\n            className=\"backup-page-next\"\n            onClick={() => {\n              this.setState({ currentStep: 0 });\n            }}\n          >\n            <Trans>Last Step</Trans>\n          </div>\n        ) : this.state.currentStep === 0 ? (\n          <div\n            className=\"backup-page-next\"\n            onClick={() => {\n              this.setState({ currentStep: 1 });\n            }}\n            style={this.state.isBackup ? {} : { display: \"none\" }}\n          >\n            <Trans>Next Step</Trans>\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nexport default BackupDialog;\n","//备份和恢复页面\nimport {\n  handleBackupDialog,\n  handleTokenDialog,\n} from \"../../store/actions/backupPage\";\nimport { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport BackupDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    isOpenTokenDialog: state.backupPage.isOpenTokenDialog,\n  };\n};\nconst actionCreator = {\n  handleBackupDialog,\n  handleMessageBox,\n  handleMessage,\n  handleTokenDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(BackupDialog as any));\n","import React from \"react\";\nimport \"./welcomeDialog.css\";\nimport { welcomeMessage } from \"../../constants/readerConfig\";\nimport { Trans } from \"react-i18next\";\nimport { WelcomeDialogProps, WelcomeDialogState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass WelcomeDialog extends React.Component<\n  WelcomeDialogProps,\n  WelcomeDialogState\n> {\n  constructor(props: WelcomeDialogProps) {\n    super(props);\n    this.state = { currentIndex: 0, isOpenWelcome: false };\n  }\n  handleSkip = () => {\n    this.handleCloseWelcome();\n  };\n  handlePrevious = () => {\n    if (this.state.currentIndex > 0)\n      this.setState({ currentIndex: this.state.currentIndex - 1 });\n  };\n  handleNext = () => {\n    if (this.state.currentIndex < 3)\n      this.setState({ currentIndex: this.state.currentIndex + 1 });\n  };\n  handleCloseWelcome = () => {\n    this.props.handleFirst(\"no\");\n    OtherUtil.setReaderConfig(\"isFirst\", \"no\");\n  };\n  render() {\n    const renderWelcome = () => {\n      return welcomeMessage.map((item, index) => {\n        return (\n          <div\n            className={\n              this.state.currentIndex === index\n                ? \"welcome-message-page welcome-page-animation\"\n                : \"welcome-message-page\"\n            }\n            key={item.sub}\n          >\n            <div className=\"welcome-message-main\">\n              <div>\n                <Trans>{item.main}</Trans>\n              </div>\n            </div>\n            <div className=\"welcome-message-sub\">\n              <Trans>{item.sub}</Trans>\n            </div>\n          </div>\n        );\n      });\n    };\n    return (\n      <div className=\"welcome-page-container\">\n        <div className=\"welcome-title\">\n          <Trans>Hi! Stranger</Trans>\n        </div>\n        <div\n          className=\"welcome-previout-page\"\n          onClick={() => {\n            this.handlePrevious();\n          }}\n        >\n          <span className=\"icon-dropdown welcome-page-icon\"></span>\n        </div>\n        <div\n          className=\"welcome-next-page\"\n          onClick={() => {\n            this.handleNext();\n          }}\n        >\n          <span className=\"icon-dropdown welcome-page-icon\"></span>\n        </div>\n        <div\n          className=\"welcome-message-page-container\"\n          style={{ left: `${86 - this.state.currentIndex * 506}px` }}\n        >\n          {renderWelcome()}\n        </div>\n\n        <ul className=\"welcome-dots-page\">\n          <li\n            className=\"welcome-dots\"\n            style={\n              this.state.currentIndex === 0\n                ? { backgroundColor: \"rgba(112, 112, 112, 1)\" }\n                : {}\n            }\n          ></li>\n          <li\n            className=\"welcome-dots\"\n            style={\n              this.state.currentIndex === 1\n                ? { backgroundColor: \"rgba(112, 112, 112, 1)\" }\n                : {}\n            }\n          ></li>\n          <li\n            className=\"welcome-dots\"\n            style={\n              this.state.currentIndex === 2\n                ? { backgroundColor: \"rgba(112, 112, 112, 1)\" }\n                : {}\n            }\n          ></li>\n          <li\n            className=\"welcome-dots\"\n            style={\n              this.state.currentIndex === 3\n                ? { backgroundColor: \"rgba(112, 112, 112, 1)\" }\n                : {}\n            }\n          ></li>\n        </ul>\n        <div\n          className=\"welcome-button-page\"\n          onClick={() => {\n            this.handleSkip();\n          }}\n        >\n          <div>\n            <Trans>Skip</Trans>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default WelcomeDialog;\n","//欢迎页面\nimport { withNamespaces } from \"react-i18next\";\nimport { handleFirst } from \"../../store/actions/manager\";\nimport { connect } from \"react-redux\";\nimport WelcomeDialog from \"./component\";\n\nconst mapStateToProps = () => {\n  return {};\n};\nconst actionCreator = {\n  handleFirst,\n};\n\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(WelcomeDialog as any));\n","//更新提示弹窗\nimport React from \"react\";\nimport \"./updateDialog.css\";\nimport { UpdateInfoProps, UpdateInfoState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport { updateLog } from \"../../constants/readerConfig\";\n\nclass UpdateDialog extends React.Component<UpdateInfoProps, UpdateInfoState> {\n  constructor(props: UpdateInfoProps) {\n    super(props);\n    this.state = { downlownLink: \"\" };\n  }\n  renderList = (arr: any[]) => {\n    return arr.map((item, index) => {\n      return (\n        <li className=\"update-dialog-list\" key={index}>\n          <span style={{ color: \"black\" }}>{index + 1 + \". \"}</span>\n          <span>{item}</span>\n        </li>\n      );\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"update-dialog-container\">\n        <p className=\"update-dialog-title\">\n          <Trans>What's new about this version</Trans>\n        </p>\n        <p className=\"update-dialog-subtitle\">\n          <Trans>Version</Trans>\n          {updateLog.version}\n        </p>\n        <p className=\"update-dialog-subtitle\">\n          <Trans>Date</Trans>\n          {updateLog.date}\n        </p>\n\n        <div className=\"update-dialog-info\">\n          <p className=\"update-dialog-new-title\">\n            <Trans>What's New</Trans>\n          </p>\n          <ul className=\"update-dialog-new-container\">\n            {this.renderList(updateLog.new)}\n          </ul>\n          <p className=\"update-dialog-fix-title\">\n            <Trans>What's been fixed</Trans>\n          </p>\n          <ul className=\"update-dialog-fix-container\">\n            {this.renderList(updateLog.fix)}\n          </ul>\n        </div>\n\n        <div\n          className=\"update-dialog-container-button\"\n          onClick={() => {\n            this.props.handleUpdateDialog();\n          }}\n        >\n          <Trans>Confirm</Trans>\n        </div>\n        <p className=\"update-dialog-url\">\n          <span style={{ color: \"#959595\" }}>\n            <Trans>Our Website</Trans>\n          </span>\n          koodo.960960.xyz\n        </p>\n        <img\n          src={\n            process.env.NODE_ENV === \"production\"\n              ? \"./assets/empty.svg\"\n              : \"../../assets/empty.svg\"\n          }\n          alt=\"\"\n          className=\"update-dialog-illustration\"\n        />\n      </div>\n    );\n  }\n}\n\nexport default UpdateDialog;\n","//左下角的图标外链\nimport UpdateDialog from \"./component\";\nimport { withNamespaces } from \"react-i18next\";\n\nexport default withNamespaces()(UpdateDialog as any);\n","//左下角的图标外链\nimport React from \"react\";\nimport \"./settingDialog.css\";\nimport { SettingInfoProps, SettingInfoState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport i18n from \"../../i18n\";\nimport { updateLog } from \"../../constants/readerConfig\";\nimport OtherUtil from \"../../utils/otherUtil\";\nconst isElectron = require(\"is-electron\");\n\nclass SettingDialog extends React.Component<\n  SettingInfoProps,\n  SettingInfoState\n> {\n  constructor(props: SettingInfoProps) {\n    super(props);\n    this.state = {\n      language: OtherUtil.getReaderConfig(\"lang\"),\n      isTouch: OtherUtil.getReaderConfig(\"isTouch\") === \"yes\",\n      isOpenBook: OtherUtil.getReaderConfig(\"isOpenBook\") === \"yes\",\n      isUseFont: OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\",\n      isExpandContent: OtherUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\n      isUseBackground: OtherUtil.getReaderConfig(\"isUseBackground\") === \"yes\",\n      isShowFooter: OtherUtil.getReaderConfig(\"isShowFooter\") !== \"no\",\n    };\n  }\n  componentDidMount() {\n    const lng = OtherUtil.getReaderConfig(\"lang\");\n    if (lng) {\n      i18n.changeLanguage(lng);\n      this.setState({\n        language: lng,\n      });\n    }\n  }\n\n  changeLanguage = (lng: string) => {\n    i18n.changeLanguage(lng);\n    this.setState({ language: lng });\n    OtherUtil.setReaderConfig(\"lang\", lng);\n  };\n  handleChangeTouch = () => {\n    this.setState({ isTouch: !this.state.isTouch });\n    OtherUtil.setReaderConfig(\"isTouch\", this.state.isTouch ? \"no\" : \"yes\");\n    this.state.isTouch\n      ? this.props.handleMessage(\"Turn Off Successfully\")\n      : this.props.handleMessage(\"Turn On Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleJump = (url: string) => {\n    isElectron()\n      ? window.require(\"electron\").shell.openExternal(url)\n      : window.open(url);\n  };\n  handleChangeFont = () => {\n    this.setState({ isUseFont: !this.state.isUseFont });\n    OtherUtil.setReaderConfig(\"isUseFont\", this.state.isUseFont ? \"no\" : \"yes\");\n    this.state.isUseFont\n      ? this.props.handleMessage(\"Turn Off Successfully\")\n      : this.props.handleMessage(\"Turn On Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleExpandContent = () => {\n    this.setState({ isExpandContent: !this.state.isExpandContent });\n    OtherUtil.setReaderConfig(\n      \"isExpandContent\",\n      this.state.isExpandContent ? \"no\" : \"yes\"\n    );\n    this.state.isExpandContent\n      ? this.props.handleMessage(\"Turn Off Successfully\")\n      : this.props.handleMessage(\"Turn On Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleChangeOpen = () => {\n    this.setState({ isOpenBook: !this.state.isOpenBook });\n    OtherUtil.setReaderConfig(\n      \"isOpenBook\",\n      this.state.isOpenBook ? \"no\" : \"yes\"\n    );\n    this.state.isOpenBook\n      ? this.props.handleMessage(\"Turn Off Successfully\")\n      : this.props.handleMessage(\"Turn On Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleChangeBackground = () => {\n    this.setState({ isUseBackground: !this.state.isUseBackground });\n    OtherUtil.setReaderConfig(\n      \"isUseBackground\",\n      this.state.isUseBackground ? \"no\" : \"yes\"\n    );\n    this.state.isUseBackground\n      ? this.props.handleMessage(\"Turn Off Successfully\")\n      : this.props.handleMessage(\"Turn On Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleFooterHeader = () => {\n    this.setState({ isShowFooter: !this.state.isShowFooter });\n    OtherUtil.setReaderConfig(\n      \"isShowFooter\",\n      this.state.isShowFooter ? \"no\" : \"yes\"\n    );\n    this.state.isShowFooter\n      ? this.props.handleMessage(\"Turn On Successfully\")\n      : this.props.handleMessage(\"Turn Off Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  render() {\n    return (\n      <div className=\"setting-dialog-container\">\n        <p className=\"setting-dialog-title\">\n          <Trans>Setting</Trans>\n        </p>\n        <p className=\"setting-subtitle\">\n          <Trans>Version</Trans>\n          {updateLog.version}\n        </p>\n        <p className=\"setting-subtitle\">\n          <Trans>Date</Trans>\n          {updateLog.date}\n        </p>\n        <span\n          className=\"icon-close setting-close\"\n          onClick={() => {\n            this.props.handleSetting(false);\n          }}\n        ></span>\n        <div className=\"setting-dialog-info\">\n          <div className=\"setting-dialog-new-title\">\n            {this.state.isTouch ? (\n              <Trans>Turn off touch mode</Trans>\n            ) : (\n              <Trans>Turn on touch mode</Trans>\n            )}\n\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                this.handleChangeTouch();\n              }}\n              style={{ float: \"right\" }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={this.state.isTouch ? { float: \"right\" } : {}}\n              ></span>\n            </span>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Auto open latest book</Trans>\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                this.handleChangeOpen();\n              }}\n              style={{ float: \"right\" }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={this.state.isOpenBook ? { float: \"right\" } : {}}\n              ></span>\n            </span>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Use built-in font</Trans>\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                this.handleChangeFont();\n              }}\n              style={{ float: \"right\" }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={this.state.isUseFont ? { float: \"right\" } : {}}\n              ></span>\n            </span>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Default expand all content</Trans>\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                this.handleExpandContent();\n              }}\n              style={{ float: \"right\" }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={this.state.isExpandContent ? { float: \"right\" } : {}}\n              ></span>\n            </span>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Don't show footer and header</Trans>\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                this.handleFooterHeader();\n              }}\n              style={{ float: \"right\" }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={this.state.isShowFooter ? {} : { float: \"right\" }}\n              ></span>\n            </span>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Dont't use mimical background</Trans>\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                this.handleChangeBackground();\n              }}\n              style={{ float: \"right\" }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={this.state.isUseBackground ? { float: \"right\" } : {}}\n              ></span>\n            </span>\n          </div>\n\n          <div className=\"setting-dialog-new-title\">\n            <Trans>语言 / Language</Trans>\n            <div className=\"setting-language\">\n              {this.state.language === \"cht\" ? (\n                <span\n                  className=\"icon-english\"\n                  onClick={() => this.changeLanguage(\"en\")}\n                ></span>\n              ) : this.state.language === \"en\" ? (\n                <span\n                  className=\"icon-simplified\"\n                  onClick={() => this.changeLanguage(\"zh\")}\n                ></span>\n              ) : (\n                <span\n                  className=\"icon-traditional\"\n                  onClick={() => this.changeLanguage(\"cht\")}\n                ></span>\n              )}\n            </div>\n          </div>\n          <div className=\"about-this-project\">\n            <div\n              className=\"setting-dialog-subtitle\"\n              onClick={() => {\n                this.handleJump(\"https://github.com/troyeguo/koodo-reader\");\n              }}\n            >\n              <Trans>Project link</Trans>\n            </div>\n            <div\n              className=\"setting-dialog-subtitle\"\n              onClick={() => {\n                this.handleJump(\"https://koodo.960960.xyz/\");\n              }}\n            >\n              <Trans>Official website</Trans>\n            </div>\n            <div\n              className=\"setting-dialog-subtitle\"\n              onClick={() => {\n                this.handleJump(\"https://github.com/troyeguo\");\n              }}\n            >\n              <Trans>About author</Trans>\n            </div>\n          </div>\n        </div>\n\n        <img\n          src={\n            process.env.NODE_ENV === \"production\"\n              ? \"./assets/empty.svg\"\n              : \"../../assets/empty.svg\"\n          }\n          alt=\"\"\n          className=\"setting-dialog-illustration\"\n        />\n      </div>\n    );\n  }\n}\n\nexport default SettingDialog;\n","//左下角的图标外链\nimport { connect } from \"react-redux\";\nimport SettingDialog from \"./component\";\nimport { withNamespaces } from \"react-i18next\";\nimport {\n  handleSetting,\n  handleMessageBox,\n  handleMessage,\n} from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = { handleSetting, handleMessageBox, handleMessage };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(SettingDialog as any));\n","//对图书操作的菜单\nimport React from \"react\";\nimport \"./actionDialog.css\";\nimport { Trans } from \"react-i18next\";\nimport { ActionDialogProps } from \"./interface\";\n\nclass ActionDialog extends React.Component<ActionDialogProps> {\n  handleDeleteBook = () => {\n    this.props.handleReadingBook(this.props.currentBook);\n    this.props.handleDeleteDialog(true);\n    this.props.handleActionDialog(false);\n  };\n  handleEditBook = () => {\n    this.props.handleEditDialog(true);\n    this.props.handleReadingBook(this.props.currentBook);\n    this.props.handleActionDialog(false);\n  };\n  handleAddShelf = () => {\n    this.props.handleAddDialog(true);\n    this.props.handleReadingBook(this.props.currentBook);\n    this.props.handleActionDialog(false);\n  };\n  render() {\n    return (\n      <div\n        className=\"action-dialog-container\"\n        onMouseLeave={() => {\n          this.props.handleActionDialog(false);\n        }}\n        style={{ left: this.props.left, top: this.props.top }}\n      >\n        <div className=\"action-dialog-actions-container\">\n          <div\n            className=\"action-dialog-add\"\n            onClick={() => {\n              this.handleAddShelf();\n            }}\n          >\n            <span className=\"icon-shelf view-icon\"></span>\n            <span className=\"action-name\">\n              <Trans>Add</Trans>\n            </span>\n          </div>\n          <div\n            className=\"action-dialog-delete\"\n            onClick={() => {\n              this.handleDeleteBook();\n            }}\n          >\n            <span className=\"icon-trash view-icon\"></span>\n            <span className=\"action-name\">\n              <Trans>Delete</Trans>\n            </span>\n          </div>\n          <div\n            className=\"action-dialog-edit\"\n            onClick={() => {\n              this.handleEditBook();\n            }}\n          >\n            <span className=\"icon-edit view-icon\"></span>\n            <span className=\"action-name\">\n              <Trans>Edit</Trans>\n            </span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ActionDialog;\n","import { connect } from \"react-redux\";\nimport {\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleActionDialog,\n  handleReadingBook,\n} from \"../../store/actions/book\";\n\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport ActionDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {\n  handleEditDialog,\n  handleAddDialog,\n  handleDeleteDialog,\n  handleReadingBook,\n  handleActionDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(ActionDialog as any));\n","//卡片模式下的图书显示\nimport React from \"react\";\nimport RecentBooks from \"../../utils/recordRecent\";\nimport \"./bookCardItem.css\";\nimport { BookProps, BookState } from \"./interface\";\nimport AddFavorite from \"../../utils/addFavorite\";\nimport ActionDialog from \"../../containers/actionDialog\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport { withRouter } from \"react-router-dom\";\n\ndeclare var window: any;\n\nclass BookCardItem extends React.Component<BookProps, BookState> {\n  epub: any;\n  constructor(props: BookProps) {\n    super(props);\n    this.state = {\n      isOpenConfig: false,\n      isFavorite:\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\n      left: 0,\n      top: 0,\n    };\n  }\n\n  componentDidMount() {\n    //控制是否自动打开本书\n    if (\n      OtherUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\n      !this.props.currentBook.key\n    ) {\n      window.open(\n        `${window.location.href.split(\"#\")[0]}#/epub/${this.props.book.key}`\n      );\n    }\n  }\n\n  handleMoreAction = (event: any) => {\n    const e = event || window.event;\n    let x = e.clientX;\n    if (x > document.body.clientWidth - 100) {\n      x = x - 80;\n    }\n    this.setState({ left: x - 210, top: e.clientY - 120 }, () => {\n      this.props.handleActionDialog(true);\n      this.props.handleReadingBook(this.props.book);\n    });\n  };\n  handleLoveBook = () => {\n    AddFavorite.setFavorite(this.props.book.key);\n    this.setState({ isFavorite: true });\n    this.props.handleMessage(\"Add Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleCancelLoveBook = () => {\n    AddFavorite.clear(this.props.book.key);\n    this.setState({ isFavorite: false });\n    this.props.handleMessage(\"Cancel Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  //控制按钮的弹出\n  handleConfig = (mode: boolean) => {\n    this.setState({ isOpenConfig: mode });\n  };\n  handleJump = () => {\n    RecentBooks.setRecent(this.props.book.key);\n\n    if (this.props.book.description === \"pdf\") {\n      window.open(`./lib/pdf/viewer.html?file=${this.props.book.key}`);\n    } else {\n      window.open(\n        `${window.location.href.split(\"#\")[0]}#/epub/${this.props.book.key}`\n      );\n    }\n  };\n  render() {\n    const actionProps = { left: this.state.left, top: this.state.top };\n    return (\n      <>\n        <div\n          className=\"book-list-item\"\n          onMouseOver={() => {\n            this.handleConfig(true);\n          }}\n          onMouseLeave={() => {\n            this.handleConfig(false);\n          }}\n        >\n          {this.props.book.cover && this.props.book.cover !== \"noCover\" ? (\n            <img\n              className=\"book-item-cover\"\n              src={this.props.book.cover}\n              alt=\"\"\n              onClick={() => {\n                this.handleJump();\n              }}\n            />\n          ) : (\n            <div\n              className=\"book-item-cover\"\n              onClick={() => {\n                this.handleJump();\n              }}\n            >\n              <img\n                src={\n                  process.env.NODE_ENV === \"production\"\n                    ? \"./assets/cover.jpg\"\n                    : \"../../assets/cover.jpg\"\n                }\n                alt=\"\"\n                style={{ width: \"100%\" }}\n              />\n            </div>\n          )}\n\n          <p className=\"book-item-title\">{this.props.book.name}</p>\n\n          {this.state.isFavorite ? (\n            <span\n              className=\"icon-love book-loved-icon\"\n              onClick={() => {\n                this.handleCancelLoveBook();\n              }}\n            ></span>\n          ) : null}\n\n          {this.state.isOpenConfig ? (\n            <>\n              <span\n                className=\"icon-more book-more-action\"\n                onClick={(event) => {\n                  this.handleMoreAction(event);\n                }}\n              ></span>\n              <span\n                className=\"icon-love book-love-icon\"\n                onClick={() => {\n                  this.handleLoveBook();\n                }}\n              ></span>\n            </>\n          ) : null}\n        </div>\n        {this.props.isOpenActionDialog &&\n        this.props.book.key === this.props.currentBook.key ? (\n          <ActionDialog {...actionProps} />\n        ) : null}\n      </>\n    );\n  }\n}\nexport default withRouter(BookCardItem);\n","//卡片模式下的图书显示\nimport { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingBook,\n} from \"../../store/actions/book\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport Book from \"./component\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n  handleActionDialog,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(mapStateToProps, actionCreator)(Book);\n","//控制列表模式下的图书显示\nimport React from \"react\";\nimport \"./bookListItem.css\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport { BookItemProps, BookItemState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport AddFavorite from \"../../utils/addFavorite\";\nimport { withRouter } from \"react-router-dom\";\nimport RecentBooks from \"../../utils/recordRecent\";\n\nclass BookListItem extends React.Component<BookItemProps, BookItemState> {\n  epub: any;\n  constructor(props: BookItemProps) {\n    super(props);\n    this.state = {\n      isDeleteDialog: false,\n      isFavorite:\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\n    };\n  }\n  handleDeleteBook = () => {\n    this.props.handleDeleteDialog(true);\n    this.props.handleReadingBook(this.props.book);\n  };\n  handleEditBook = () => {\n    this.props.handleEditDialog(true);\n    this.props.handleReadingBook(this.props.book);\n  };\n  handleAddShelf = () => {\n    this.props.handleAddDialog(true);\n    this.props.handleReadingBook(this.props.book);\n  };\n  handleLoveBook = () => {\n    AddFavorite.setFavorite(this.props.book.key);\n    this.setState({ isFavorite: true });\n    this.props.handleMessage(\"Add Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleCancelLoveBook = () => {\n    AddFavorite.clear(this.props.book.key);\n    this.setState({ isFavorite: false });\n    this.props.handleMessage(\"Cancel Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleJump = () => {\n    RecentBooks.setRecent(this.props.book.key);\n\n    if (this.props.book.description === \"pdf\") {\n      window.open(`./lib/pdf/viewer.html?file=${this.props.book.key}`);\n    } else {\n      window.open(\n        `${window.location.href.split(\"#\")[0]}#/epub/${this.props.book.key}`\n      );\n    }\n  };\n  render() {\n    let percentage = RecordLocation.getCfi(this.props.book.key)\n      ? RecordLocation.getCfi(this.props.book.key).percentage\n      : 0;\n    return (\n      <div className=\"book-list-item-container\">\n        {this.props.book.cover && this.props.book.cover !== \"noCover\" ? (\n          <img\n            className=\"book-item-list-cover\"\n            src={this.props.book.cover}\n            alt=\"\"\n            onClick={() => {\n              this.handleJump();\n            }}\n          />\n        ) : (\n          <div\n            className=\"book-item-list-cover book-item-list-cover-img\"\n            onClick={() => {\n              this.handleJump();\n            }}\n          >\n            <img\n              src={\n                process.env.NODE_ENV === \"production\"\n                  ? \"./assets/cover.jpg\"\n                  : \"../../assets/cover.jpg\"\n              }\n              alt=\"\"\n              style={{ width: \"100%\" }}\n            />\n          </div>\n        )}\n        <p\n          className=\"book-item-list-title\"\n          onClick={() => {\n            this.handleJump();\n          }}\n        >\n          {this.props.book.name}\n        </p>\n\n        <p className=\"book-item-list-author\">\n          {this.props.book.author ? (\n            this.props.book.author\n          ) : (\n            <Trans>Unknown Authur</Trans>\n          )}\n        </p>\n        <p className=\"book-item-list-percentage\">\n          {percentage ? Math.round(percentage * 100) : 0}%\n        </p>\n        <div className=\"book-item-list-config\">\n          {this.state.isFavorite ? (\n            <span\n              className=\"icon-love list-icon\"\n              onClick={() => {\n                this.handleCancelLoveBook();\n              }}\n              style={{ color: \"#f87356\" }}\n            ></span>\n          ) : (\n            <span\n              className=\"icon-love list-icon\"\n              onClick={() => {\n                this.handleLoveBook();\n              }}\n            ></span>\n          )}\n\n          <span\n            className=\"icon-shelf list-icon\"\n            onClick={() => {\n              this.handleAddShelf();\n            }}\n            color=\"rgba(75,75,75,1)\"\n          ></span>\n          <span\n            className=\"icon-trash list-icon\"\n            onClick={() => {\n              this.handleDeleteBook();\n            }}\n          ></span>\n          <span\n            className=\"icon-edit list-icon\"\n            onClick={() => {\n              this.handleEditBook();\n            }}\n          ></span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(BookListItem);\n","//控制列表模式下的图书显示\nimport { connect } from \"react-redux\";\nimport {\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleReadingBook,\n} from \"../../store/actions/book\";\nimport { withNamespaces } from \"react-i18next\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\n\nimport { stateType } from \"../../store\";\nimport BookItem from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isReading: state.book.isReading,\n    percentage: state.progressPanel.percentage,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(BookItem as any));\n","import BookModel from \"../model/Book\";\nconst getBookName = (books: BookModel[]) => {\n  let nameArr: string[] = [];\n  books.forEach((item: BookModel) => {\n    nameArr.push(item.name);\n  });\n  return nameArr;\n};\nconst getBookIndex = (nameArr: string[], oldNameArr: string[]) => {\n  let indexArr: number[] = [];\n  nameArr.forEach((item) => {\n    indexArr.push(oldNameArr.indexOf(item));\n  });\n  return indexArr;\n};\nclass SortUtil {\n  static sortBooks(\n    books: BookModel[],\n    sortCode: { sort: number; order: number }\n  ) {\n    if (sortCode.sort === 1 && sortCode.order === 1) {\n      let oldNameArr = getBookName(books);\n      let nameArr = getBookName(books).sort();\n      return getBookIndex(nameArr, oldNameArr);\n    }\n    if (sortCode.sort === 1 && sortCode.order === 2) {\n      let oldNameArr = getBookName(books);\n      let nameArr = getBookName(books).sort().reverse();\n      return getBookIndex(nameArr, oldNameArr);\n    }\n    if (sortCode.sort === 2 && sortCode.order === 1) {\n      let nameArr = [];\n      for (let i = 0; i < books.length; i++) {\n        nameArr.push(i);\n      }\n      return nameArr;\n    }\n    if (sortCode.sort === 2 && sortCode.order === 2) {\n      let nameArr = [];\n      for (let i = 0; i < books.length; i++) {\n        nameArr.push(i);\n      }\n      return nameArr.reverse();\n    }\n  }\n}\n\nexport default SortUtil;\n","import React from \"react\";\n// import \"./deletePopup.css\";\nimport { Trans } from \"react-i18next\";\nimport { DeletePopupProps } from \"./interface\";\n\nclass DeletePopup extends React.Component<DeletePopupProps> {\n  handleCancel = () => {\n    this.props.handleDeletePopup(false);\n  };\n  handleComfirm = () => {\n    //从列表删除和从图书库删除判断\n    this.props.handleDeletePopup(false);\n    this.props.handleDeleteOpearion();\n    this.props.handleMessage(\"Delete Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  render() {\n    return (\n      <div className=\"delete-dialog-container\">\n        <div className=\"delete-dialog-title\">\n          <Trans>{this.props.title}</Trans>\n        </div>\n\n        <div className=\"delete-dialog-book\">\n          <div className=\"delete-dialog-book-title\">{this.props.name}</div>\n        </div>\n\n        <div className=\"delete-dialog-other-option\">\n          <Trans>{this.props.description}</Trans>\n        </div>\n\n        <div\n          className=\"delete-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"delete-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Delete</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default DeletePopup;\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchBooks,\n  handleMessageBox,\n  handleMessage,\n} from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport DeletePopup from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(DeletePopup as any));\n","//为空页面\nimport React from \"react\";\nimport \"./emptyPage.css\";\nimport { emptyList } from \"../../constants/readerConfig\";\nimport { Trans } from \"react-i18next\";\nimport { EmptyPageProps, EmptyPageState } from \"./interface\";\n\nclass EmptyPage extends React.Component<EmptyPageProps, EmptyPageState> {\n  render() {\n    const renderEmptyList = () => {\n      return emptyList.map((item) => {\n        return (\n          <div\n            className=\"empty-page-info-container\"\n            key={item.mode}\n            style={\n              this.props.mode === item.mode ? {} : { visibility: \"hidden\" }\n            }\n          >\n            <div className=\"empty-page-info-main\">\n              <Trans>{item.main}</Trans>\n            </div>\n            <div className=\"empty-page-info-sub\">\n              <Trans>{item.sub}</Trans>\n            </div>\n          </div>\n        );\n      });\n    };\n    return (\n      <div className=\"empty-page-container\">\n        <img\n          src={\n            process.env.NODE_ENV === \"production\"\n              ? \"./assets/empty.svg\"\n              : \"../../assets/empty.svg\"\n          }\n          alt=\"\"\n          className=\"empty-page-illustration\"\n        />\n        {renderEmptyList()}\n      </div>\n    );\n  }\n}\n\nexport default EmptyPage;\n","//为空页面\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport EmptyPage from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    mode: state.sidebar.mode,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(EmptyPage as any));\n","//全部图书，最近阅读，搜索结果，排序结果的数据\nimport React from \"react\";\nimport \"./booklist.css\";\nimport Book from \"../../components/bookCardtem\";\nimport BookItem from \"../../components/bookListItem\";\nimport AddFavorite from \"../../utils/addFavorite\";\nimport RecordRecent from \"../../utils/recordRecent\";\nimport ShelfUtil from \"../../utils/shelfUtil\";\nimport SortUtil from \"../../utils/sortUtil\";\nimport BookModel from \"../../model/Book\";\nimport { Trans, NamespacesConsumer } from \"react-i18next\";\nimport { BookListProps, BookListState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport localforage from \"localforage\";\nimport DeletePopup from \"../../components/deletePopup\";\nimport Empty from \"../emptyPage\";\nimport { Redirect, withRouter } from \"react-router-dom\";\n\ndeclare var window: any;\n\nclass BookList extends React.Component<BookListProps, BookListState> {\n  constructor(props: BookListProps) {\n    super(props);\n    this.state = {\n      shelfIndex: 0,\n      isOpenDelete: false,\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n    };\n  }\n  componentDidMount() {\n    if (!this.props.books || !this.props.books[0]) {\n      return <Redirect to=\"manager/empty\" />;\n    }\n    this.handleOldVersion();\n  }\n  handleOldVersion = async () => {\n    if (!this.props.books[0].cover) {\n      let bookArr: any = this.props.books;\n      for (let i = 0; i < bookArr.length; i++) {\n        await new Promise(async (resolve, reject) => {\n          let epub;\n          if (bookArr[i].content) {\n            epub = window.ePub(bookArr[i].content, {});\n            localforage.setItem(bookArr[i].key, bookArr[i].content).then(() => {\n              delete bookArr[i].content;\n            });\n          } else {\n            let data = await new Promise((resolve, reject) => {\n              localforage.getItem(bookArr[i].key).then((result) => {\n                resolve(result);\n              });\n            });\n            epub = window.ePub(data, {});\n          }\n\n          let url = await epub.coverUrl();\n          var reader = new FileReader();\n          let blob = await fetch(url).then((r) => r.blob());\n          reader.readAsDataURL(blob);\n          reader.onloadend = () => {\n            let cover = reader.result;\n            bookArr[i].cover = cover;\n            resolve();\n          };\n        });\n      }\n\n      localforage.setItem(\"books\", bookArr).then(() => {\n        window.location.reload();\n      });\n    }\n  };\n  handleFavorite = (items: any[], arr: string[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items.forEach((subItem: any) => {\n        if (subItem.key === item) {\n          itemArr.push(subItem);\n        }\n      });\n    });\n    return itemArr;\n  };\n  //根据localstorage列表的数据，得到最近阅读的图书\n  handleRecent = (items: any[], arr: string[]) => {\n    let itemArr: any[] = [];\n    //兼容之前的版本\n    if (!arr[0] || arr.length !== items.length) {\n      RecordRecent.setAllRecent(items);\n      return items;\n    }\n    arr.forEach((item) => {\n      items.forEach((subItem: any) => {\n        if (subItem.key === item) {\n          itemArr.push(subItem);\n        }\n      });\n    });\n    return itemArr;\n  };\n\n  //获取书架数据\n  handleShelf(items: any, index: number) {\n    //获取书架名\n    if (index < 1) return items;\n    let shelfTitle = Object.keys(ShelfUtil.getShelf());\n    //获取当前书架名\n    let currentShelfTitle = shelfTitle[index];\n    if (!currentShelfTitle) return items;\n    //获取当前书架的图书列表\n    let currentShelfList = ShelfUtil.getShelf()[currentShelfTitle];\n    //根据图书列表获取到图书数据\n    let shelfItems = items.filter((item: { key: number }) => {\n      return currentShelfList.indexOf(item.key) > -1;\n    });\n    return shelfItems;\n  }\n  //控制卡片模式和列表模式的切换\n  handleChange = (mode: string) => {\n    OtherUtil.setReaderConfig(\"isList\", mode);\n    this.props.handleFetchList();\n  };\n  //根据搜索图书index获取到搜索出的图书\n  handleFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n    return itemArr;\n  };\n  renderBookList = () => {\n    //根据不同的场景获取不同的图书数据\n    let books = this.props.isSearch\n      ? this.handleFilter(this.props.books, this.props.searchResults)\n      : this.props.shelfIndex > 0\n      ? this.handleShelf(this.props.books, this.props.shelfIndex)\n      : this.props.mode === \"favorite\" && !this.props.isSort\n      ? this.handleFavorite(this.props.books, AddFavorite.getAllFavorite())\n      : this.props.mode === \"favorite\" && this.props.isSort\n      ? this.handleFilter(\n          this.handleFavorite(this.props.books, AddFavorite.getAllFavorite()),\n          //返回排序后的图书index\n          SortUtil.sortBooks(this.props.books, this.props.sortCode) || []\n        )\n      : this.props.isSort\n      ? this.handleFilter(\n          this.props.books,\n          //返回排序后的图书index\n          SortUtil.sortBooks(this.props.books, this.props.sortCode) || []\n        )\n      : this.handleRecent(this.props.books, RecordRecent.getAllRecent());\n    if (this.props.mode === \"shelf\" && books.length === 0) {\n      return (\n        <div\n          style={{\n            position: \"fixed\",\n            left: 0,\n            top: 0,\n            width: \"100%\",\n            height: \"100%\",\n            zIndex: -1,\n          }}\n        >\n          <Empty />\n        </div>\n      );\n    }\n\n    return books.map((item: BookModel, index: number) => {\n      return this.props.isList === \"list\" ? (\n        <BookItem\n          {...{\n            key: item.key,\n            book: item,\n          }}\n        />\n      ) : (\n        <Book key={item.key} book={item} />\n      );\n    });\n  };\n  //切换书架\n  handleShelfItem = (event: any) => {\n    let index = event.target.value.split(\",\")[1];\n    this.setState({ shelfIndex: index });\n    this.props.handleShelfIndex(index);\n    if (index > 0) {\n      this.props.handleMode(\"shelf\");\n    } else {\n      this.props.handleMode(\"home\");\n    }\n  };\n  handleDeleteShelf = () => {\n    if (this.state.shelfIndex < 1) return;\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\n    //获取当前书架名\n    let currentShelfTitle = shelfTitles[this.state.shelfIndex];\n    ShelfUtil.removeShelf(currentShelfTitle);\n    this.setState({ shelfIndex: 0 }, () => {\n      this.props.handleShelfIndex(0);\n      this.props.handleMode(\"shelf\");\n    });\n  };\n  renderShelfList = () => {\n    let shelfList = ShelfUtil.getShelf();\n    let shelfTitle = Object.keys(shelfList);\n    return shelfTitle.map((item, index) => {\n      return (\n        <NamespacesConsumer key={index}>\n          {(t) => (\n            <option\n              value={[item, index.toString()]}\n              key={index}\n              className=\"add-dialog-shelf-list-option\"\n              selected={this.props.shelfIndex === index ? true : false}\n            >\n              {t(item === \"New\" ? \"All Books\" : item)}\n            </option>\n          )}\n        </NamespacesConsumer>\n      );\n    });\n  };\n  handleDeletePopup = (isOpenDelete: boolean) => {\n    this.setState({ isOpenDelete });\n  };\n  render() {\n    if (\n      (this.state.favoriteBooks === 0 && this.props.mode === \"favorite\") ||\n      !this.props.books ||\n      !this.props.books[0]\n    ) {\n      return <Redirect to=\"/manager/empty\" />;\n    }\n    const deletePopupProps = {\n      mode: \"shelf\",\n      name: Object.keys(ShelfUtil.getShelf())[this.state.shelfIndex],\n      title: \"Delete this shelf\",\n      description: \"This action will clear and remove this shelf\",\n      handleDeletePopup: this.handleDeletePopup,\n      handleDeleteOpearion: this.handleDeleteShelf,\n    };\n    OtherUtil.setReaderConfig(\"totalBooks\", this.props.books.length.toString());\n    return (\n      <>\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\n        <div className=\"book-list-view\">\n          <div\n            className=\"card-list-mode\"\n            onClick={() => {\n              this.handleChange(\"card\");\n            }}\n            style={\n              this.props.isList === \"card\"\n                ? {}\n                : { color: \"rgba(75,75,75,0.5)\" }\n            }\n          >\n            <span className=\"icon-grid\"></span>\n            <Trans>Card Mode</Trans>\n          </div>\n          <div\n            className=\"list-view-mode\"\n            onClick={() => {\n              this.handleChange(\"list\");\n            }}\n            style={\n              this.props.isList === \"list\"\n                ? {}\n                : { color: \"rgba(75,75,75,0.5)\" }\n            }\n          >\n            <span className=\"icon-list\"></span> <Trans>List Mode</Trans>\n          </div>\n        </div>\n        <div className=\"booklist-shelf-container\">\n          <p className=\"general-setting-title\" style={{ display: \"inline\" }}>\n            <Trans>My Shelves</Trans>\n          </p>\n          <select\n            className=\"booklist-shelf-list\"\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\n              this.handleShelfItem(event);\n            }}\n          >\n            {this.renderShelfList()}\n          </select>\n          {this.state.shelfIndex > 0 ? (\n            <span\n              className=\"icon-trash delete-shelf-icon\"\n              onClick={() => {\n                this.handleDeletePopup(true);\n              }}\n            ></span>\n          ) : null}\n        </div>\n        <div className=\"book-list-container-parent\">\n          <div className=\"book-list-container\">\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default withRouter(BookList);\n","//全部图书，最近阅读，搜索结果，排序结果的数据\nimport { connect } from \"react-redux\";\nimport { handleFetchList } from \"../../store/actions/manager\";\nimport { handleMode, handleShelfIndex } from \"../../store/actions/sidebar\";\n\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport BookList from \"./component\";\n\nconst mappropsToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    mode: state.sidebar.mode,\n    shelfIndex: state.sidebar.shelfIndex,\n    searchResults: state.manager.searchResults,\n    isSearch: state.manager.isSearch,\n    isSort: state.manager.isSort,\n    isList: state.manager.isList,\n    sortCode: state.manager.sortCode,\n  };\n};\nconst actionCreator = { handleFetchList, handleMode, handleShelfIndex };\nexport default connect(\n  mappropsToProps,\n  actionCreator\n)(withNamespaces()(BookList as any));\n","//我的书签页面\nimport React from \"react\";\nimport \"./bookmarkPage.css\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport BookmarkModel from \"../../model/Bookmark\";\nimport BookModel from \"../../model/Book\";\nimport { Trans } from \"react-i18next\";\nimport { BookmarkPageProps, BookmarkPageState } from \"./interface\";\nimport { Redirect, withRouter } from \"react-router-dom\";\n\ndeclare var window: any;\n\nclass BookmarkPage extends React.Component<\n  BookmarkPageProps,\n  BookmarkPageState\n> {\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchBookmarks();\n  }\n  //点击跳转后跳转到指定页面\n  handleRedirect = (key: string, cfi: string, percentage: number) => {\n    let { books } = this.props;\n    let book: any;\n    //根据bookKey获取指定的book\n    for (let i = 0; i < books.length; i++) {\n      if (books[i].key === key) {\n        book = books[i];\n        break;\n      }\n    }\n    if (!cfi || !percentage) {\n      cfi = RecordLocation.getCfi(book!.key).cfi;\n      percentage = RecordLocation.getCfi(book!.key).percentage;\n    }\n    if (!book) {\n      this.props.handleMessage(\"Book not exsit\");\n      this.props.handleMessageBox(true);\n      return;\n    }\n    RecordLocation.recordCfi(key, cfi, percentage);\n    window.open(`${window.location.href.split(\"#\")[0]}#/epub/${book.key}`);\n  };\n  render() {\n    let { bookmarks, books } = this.props;\n    let bookKeyArr: string[] = [];\n    if (bookmarks.length === 0) {\n      return <Redirect to=\"/manager/empty\" />;\n    }\n    //获取bookmarks中的图书列表\n    bookmarks.forEach((item) => {\n      if (bookKeyArr.indexOf(item.bookKey) === -1) {\n        bookKeyArr.push(item.bookKey);\n        return false;\n      }\n    });\n    //根据图书列表获取图书数据\n    let bookArr = books.filter((item) => {\n      return bookKeyArr.indexOf(item.key) > -1;\n    });\n    let bookmarkObj: { [key: string]: any } = {};\n    bookmarks.forEach((item) => {\n      //bookmarkobj没有此书就新建\n      if (!bookmarkObj[item.bookKey] && bookKeyArr.indexOf(item.bookKey) > -1) {\n        bookmarkObj[item.bookKey] = [];\n      }\n      //往bookmarkobj里填充书签信息，最终获得以bookkey为键，bookmark为值的对象\n      if (bookKeyArr.indexOf(item.bookKey) > -1) {\n        bookmarkObj[item.bookKey].push(item);\n      }\n      return false;\n    });\n    const renderBookmarklistItem = (item: BookModel) => {\n      return bookmarkObj[item.key].reverse().map((item: BookmarkModel) => (\n        <li className=\"bookmark-page-list-item\" key={item.key}>\n          <div className=\"bookmark-page-list-item-title\">\n            <Trans>{item.chapter}</Trans>\n          </div>\n          <div className=\"bookmark-page-progress\">\n            {Math.round(item.percentage * 100)}%\n          </div>\n          <div\n            className=\"bookmark-page-list-item-link\"\n            onClick={() => {\n              this.handleRedirect(item.bookKey, item.cfi, item.percentage);\n            }}\n          >\n            <div className=\"bookmark-page-list-item-link-text\">\n              <Trans>Go To</Trans>\n            </div>\n          </div>\n        </li>\n      ));\n    };\n    const renderBookmarkPage = () => {\n      return bookArr.map((item, index) => {\n        return (\n          <li className=\"bookmark-page-item\" key={item.key}>\n            <img\n              className=\"bookmark-page-cover\"\n              src={item.cover}\n              alt=\"\"\n              onClick={() => {\n                this.handleRedirect(item.key, \"\", 0);\n              }}\n            />\n            <p className=\"bookmark-page-name\">{bookArr[index].name}</p>\n            <div className=\"bookmark-page-bookmark-container-parent\">\n              <ul className=\"bookmark-page-bookmark-container\">\n                {renderBookmarklistItem(item)}\n              </ul>\n            </div>\n          </li>\n        );\n      });\n    };\n    return (\n      <div className=\"bookmark-page-container-parent\">\n        <div className=\"bookmark-page-container\">{renderBookmarkPage()}</div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(BookmarkPage);\n","//我的书签页面\nimport { connect } from \"react-redux\";\nimport { handleFetchBookmarks } from \"../../store/actions/reader\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport BookmarkPage from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    bookmarks: state.reader.bookmarks,\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {\n  handleFetchBookmarks,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(BookmarkPage as any));\n","export function handleOpenMenu(isOpenMenu: boolean) {\n  return { type: \"HANDLE_OPEN_MENU\", payload: isOpenMenu };\n}\nexport function handleMenuMode(menuMode: string) {\n  return { type: \"HANDLE_MENU_MODE\", payload: menuMode };\n}\nexport function handleOpenHighlight(isOpenHighlight: boolean) {\n  return { type: \"HANDLE_OPEN_HIGHLIGHT\", payload: isOpenHighlight };\n}\nexport function handleChangeDirection(isChangeDirection: boolean) {\n  return { type: \"HANDLE_CHANGE_DIRECTION\", payload: isChangeDirection };\n}\nexport function handleShowBookmark(isShowBookmark: boolean) {\n  return { type: \"HANDLE_SHOW_BOOKMARK\", payload: isShowBookmark };\n}\nexport function handleSelection(selection: string) {\n  return { type: \"HANDLE_SELECTION\", payload: selection };\n}\n","class TagUtil {\n  static setTags(tagName: string) {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    const index = tagArr.indexOf(tagName);\n    if (index > -1) {\n      tagArr.splice(index, 1);\n      tagArr.unshift(tagName);\n    } else {\n      tagArr.unshift(tagName);\n    }\n\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\n  }\n\n  static clear(tagName: string) {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    const index = tagArr.indexOf(tagName);\n    if (index > -1) {\n      tagArr.splice(index, 1);\n    }\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\n  }\n  static getAllTags() {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    return tagArr || [];\n  }\n}\n\nexport default TagUtil;\n","//我的书摘页面\nimport React from \"react\";\nimport \"./deleteIcon.css\";\nimport { DeleteIconProps, DeleteIconStates } from \"./interface\";\nimport localforage from \"localforage\";\nimport TagUtil from \"../../utils/tagUtil\";\nimport DeletePopup from \"../deletePopup\";\n\nclass DeleteIcon extends React.Component<DeleteIconProps, DeleteIconStates> {\n  constructor(props: DeleteIconProps) {\n    super(props);\n    this.state = {\n      deleteIndex: -1,\n      isOpenDelete: false,\n    };\n  }\n\n  handleDelete = () => {\n    let deleteItems =\n      this.props.mode === \"notes\"\n        ? this.props.notes\n        : this.props.mode === \"tags\"\n        ? TagUtil.getAllTags()\n        : this.props.bookmarks;\n    let deleteFunc =\n      this.props.mode === \"notes\"\n        ? this.props.handleFetchNotes\n        : this.props.handleFetchBookmarks;\n    deleteItems.forEach((item: any, index: number) => {\n      if (this.props.mode === \"tags\") {\n        console.log(this.props.tagName, this.props.mode);\n        item === this.props.tagName && TagUtil.clear(item);\n        return;\n      }\n      if (item.key === this.props.itemKey) {\n        deleteItems.splice(index, 1);\n        if (deleteItems.length === 0) {\n          localforage\n            .removeItem(this.props.mode)\n            .then(() => {\n              deleteFunc();\n              this.props.handleMessage(\"Delete Successfully\");\n              this.props.handleMessageBox(true);\n            })\n            .catch(() => {\n              console.log(\"删除失败\");\n            });\n        } else {\n          localforage\n            .setItem(this.props.mode, deleteItems)\n            .then(() => {\n              deleteFunc();\n              this.props.handleMessage(\"Delete Successfully\");\n              this.props.handleMessageBox(true);\n            })\n            .catch(() => {\n              console.log(\"修改失败\");\n            });\n        }\n      }\n    });\n    // if (this.props.isReading && this.props.mode === \"notes\") {\n    //   this.props.renderHighlighters();\n    //   this.props.handleShowDelete(\"\");\n    // }\n  };\n  handleDeletePopup = (isOpenDelete: boolean) => {\n    this.setState({ isOpenDelete });\n    if (!isOpenDelete) {\n      this.props.handleChangeTag(this.props.index);\n    }\n  };\n  render() {\n    const deletePopupProps = {\n      name: this.props.tagName,\n      title: \"Delete this tag\",\n      description: \"This action will clear and remove this tag\",\n      handleDeletePopup: this.handleDeletePopup,\n      handleDeleteOpearion: this.handleDelete,\n    };\n    return (\n      <>\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\n        <div\n          className=\"delete-digest-button\"\n          onClick={() => {\n            this.props.mode === \"tags\"\n              ? this.handleDeletePopup(true)\n              : this.handleDelete();\n          }}\n        >\n          <span className=\"icon-close delete-digest-icon\"></span>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default DeleteIcon;\n","//我的书摘页面\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport {\n  handleFetchBookmarks,\n  handleFetchNotes,\n} from \"../../store/actions/reader\";\nimport { handleShowBookmark } from \"../../store/actions/viewArea\";\nimport DeleteIcon from \"./component\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {\n  handleFetchBookmarks,\n  handleFetchNotes,\n  handleMessageBox,\n  handleMessage,\n  handleShowBookmark,\n};\nexport default connect(mapStateToProps, actionCreator)(DeleteIcon as any);\n","//我的书摘，笔记的卡片\nimport React from \"react\";\nimport \"./cardList.css\";\nimport NoteModel from \"../../model/Note\";\nimport { Trans } from \"react-i18next\";\nimport { CardListProps, CardListStates } from \"./interface\";\nimport DeleteIcon from \"../../components/deleteIcon\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport { withRouter } from \"react-router-dom\";\nimport { Redirect } from \"react-router-dom\";\n\ndeclare var window: any;\n\nclass CardList extends React.Component<CardListProps, CardListStates> {\n  constructor(props: CardListProps) {\n    super(props);\n    this.state = { deleteKey: \"\" };\n  }\n  //根据bookkey获取\n  handleBookName = (bookKey: string) => {\n    let { books } = this.props;\n    let bookName = \"\";\n    for (let i = 0; i < this.props.books.length; i++) {\n      if (books[i].key === bookKey) {\n        bookName = books[i].name;\n        break;\n      }\n    }\n    return bookName;\n  };\n  handleShowDelete = (deleteKey: string) => {\n    this.setState({ deleteKey });\n  };\n  handleJump = (cfi: string, bookKey: string, percentage: number) => {\n    let { books } = this.props;\n    let book: any;\n    //根据bookKey获取指定的book和epub\n    for (let i = 0; i < books.length; i++) {\n      if (books[i].key === bookKey) {\n        book = books[i];\n        break;\n      }\n    }\n    if (!book) {\n      this.props.handleMessage(\"Book not exsit\");\n      this.props.handleMessageBox(true);\n      return;\n    }\n    RecordLocation.recordCfi(bookKey, cfi, percentage);\n    window.open(`${window.location.href.split(\"#\")[0]}#/epub/${book.key}`);\n  };\n  render() {\n    let { cards } = this.props;\n    if (cards.length === 0) {\n      return <Redirect to=\"/manager/empty\" />;\n    }\n    let cardArr = [];\n    //使书摘从晚到早排序\n    for (let i = cards.length - 1; i >= 0; i--) {\n      cardArr.push(cards[i]);\n    }\n    let dateArr = [cardArr[0].date];\n    let temp = cardArr[0].date;\n    //获取同一天的所有书摘\n    for (let i = 1; i < cardArr.length; i++) {\n      if (\n        cardArr[i].date.year !== temp.year ||\n        cardArr[i].date.month !== temp.month ||\n        cardArr[i].date.day !== temp.day\n      ) {\n        dateArr.push(cardArr[i].date);\n        temp = cardArr[i].date;\n      }\n    }\n    //得到以日期为键，书摘为值的对象\n    let cardObj: { [key: string]: any } = {};\n    dateArr.forEach((date) => {\n      cardObj[\"\" + date.year + date.month + date.day] = [];\n    });\n    cardArr.forEach((card) => {\n      dateArr.forEach((date) => {\n        if (\n          date.year === card.date.year &&\n          date.month === card.date.month &&\n          date.day === card.date.day\n        ) {\n          cardObj[\"\" + date.year + date.month + date.day].push(card);\n        }\n      });\n    });\n    const renderCardListItem = (date: string) => {\n      return cardObj[date].map((item: NoteModel, index: number) => {\n        const cardProps = {\n          itemKey: item.key,\n          mode: \"notes\",\n        };\n        return (\n          <li\n            className=\"card-list-item\"\n            key={index}\n            onMouseOver={() => {\n              this.handleShowDelete(item.key);\n            }}\n            onMouseLeave={() => {\n              this.handleShowDelete(\"\");\n            }}\n          >\n            {this.state.deleteKey === item.key ? (\n              <DeleteIcon {...cardProps} />\n            ) : null}\n            <div className=\"card-list-item-card\">\n              <div className=\"card-list-item-text-parent\">\n                <div className=\"card-list-item-text\">\n                  {this.props.mode === \"note\" ? item.notes : item.text}\n                </div>\n              </div>\n              <div className=\"card-list-item-citation\">\n                <div className=\"card-list-item-title\">\n                  <Trans>From</Trans>《\n                </div>\n                <div className=\"card-list-item-chapter card-list-item-title\">\n                  {this.handleBookName(item.bookKey)}\n                </div>\n                <div className=\"card-list-item-chapter card-list-item-title\">\n                  》<Trans>{item.chapter}</Trans>\n                </div>\n              </div>\n              <div\n                onClick={() => {\n                  this.handleJump(item.cfi, item.bookKey, item.percentage);\n                }}\n              >\n                <div\n                  className=\"card-list-item-show-more\"\n                  style={{ color: \"rgba(75,75,75,0.8)\", bottom: \"10px\" }}\n                >\n                  {this.props.mode === \"note\" ? (\n                    <Trans>{\"More Notes\"}</Trans>\n                  ) : (\n                    <Trans>{\"More Digests\"}</Trans>\n                  )}\n\n                  <span className=\"icon-dropdown icon-card-right\"></span>\n                </div>\n              </div>\n            </div>\n          </li>\n        );\n      });\n    };\n    const renderCardList = () => {\n      return dateArr.map((item, index) => {\n        return (\n          <li className=\"card-page-item\" key={index}>\n            <div className=\"card-page-item-date\">{`${item.year}-${item.month}-${item.day}`}</div>\n            <ul className=\"card-list-container-box\">\n              {renderCardListItem(\"\" + item.year + item.month + item.day)}\n            </ul>\n          </li>\n        );\n      });\n    };\n    return <div className=\"card-list-container\">{renderCardList()}</div>;\n  }\n}\n\nexport default withRouter(CardList);\n","//我的书摘页面\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport CardList from \"./component\";\nimport { handleReadingBook } from \"../../store/actions/book\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    chapters: state.reader.chapters,\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(CardList as any));\n","//笔记书摘的标签\nimport React from \"react\";\nimport \"./noteTag.css\";\nimport { NoteTagProps, NoteTagState } from \"./interface\";\nimport TagUtil from \"../../utils/tagUtil\";\nimport DeleteIcon from \"../deleteIcon\";\nimport { Trans } from \"react-i18next\";\n\nclass NoteTag extends React.Component<NoteTagProps, NoteTagState> {\n  constructor(props: NoteTagProps) {\n    super(props);\n    this.state = {\n      tagIndex: [],\n      isInput: false,\n      deleteIndex: -1,\n    };\n  }\n  componentDidMount() {\n    if (this.props.isReading) {\n      this.setState({ tagIndex: this.tagToIndex(this.props.tag) });\n    }\n  }\n  componentWillReceiveProps(nextProps: NoteTagProps) {\n    if (\n      this.props.isReading &&\n      nextProps.tag &&\n      nextProps.tag.length > 0 &&\n      this.props.tag !== nextProps.tag\n    ) {\n      this.setState({ tagIndex: this.tagToIndex(nextProps.tag) });\n    }\n  }\n  tagToIndex = (tag: string[]) => {\n    let temp = [];\n    if (!tag) return [];\n    for (let i = 0; i < TagUtil.getAllTags().length; i++) {\n      if (tag.indexOf(TagUtil.getAllTags()[i]) > -1) {\n        temp.push(i);\n      }\n    }\n    return temp;\n  };\n  indextoTag = (tagIndex: number[]) => {\n    let temp = [];\n    for (let i = 0; i < tagIndex.length; i++) {\n      temp.push(TagUtil.getAllTags()[tagIndex[i]]);\n    }\n    return temp;\n  };\n  handleChangeTag = (index: number) => {\n    let temp: number[] = [...this.state.tagIndex];\n    if (this.state.tagIndex.indexOf(index) > -1) {\n      temp = [...this.state.tagIndex];\n      let indexResult = temp.indexOf(index);\n      temp.splice(indexResult, 1);\n      this.setState({ tagIndex: temp });\n      this.props.handleTag(this.indextoTag(temp));\n    } else {\n      temp.push(index);\n      this.setState({ tagIndex: temp });\n      this.props.handleTag(this.indextoTag(temp));\n    }\n  };\n  handleAddTag = (event: any) => {\n    this.setState({ isInput: false });\n    if (!event.target.value) {\n      return;\n    }\n    TagUtil.setTags(event.target.value);\n    this.setState({ tagIndex: [] });\n    this.props.handleTag(this.indextoTag([]));\n  };\n  handleInput = () => {\n    this.setState({ isInput: true });\n  };\n  render() {\n    const renderTag = () => {\n      let noteTags = TagUtil.getAllTags();\n      return noteTags.map((item: any, index: number) => {\n        return (\n          <li\n            key={item}\n            className={\n              this.state.tagIndex.indexOf(index) > -1\n                ? \"tag-list-item active-tag \"\n                : \"tag-list-item\"\n            }\n          >\n            <div className=\"delete-tag-container\">\n              {this.state.tagIndex.indexOf(index) > -1 &&\n              !this.props.isReading ? (\n                <DeleteIcon\n                  {...{\n                    tagName: item,\n                    mode: \"tags\",\n                    index: index,\n                    handleChangeTag: this.handleChangeTag,\n                  }}\n                />\n              ) : null}\n            </div>\n            <div\n              className=\"center\"\n              onClick={() => {\n                this.handleChangeTag(index);\n              }}\n            >\n              <Trans>{item}</Trans>\n            </div>\n          </li>\n        );\n      });\n    };\n    return (\n      <div\n        className=\"note-tag-container\"\n        style={this.props.isReading ? { width: \"1999px\" } : {}}\n      >\n        {this.props.isReading ? null : (\n          <span className=\"tag-title\">\n            <Trans>All Tags</Trans>\n          </span>\n        )}\n\n        <ul className=\"tag-container\">\n          <li\n            className=\"tag-list-item-new\"\n            onClick={() => {\n              this.handleInput();\n            }}\n            style={this.state.isInput ? { width: \"80px\" } : {}}\n          >\n            <div className=\"center\">\n              {this.state.isInput ? (\n                <input\n                  type=\"text\"\n                  name=\"newTag\"\n                  id=\"newTag\"\n                  onBlur={(event) => {\n                    this.handleAddTag(event);\n                  }}\n                />\n              ) : (\n                <span className=\"icon-add\"></span>\n              )}\n            </div>\n          </li>\n          {renderTag()}\n        </ul>\n      </div>\n    );\n  }\n}\nexport default NoteTag;\n","import { connect } from \"react-redux\";\nimport { handleSearchResults, handleSearch } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport NoteTag from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isReading: state.book.isReading,\n    noteKey: state.reader.noteKey,\n  };\n};\nconst actionCreator = {\n  handleSearchResults,\n  handleSearch,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(NoteTag as any));\n","//我的笔记页面\nimport React from \"react\";\nimport \"./noteList.css\";\nimport { NoteListProps, NoteListState } from \"./interface\";\nimport CardList from \"../../components/cardList\";\nimport NoteTag from \"../../components/noteTag\";\nimport NoteModel from \"../../model/Note\";\nimport Empty from \"../emptyPage\";\n\nclass NoteList extends React.Component<NoteListProps, NoteListState> {\n  constructor(props: NoteListProps) {\n    super(props);\n    this.state = {\n      tag: [],\n    };\n  }\n  componentWillMount() {\n    this.props.handleFetchNotes();\n  }\n  handleTag = (tag: string[]) => {\n    this.setState({ tag });\n  };\n  handleFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n    return itemArr;\n  };\n  filterTag = (notes: NoteModel[]) => {\n    let temp = [];\n    for (let i = 0; i < notes.length; i++) {\n      let flag = false;\n      for (let j = 0; j < this.state.tag.length; j++) {\n        if (notes[i].tag && notes[i].tag.indexOf(this.state.tag[j]) > -1) {\n          flag = true;\n          break;\n        }\n      }\n      if (flag) {\n        temp.push(notes[i]);\n      }\n    }\n    return temp;\n  };\n  render() {\n    const noteProps = {\n      cards: this.props.isSearch\n        ? this.handleFilter(\n            this.props.notes.filter((item) => item.notes !== \"\"),\n            this.props.searchResults\n          )\n        : this.state.tag.length > 0\n        ? this.filterTag(this.props.notes.filter((item) => item.notes !== \"\"))\n        : this.props.notes.filter((item) => item.notes !== \"\"),\n      mode: \"note\",\n    };\n    return (\n      <div className=\"note-list-container-parent\">\n        <div className=\"note-tags\">\n          <NoteTag {...{ handleTag: this.handleTag }} />\n        </div>\n        {noteProps.cards.length === 0 ? (\n          <div\n            style={{\n              position: \"fixed\",\n              left: 0,\n              top: 0,\n              width: \"100%\",\n              height: \"100%\",\n              zIndex: -1,\n            }}\n          >\n            <Empty />\n          </div>\n        ) : (\n          <CardList {...noteProps} />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default NoteList;\n","//我的笔记页面\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport NoteList from \"./component\";\nimport { handleFetchNotes } from \"../../store/actions/reader\";\n\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    notes: state.reader.notes,\n    isSearch: state.manager.isSearch,\n    searchResults: state.manager.searchResults,\n  };\n};\nconst actionCreator = { handleFetchNotes };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(NoteList as any));\n","//我的书摘页面\nimport React from \"react\";\nimport \"./digestList.css\";\nimport { DigestListProps, DigestListStates } from \"./interface\";\nimport CardList from \"../../components/cardList\";\nimport NoteTag from \"../../components/noteTag\";\nimport NoteModel from \"../../model/Note\";\nimport Empty from \"../emptyPage\";\n\nclass DigestList extends React.Component<DigestListProps, DigestListStates> {\n  constructor(props: DigestListProps) {\n    super(props);\n    this.state = {\n      tag: [],\n    };\n  }\n  componentWillMount() {\n    this.props.handleFetchNotes();\n  }\n  handleFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n    return itemArr;\n  };\n  handleTag = (tag: string[]) => {\n    this.setState({ tag });\n  };\n  filterTag = (digests: NoteModel[]) => {\n    let temp = [];\n    for (let i = 0; i < digests.length; i++) {\n      let flag = false;\n      for (let j = 0; j < this.state.tag.length; j++) {\n        if (digests[i].tag && digests[i].tag.indexOf(this.state.tag[j]) > -1) {\n          flag = true;\n          break;\n        }\n      }\n      if (flag) {\n        temp.push(digests[i]);\n      }\n    }\n    return temp;\n  };\n  render() {\n    const noteProps = {\n      cards: this.props.isSearch\n        ? this.handleFilter(this.props.digests, this.props.searchResults)\n        : this.state.tag.length > 0\n        ? this.filterTag(this.props.digests)\n        : this.props.digests,\n      mode: \"digest\",\n    };\n\n    return (\n      <div className=\"digest-list-container-parent\">\n        <div className=\"note-tags\">\n          <NoteTag {...{ handleTag: this.handleTag }} />\n        </div>\n        {noteProps.cards.length === 0 ? (\n          <div\n            style={{\n              position: \"fixed\",\n              left: 0,\n              top: 0,\n              width: \"100%\",\n              height: \"100%\",\n              zIndex: -1,\n            }}\n          >\n            <Empty />\n          </div>\n        ) : (\n          <CardList {...noteProps} />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default DigestList;\n","//我的书摘页面\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport DigestList from \"./component\";\nimport { handleFetchNotes } from \"../../store/actions/reader\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    isSearch: state.manager.isSearch,\n    searchResults: state.manager.searchResults,\n  };\n};\nconst actionCreator = { handleFetchNotes };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(DigestList as any));\n","//图书加载前的动画\nimport React from \"react\";\nimport \"./loadingPage.css\";\nimport { LoadingPageProps } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport { Redirect } from \"react-router-dom\";\n\nclass LoadingPage extends React.Component<LoadingPageProps> {\n  render() {\n    if (this.props.books) {\n      return <Redirect to=\"/manager/home\" />;\n    }\n    let arr: number[] = [];\n    for (\n      let i = 0;\n      i < parseInt(OtherUtil.getReaderConfig(\"totalBooks\") || \"0\");\n      i++\n    ) {\n      arr.push(i);\n    }\n    if (OtherUtil.getReaderConfig(\"isList\") !== \"list\") {\n      const renderLoadingCard = () => {\n        return arr.map((item, index) => {\n          return (\n            <div className=\"loading-page-book\" key={item}>\n              <div\n                className=\"loading-page-cover\"\n                style={{ opacity: `${(index % 7) * 0.2}` }}\n              ></div>\n            </div>\n          );\n        });\n      };\n      return (\n        <div className=\"loading-page-container-parent\">\n          <div className=\"loading-page-container\">{renderLoadingCard()}</div>\n        </div>\n      );\n    } else {\n      const renderLoadingList = () => {\n        return arr.map((item, index) => {\n          return (\n            <div className=\"loading-page-list\" key={item}>\n              <div className=\"loading-page-list-cover\"></div>\n              <div className=\"loading-page-bar\">\n                <div className=\"loading-page-bar1\"></div>\n                <div className=\"loading-page-bar2\"></div>\n                <div className=\"loading-page-bar3\"></div>\n              </div>\n            </div>\n          );\n        });\n      };\n      return (\n        <div className=\"loading-page-container-parent\">\n          <div className=\"loading-page-container\" style={{ marginTop: \"8px\" }}>\n            {renderLoadingList()}\n          </div>\n        </div>\n      );\n    }\n  }\n}\n\nexport default LoadingPage;\n","//图书加载前的动画\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport LoadingPage from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {};\nexport default connect(mapStateToProps, actionCreator)(LoadingPage);\n","import BookList from \"../containers/bookList\";\nimport BookmarkPage from \"../containers/bookmarkPage\";\nimport NoteList from \"../containers/noteList\";\nimport DigestList from \"../containers/digestList\";\nimport EmptyPage from \"../containers/emptyPage\";\nimport LoadingPage from \"../containers/loadingPage\";\n\nexport const routes = [\n  { path: \"/manager/empty\", component: EmptyPage },\n  { path: \"/manager/loading\", component: LoadingPage },\n  { path: \"/manager/note\", component: NoteList },\n  { path: \"/manager/digest\", component: DigestList },\n  { path: \"/manager/home\", component: BookList },\n  { path: \"/manager/favorite\", component: BookList },\n  { path: \"/manager/bookmark\", component: BookmarkPage },\n];\n","import React from \"react\";\nimport Sidebar from \"../../containers/sidebar\";\nimport Header from \"../../containers/header\";\nimport DeleteDialog from \"../../containers/deleteDialog\";\nimport EditDialog from \"../../containers/editDialog\";\nimport AddDialog from \"../../containers/addDialog\";\nimport SortDialog from \"../../containers/sortDialog\";\nimport MessageBox from \"../../containers/messageBox\";\nimport BackupDialog from \"../../containers/backupDialog\";\nimport WelcomeDialog from \"../../containers/welcomeDialog\";\nimport \"./manager.css\";\nimport { ManagerProps, ManagerState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport AddFavorite from \"../../utils/addFavorite\";\nimport { updateLog } from \"../../constants/readerConfig\";\nimport UpdateDialog from \"../../components/updataDialog\";\nimport SettingDialog from \"../../components/settingDialog\";\nimport { isMobileOnly } from \"react-device-detect\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\nimport { routes } from \"../../router/routes\";\nclass Manager extends React.Component<ManagerProps, ManagerState> {\n  timer!: NodeJS.Timeout;\n  constructor(props: ManagerProps) {\n    super(props);\n    this.state = {\n      totalBooks: parseInt(OtherUtil.getReaderConfig(\"totalBooks\") || \"0\") || 0,\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n      isAuthed: false,\n      isError: false,\n      isCopied: false,\n      isUpdated: false,\n      token: \"\",\n    };\n  }\n  //从indexdb里读取书籍\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchBooks();\n    this.props.handleFetchNotes();\n    this.props.handleFetchBookmarks();\n    this.props.handleFetchSortCode();\n    this.props.handleFetchList();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: ManagerProps) {\n    if (nextProps.books && this.state.totalBooks !== nextProps.books.length) {\n      this.setState({\n        totalBooks: nextProps.books.length,\n      });\n      OtherUtil.setReaderConfig(\"totalBooks\", this.state.totalBooks.toString());\n    }\n    if (nextProps.books && nextProps.books.length === 1 && !this.props.books) {\n      this.props.history.push(\"/manager/home\");\n    }\n    if (this.props.mode !== nextProps.mode) {\n      this.setState({\n        favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n      });\n    }\n    if (nextProps.isMessage) {\n      this.timer = setTimeout(() => {\n        this.props.handleMessageBox(false);\n      }, 2000);\n    }\n  }\n  componentDidMount() {\n    setTimeout(() => {\n      this.setState({\n        isUpdated: OtherUtil.getReaderConfig(\"version\") !== updateLog.version,\n      });\n      this.props.handleFirst(OtherUtil.getReaderConfig(\"isFirst\") || \"yes\");\n    }, 1000);\n  }\n  handleUpdateDialog = () => {\n    this.setState({ isUpdated: false });\n    OtherUtil.setReaderConfig(\"version\", updateLog.version);\n  };\n  componentWillUnmout() {\n    clearTimeout(this.timer);\n  }\n\n  render() {\n    let { books } = this.props;\n    const updateDialogProps = {\n      handleUpdateDialog: this.handleUpdateDialog,\n    };\n    if (isMobileOnly) {\n      return (\n        <>\n          <p className=\"waring-title\">\n            <Trans>Warning</Trans>\n          </p>\n          <div className=\"mobile-warning\">\n            <span>\n              <Trans>\n                For better user experince, please visit this site on a computer\n              </Trans>\n            </span>\n          </div>\n          <div>\n            <img\n              src={\n                process.env.NODE_ENV === \"production\"\n                  ? \"./assets/empty.svg\"\n                  : \"../../assets/empty.svg\"\n              }\n              alt=\"\"\n              className=\"waring-pic\"\n            />\n          </div>\n        </>\n      );\n    }\n    return (\n      <div className=\"manager\">\n        <Sidebar />\n        <Header />\n        <div className=\"manager-dialog-container\">\n          {this.props.isOpenDeleteDialog ? (\n            <DeleteDialog />\n          ) : this.props.isOpenEditDialog ? (\n            <EditDialog />\n          ) : this.props.isOpenAddDialog ? (\n            <AddDialog />\n          ) : null}\n        </div>\n        {this.props.isMessage ? <MessageBox /> : null}\n        {this.props.isSortDisplay ? <SortDialog /> : null}\n        {this.props.isBackup ? <BackupDialog /> : null}\n        {!this.state.isUpdated && this.props.isFirst === \"yes\" ? (\n          <WelcomeDialog />\n        ) : null}\n        {this.state.isUpdated ? <UpdateDialog {...updateDialogProps} /> : null}\n        {this.props.isSettingOpen ? <SettingDialog /> : null}\n        {!books && this.state.totalBooks ? (\n          <Redirect to=\"/manager/loading\" />\n        ) : (\n          <Switch>\n            {routes.map((ele) => (\n              <Route\n                render={() => <ele.component />}\n                key={ele.path}\n                path={ele.path}\n              />\n            ))}\n          </Switch>\n        )}\n      </div>\n    );\n  }\n}\nexport default Manager;\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchBooks,\n  handleFetchSortCode,\n  handleFetchList,\n  handleMessageBox,\n  handleFirst,\n} from \"../../store/actions/manager\";\nimport {\n  handleFetchNotes,\n  handleFetchBookmarks,\n} from \"../../store/actions/reader\";\nimport \"./manager.css\";\nimport { stateType } from \"../../store\";\nimport Manager from \"./component\";\nimport { withRouter } from \"react-router-dom\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    bookmarks: state.reader.bookmarks,\n    isReading: state.book.isReading,\n    mode: state.sidebar.mode,\n    shelfIndex: state.sidebar.shelfIndex,\n    isOpenEditDialog: state.book.isOpenEditDialog,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    isOpenAddDialog: state.book.isOpenAddDialog,\n    isSettingOpen: state.manager.isSettingOpen,\n    isSort: state.manager.isSort,\n    isSortDisplay: state.manager.isSortDisplay,\n    isMessage: state.manager.isMessage,\n    isBackup: state.backupPage.isBackup,\n    isFirst: state.manager.isFirst,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchSortCode,\n  handleFetchList,\n  handleMessageBox,\n  handleFirst,\n};\nexport default connect(mapStateToProps, actionCreator)(withRouter(Manager));\n","import RecordLocation from \"../../utils/recordLocation\";\nexport function handleLocations(locations: any) {\n  return { type: \"HANDLE_LOCATIONS\", payload: locations };\n}\nexport function handlePercentage(percentage: number) {\n  return { type: \"HANDLE_PERCENTAGE\", payload: percentage };\n}\nexport function handleFetchPercentage(book: { key: string }) {\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\n    let percentage = RecordLocation.getCfi(book.key).percentage;\n    dispatch(handlePercentage(percentage));\n  };\n}\nexport function handleFetchLocations(epub: any) {\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\n    epub.locations\n      .generate()\n      .then((result: any) => {\n        dispatch(handleLocations(epub.locations));\n      })\n      .catch(() => {\n        console.log(\"Error occurs\");\n      });\n  };\n}\n","class Note {\n  key: string;\n  bookKey: string;\n  date: { year: number; month: number; day: number };\n  chapter: string;\n  chapterIndex: number;\n  text: string;\n  cfi: string;\n  range: string;\n  notes: string;\n  percentage: number;\n  color: number;\n  tag: string[];\n  constructor(\n    bookKey: string,\n    chapter: string,\n    chapterIndex: number,\n    text: string,\n    cfi: string,\n    range: string,\n    notes: string,\n    percentage: number,\n    color: number,\n    tag: string[]\n  ) {\n    this.key = new Date().getTime() + \"\"; //笔记的键值\n    this.bookKey = bookKey; //笔记的所在书的键值\n    this.date = {\n      year: new Date().getFullYear(),\n      month: new Date().getMonth() + 1,\n      day: new Date().getDate(),\n    }; //笔记的添加日期\n    this.chapter = chapter; //笔记的所在章节\n    this.chapterIndex = chapterIndex; //笔记的所在章节\n    this.text = text; //笔记对应的书本的内容\n    this.cfi = cfi; //添加笔记的位置\n    this.range = range; // Rangy.js产生的将Range对象序列化后的字符串\n    this.notes = notes || \"\"; //笔记的内容\n    this.percentage = percentage; //笔记在文中的进度\n    this.color = color; //笔记高亮的颜色\n    this.tag = tag; //笔记高亮的颜色\n  }\n}\n\nexport default Note;\n","//添加笔记的弹窗\nimport React from \"react\";\nimport \"./popupNote.css\";\nimport Note from \"../../model/Note\";\nimport localforage from \"localforage\";\nimport { PopupNoteProps, PopupNoteState } from \"./interface\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport NoteTag from \"../noteTag\";\nimport NoteModel from \"../../model/Note\";\nimport { Trans } from \"react-i18next\";\n\ndeclare var window: any;\n\nclass PopupNote extends React.Component<PopupNoteProps, PopupNoteState> {\n  constructor(props: PopupNoteProps) {\n    super(props);\n    this.state = { tag: [] };\n  }\n  componentDidMount() {\n    let textArea: any = document.querySelector(\".editor-box\");\n    textArea && textArea.focus();\n  }\n  handleTag = (tag: string[]) => {\n    this.setState({ tag });\n  };\n  createNote() {\n    let notes = (document.querySelector(\".editor-box\") as HTMLInputElement)\n      .value;\n\n    if (this.props.noteKey) {\n      //编辑笔记\n      this.props.notes.forEach((item) => {\n        if (item.key === this.props.noteKey) {\n          item.notes = notes;\n          item.tag = this.state.tag;\n        }\n      });\n      localforage.setItem(\"notes\", this.props.notes).then(() => {\n        this.props.handleOpenMenu(false);\n        this.props.handleMessage(\"Add Successfully\");\n        this.props.handleMessageBox(true);\n        this.props.handleFetchNotes();\n        this.props.handleMenuMode(\"highlight\");\n        this.props.handleNoteKey(\"\");\n        console.log(\"edit\");\n      });\n    } else {\n      //创建笔记\n      let bookKey = this.props.currentBook.key;\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\n      let chapterHref = currentLocation.start.href;\n      let chapterIndex = currentLocation.start.index;\n      let chapter = \"Unknown Chapter\";\n      let currentChapter = this.props.flattenChapters.filter(\n        (item: any) => item.href.split(\"#\")[0] === chapterHref\n      )[0];\n      if (currentChapter) {\n        chapter = currentChapter.label.trim(\" \");\n      }\n\n      const cfi = RecordLocation.getCfi(this.props.currentBook.key).cfi;\n\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\n      if (!iframe) return;\n      let doc = iframe.contentDocument;\n      if (!doc) {\n        return;\n      }\n      let charRange = window.rangy\n        .getSelection(iframe)\n        .saveCharacterRanges(doc.body)[0];\n      let range = JSON.stringify(charRange);\n      let text = doc.getSelection()?.toString();\n      if (!text) {\n        return;\n      }\n      text = text.replace(/\\s\\s/g, \"\");\n      text = text.replace(/\\r/g, \"\");\n      text = text.replace(/\\n/g, \"\");\n      text = text.replace(/\\t/g, \"\");\n      text = text.replace(/\\f/g, \"\");\n      let percentage = RecordLocation.getCfi(this.props.currentBook.key)\n        .percentage\n        ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n        : 0;\n\n      let color = this.props.color || 0;\n      let tag = this.state.tag;\n      let note = new Note(\n        bookKey,\n        chapter,\n        chapterIndex,\n        text,\n        cfi,\n        range,\n        notes,\n        percentage,\n        color,\n        tag\n      );\n      let noteArr = this.props.notes;\n      noteArr.push(note);\n      localforage.setItem(\"notes\", noteArr).then(() => {\n        this.props.handleOpenMenu(false);\n        this.props.handleMessage(\"Add Successfully\");\n        this.props.handleMessageBox(true);\n        this.props.handleFetchNotes();\n        this.props.handleMenuMode(\"highlight\");\n        console.log(\"new\");\n      });\n    }\n  }\n  handleClose = () => {\n    let noteIndex;\n    if (this.props.noteKey) {\n      this.props.notes.forEach((item, index) => {\n        if (item.key === this.props.noteKey) {\n          noteIndex = index;\n        }\n      });\n      if (noteIndex) {\n        this.props.notes.splice(noteIndex, 1);\n        localforage.setItem(\"notes\", this.props.notes).then(() => {\n          this.props.handleOpenMenu(false);\n          this.props.handleMenuMode(\"menu\");\n          this.props.handleMessage(\"Delete Successfully\");\n          this.props.handleMessageBox(true);\n          this.props.handleMenuMode(\"highlight\");\n\n          this.props.handleNoteKey(\"\");\n        });\n      }\n    } else {\n      this.props.handleOpenMenu(false);\n      this.props.handleMenuMode(\"menu\");\n      this.props.handleNoteKey(\"\");\n    }\n  };\n\n  render() {\n    let note: NoteModel;\n    if (this.props.noteKey) {\n      this.props.notes.forEach((item) => {\n        if (item.key === this.props.noteKey) {\n          note = item;\n        }\n      });\n    }\n\n    const renderNoteEditor = () => {\n      return (\n        <div className=\"note-editor\">\n          <div className=\"editor-box-parent\">\n            <textarea className=\"editor-box\" />\n          </div>\n          <div\n            className=\"note-tags\"\n            style={{ position: \"absolute\", bottom: \"0px\", height: \"70px\" }}\n          >\n            <NoteTag\n              {...{\n                handleTag: this.handleTag,\n                tag: this.props.noteKey ? note.tag : [],\n              }}\n            />\n          </div>\n\n          <div className=\"note-button-container\">\n            <span\n              className=\"cancel-button\"\n              onClick={() => {\n                this.handleClose();\n              }}\n            >\n              {this.props.noteKey ? (\n                <Trans>Delete</Trans>\n              ) : (\n                <Trans>Cancel</Trans>\n              )}\n            </span>\n            <span\n              className=\"confirm-button\"\n              onClick={() => {\n                this.createNote();\n              }}\n            >\n              <Trans>Confirm</Trans>\n            </span>\n          </div>\n        </div>\n      );\n    };\n    return renderNoteEditor();\n  }\n}\nexport default PopupNote;\n","import { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { handleOpenMenu, handleMenuMode } from \"../../store/actions/viewArea\";\nimport { handleNoteKey, handleFetchNotes } from \"../../store/actions/reader\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport PopupNote from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    notes: state.reader.notes,\n    color: state.reader.color,\n    flattenChapters: state.reader.flattenChapters,\n    noteKey: state.reader.noteKey,\n  };\n};\nconst actionCreator = {\n  handleMessageBox,\n  handleMessage,\n  handleOpenMenu,\n  handleMenuMode,\n  handleNoteKey,\n  handleFetchNotes,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(PopupNote as any));\n","//高亮，下划线颜色选择\nimport React from \"react\";\nimport \"./colorOption.css\";\nimport { ColorProps, ColorStates } from \"./interface\";\n\nclass ColorOption extends React.Component<ColorProps, ColorStates> {\n  constructor(props: ColorProps) {\n    super(props);\n    this.state = {\n      isLine: false,\n    };\n  }\n  handleChangeOptiion = () => {\n    this.setState({ isLine: !this.state.isLine });\n  };\n  render() {\n    const renderLine = () => {\n      return [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"].map((item, index) => {\n        return (\n          <div\n            className=\"line-option\"\n            style={{\n              border: `${\n                this.props.color === index + 4\n                  ? \"2px solid rgba(75,75,75,1)\"\n                  : \"\"\n              }`,\n            }}\n            key={item}\n            onClick={() => {\n              this.props.handleColor(index + 4);\n            }}\n          >\n            <div\n              className=\"demo-line\"\n              style={{ borderBottom: `solid 2px ${item}` }}\n            ></div>\n          </div>\n        );\n      });\n    };\n    const renderColor = () => {\n      return [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"].map((item, index) => {\n        return (\n          <div\n            className=\"color-option\"\n            style={{\n              backgroundColor: item,\n              border: `${\n                this.props.color === index ? \"2px solid rgba(75,75,75,1)\" : \"\"\n              }`,\n            }}\n            key={item}\n            onClick={() => {\n              this.props.handleColor(index);\n            }}\n          ></div>\n        );\n      });\n    };\n    return (\n      <div className=\"color-option-container\">\n        {!this.state.isLine && renderColor()}\n        <span\n          className=\"icon-sort popup-color-more\"\n          onClick={() => {\n            this.handleChangeOptiion();\n          }}\n        ></span>\n        {this.state.isLine && renderLine()}\n      </div>\n    );\n  }\n}\n\nexport default ColorOption;\n","//左下角的图标外链\nimport { connect } from \"react-redux\";\nimport { handleColor } from \"../../store/actions/reader\";\nimport { stateType } from \"../../store\";\nimport About from \"./component\";\nimport { handleSelection } from \"../../store/actions/viewArea\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    color: state.reader.color,\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {\n  handleColor,\n  handleSelection,\n};\nexport default connect(mapStateToProps, actionCreator)(About);\n","//选中文字后的弹窗，四个按钮\nimport React from \"react\";\nimport \"./popupOption.css\";\nimport localforage from \"localforage\";\nimport Note from \"../../model/Note\";\nimport { Trans } from \"react-i18next\";\nimport { PopupOptionProps } from \"./interface\";\nimport ColorOption from \"../colorOption\";\nimport RecordLocation from \"../../utils/recordLocation\";\n\ndeclare var window: any;\n\nclass PopupOption extends React.Component<PopupOptionProps> {\n  handleNote = () => {\n    this.props.handleChangeDirection(false);\n    this.props.handleMenuMode(\"note\");\n    let rect = this.props.rect;\n    let x = rect.x % this.props.currentEpub.rendition._layout.width;\n    let y = rect.y % this.props.currentEpub.rendition._layout.height;\n    let height = 200;\n    let posX = x + rect.width / 2 - 20;\n    //防止menu超出图书\n    let rightEdge = this.props.currentEpub.rendition._layout.width - 200;\n    var posY;\n    //控制menu方向\n    if (y < height) {\n      this.props.handleChangeDirection(true);\n      posY = y + 77;\n    } else {\n      posY = y - height / 2 - rect.height;\n    }\n\n    posY = posY < 6 ? 6 : posY;\n    posX = posX < 10 ? 10 : x > rightEdge ? rightEdge : posX;\n\n    let popupMenu = document.querySelector(\".popup-menu-container\");\n    popupMenu &&\n      popupMenu.setAttribute(\"style\", `left:${posX}px;top:${posY}px`);\n  };\n  handleCopy = () => {\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let text = doc.execCommand(\"copy\", false);\n    !text\n      ? console.log(\"failed to copy text to clipboard\")\n      : console.log(\"copied!\");\n    this.props.handleOpenMenu(false);\n    doc.getSelection()!.empty();\n    this.props.handleMessage(\"Copy Successfully\");\n    this.props.handleMessageBox(true);\n  };\n  handleTrans = () => {\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let sel = doc.getSelection();\n    if (!sel) return;\n    let text = sel.toString();\n    text = text && text.trim();\n    this.props.handleMenuMode(\"trans\");\n    this.props.handleOriginalText(text);\n  };\n  handleDigest = () => {\n    let bookKey = this.props.currentBook.key;\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\n    let chapterHref = currentLocation.start.href;\n    let chapterIndex = currentLocation.start.index;\n    let chapter = \"Unknown Chapter\";\n    let currentChapter = this.props.flattenChapters.filter(\n      (item: any) => item.href.split(\"#\")[0] === chapterHref\n    )[0];\n    if (currentChapter) {\n      chapter = currentChapter.label.trim(\" \");\n    }\n    const cfi = RecordLocation.getCfi(this.props.currentBook.key).cfi;\n\n    let percentage = RecordLocation.getCfi(this.props.currentBook.key)\n      .percentage\n      ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n      : 0;\n    let color = this.props.color;\n    let notes = \"\";\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let charRange = window.rangy\n      .getSelection(iframe)\n      .saveCharacterRanges(doc.body)[0];\n    let range = JSON.stringify(charRange);\n    let text = doc.getSelection()?.toString();\n    if (!text) return;\n    text = text.replace(/\\s\\s/g, \"\");\n    text = text.replace(/\\r/g, \"\");\n    text = text.replace(/\\n/g, \"\");\n    text = text.replace(/\\t/g, \"\");\n    text = text.replace(/\\f/g, \"\");\n    let digest = new Note(\n      bookKey,\n      chapter,\n      chapterIndex,\n      text,\n      cfi,\n      range,\n      notes,\n      percentage,\n      color,\n      []\n    );\n    let noteArr = this.props.notes;\n    noteArr.push(digest);\n    localforage.setItem(\"notes\", noteArr).then(() => {\n      this.props.handleOpenMenu(false);\n      this.props.handleMessage(\"Add Successfully\");\n      this.props.handleMessageBox(true);\n      this.props.handleFetchNotes();\n      this.props.handleMenuMode(\"highlight\");\n    });\n  };\n\n  render() {\n    const renderMenuList = () => {\n      return (\n        <>\n          <div className=\"menu-list\">\n            <div\n              className=\"note-option\"\n              onClick={() => {\n                this.handleNote();\n              }}\n            >\n              <div>\n                <span className=\"icon-note note-icon\"></span>\n                <p>\n                  <Trans>Take Notes</Trans>\n                </p>\n              </div>\n            </div>\n            <div\n              className=\"digest-option\"\n              onClick={() => {\n                this.handleDigest();\n              }}\n            >\n              <div>\n                <span className=\"icon-collect digest-icon\"></span>\n                <p>\n                  <Trans>Collect</Trans>\n                </p>\n              </div>\n            </div>\n            <div\n              className=\"translation-option\"\n              onClick={() => {\n                this.handleTrans();\n              }}\n            >\n              <div>\n                <span className=\"icon-translation translation-icon\"></span>\n                <p>\n                  <Trans>Translate</Trans>\n                </p>\n              </div>\n            </div>\n            <div\n              className=\"copy-option icon\"\n              onClick={() => {\n                this.handleCopy();\n              }}\n            >\n              <div>\n                <span className=\"icon-copy copy-icon\"></span>\n                <p>\n                  <Trans>Copy</Trans>\n                </p>\n              </div>\n            </div>\n          </div>\n          <ColorOption />\n        </>\n      );\n    };\n    return renderMenuList();\n  }\n}\n\nexport default PopupOption;\n","import { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport {\n  handleOpenMenu,\n  handleMenuMode,\n  handleChangeDirection,\n} from \"../../store/actions/viewArea\";\nimport {\n  handleFetchNotes,\n  handleOriginalText,\n} from \"../../store/actions/reader\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport PopupOption from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    currentEpub: state.book.currentEpub,\n    selection: state.viewArea.selection,\n    notes: state.reader.notes,\n    color: state.reader.color,\n    flattenChapters: state.reader.flattenChapters,\n  };\n};\nconst actionCreator = {\n  handleMessageBox,\n  handleMessage,\n  handleOpenMenu,\n  handleMenuMode,\n  handleFetchNotes,\n  handleOriginalText,\n  handleChangeDirection,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(PopupOption as any));\n","//翻译弹窗\nimport React from \"react\";\nimport \"./popupTrans.css\";\nimport { PopupTransProps, PopupTransState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport md5 from \"md5\";\n\nclass PopupTrans extends React.Component<PopupTransProps, PopupTransState> {\n  constructor(props: PopupTransProps) {\n    super(props);\n    this.state = {\n      translatedText: \"\",\n    };\n  }\n  componentDidMount() {\n    let lng = OtherUtil.getReaderConfig(\"lang\");\n    //兼容之前的版本\n    if (lng === \"cn\") {\n      lng = \"zh\";\n    }\n    var script = document.createElement(\"script\");\n    script.type = \"text/javascript\";\n    script.src = `https://fanyi-api.baidu.com/api/trans/vip/translate?q=${\n      this.props.originalText\n    }&from=auto&to=${\n      lng || \"zh\"\n    }&appid=20200802000531425&salt=1435660288&sign=${md5(\n      \"20200802000531425\" +\n        this.props.originalText +\n        \"1435660288\" +\n        \"sJRHTorJq8j8_ru2GkHl\"\n    )}&callback=handleCallback`;\n    document.head.appendChild(script);\n    (window as any).handleCallback = (res: any) => {\n      this.setState({\n        translatedText: res.trans_result ? res.trans_result[0].dst : \"出错了\",\n      });\n    };\n  }\n\n  render() {\n    const renderNoteEditor = () => {\n      return (\n        <div className=\"trans-container\">\n          <div className=\"original-text-box\">{this.props.originalText}</div>\n          <div className=\"trans-text-box\">{this.state.translatedText}</div>\n        </div>\n      );\n    };\n    return renderNoteEditor();\n  }\n}\nexport default PopupTrans;\n","import { connect } from \"react-redux\";\nimport { handleOpenMenu, handleMenuMode } from \"../../store/actions/viewArea\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport PopupNote from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    originalText: state.reader.originalText,\n  };\n};\nconst actionCreator = {\n  handleOpenMenu,\n  handleMenuMode,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(PopupNote as any));\n","//选中文字后的弹窗\nimport React from \"react\";\nimport \"./popupMenu.css\";\nimport PopupNote from \"../../components/popupNote\";\nimport PopupOption from \"../../components/popupOption\";\nimport PopupTrans from \"../../components/popupTrans\";\nimport { PopupMenuProps, PopupMenuStates } from \"./interface\";\n\ndeclare var window: any;\n\nclass PopupMenu extends React.Component<PopupMenuProps, PopupMenuStates> {\n  highlighter: any;\n  timer!: NodeJS.Timeout;\n  key: any;\n  mode: string;\n  showNote: boolean;\n  isFirstShow: boolean;\n  cfiRange: any;\n  contents: any;\n  rect: any;\n  constructor(props: PopupMenuProps) {\n    super(props);\n    this.showNote = false;\n    this.isFirstShow = false;\n    this.highlighter = null;\n    this.mode = \"\";\n    this.state = {\n      deleteKey: \"\",\n      cfiRange: this.props.cfiRange,\n      contents: this.props.contents,\n      rect: this.props.rect,\n    };\n  }\n\n  componentDidMount() {\n    this.props.rendition.on(\"rendered\", () => {\n      new Promise((resolve, reject) => {\n        this.getHighlighter();\n        resolve();\n      }).then(() => {\n        this.renderHighlighters();\n      });\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\n      if (!iframe) return;\n      let doc = iframe.contentDocument;\n      if (!doc) return;\n      doc.addEventListener(\"mousedown\", this.openMenu);\n    });\n  }\n  componentWillReceiveProps(nextProps: PopupMenuProps) {\n    if (nextProps.cfiRange !== this.props.cfiRange) {\n      this.setState(\n        {\n          cfiRange: nextProps.cfiRange,\n          contents: nextProps.contents,\n          rect: nextProps.rect,\n        },\n        () => {\n          this.openMenu();\n        }\n      );\n    }\n  }\n  //新建高亮\n  getHighlighter = () => {\n    // 注意点一\n    // 为了每次切换章节时都有与当前文档相关联的 pen\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    this.highlighter = window.rangy.createHighlighter(doc);\n    let classes = [\n      \"color-0\",\n      \"color-1\",\n      \"color-2\",\n      \"color-3\",\n      \"line-0\",\n      \"line-1\",\n      \"line-2\",\n      \"line-3\",\n    ];\n    classes.forEach((item) => {\n      let config = {\n        ignoreWhiteSpace: true,\n        elementTagName: \"span\",\n        elementProperties: {\n          onclick: (event: any) => {\n            let iframe = document.getElementsByTagName(\"iframe\")[0];\n            if (!iframe) return;\n            let doc = iframe.contentDocument;\n            if (!doc) return;\n            this.props.handleMenuMode(\"note\");\n            let sel = doc.getSelection();\n            if (!sel) return;\n            let range = sel.getRangeAt(0);\n            this.setState({ rect: range.getBoundingClientRect() }, () => {\n              this.showMenu();\n              this.handleClickHighlighter(event.currentTarget.dataset.key);\n              event.stopPropagation();\n            });\n          },\n        },\n        onElementCreate: (element: any) => {\n          element.dataset.key = this.key;\n        },\n      };\n      let applier = window.rangy.createClassApplier(item, config);\n      this.highlighter.addClassApplier(applier);\n    });\n  };\n  handleClickHighlighter = (key: string) => {\n    let dialog: HTMLInputElement | null = document.querySelector(\".editor-box\");\n    let note = this.props.notes.filter((item) => item.key === key)[0];\n    if (note && note.notes) {\n      dialog!.value = note.notes;\n    }\n    this.props.handleNoteKey(key);\n  };\n  handleShowDelete = (deleteKey: string) => {\n    this.setState({ deleteKey });\n  };\n  showMenu = () => {\n    let rect = this.state.rect;\n    if (!rect) return;\n    this.props.handleChangeDirection(false);\n    // const rect = this.rect;\n    let height = 200;\n    let x = rect.x % this.props.currentEpub.rendition._layout.width;\n    let y = rect.y % this.props.currentEpub.rendition._layout.height;\n\n    let posX = x + rect.width / 2 - 20;\n    //防止menu超出图书\n    let rightEdge =\n      this.props.menuMode === \"note\"\n        ? this.props.currentEpub.rendition._layout.width - 240\n        : this.props.currentEpub.rendition._layout.width - 150;\n    var posY;\n    //控制menu方向\n    if (y < height) {\n      this.props.handleChangeDirection(true);\n      posY = y + 67;\n    } else {\n      posY = y - height / 2 - 57;\n    }\n\n    posX = posX > rightEdge ? rightEdge : posX;\n\n    this.props.handleOpenMenu(true);\n    let popupMenu = document.querySelector(\".popup-menu-container\");\n\n    popupMenu!.setAttribute(\"style\", `left:${posX}px;top:${posY}px`);\n    this.setState({ rect: null });\n  };\n  //渲染高亮\n  renderHighlighters = () => {\n    let highlighters: any = this.props.notes;\n    if (!highlighters) return;\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\n    if (!currentLocation.start) return;\n    let chapterIndex = currentLocation.start.index;\n    let highlightersByChapter = highlighters.filter(\n      (item: any) => item.chapterIndex === chapterIndex\n    );\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    let iWin = iframe.contentWindow || iframe.contentDocument!.defaultView;\n    this.highlighter && this.highlighter.removeAllHighlights(); // 为了避免下次反序列化失败，必须先清除已有的高亮\n\n    let classes = [\n      \"color-0\",\n      \"color-1\",\n      \"color-2\",\n      \"color-3\",\n      \"line-0\",\n      \"line-1\",\n      \"line-2\",\n      \"line-3\",\n    ];\n    highlightersByChapter &&\n      highlightersByChapter.forEach((item: any) => {\n        this.key = item.key;\n        //控制渲染指定图书的指定高亮\n        if (item.bookKey === this.props.currentBook.key) {\n          try {\n            let temp = JSON.parse(item.range);\n            temp = [temp];\n            window.rangy\n              .getSelection(iframe)\n              .restoreCharacterRanges(iframe.contentDocument, temp);\n          } catch (e) {\n            console.warn(\n              \"Exception has been caught when restore character ranges.\"\n            );\n            return;\n          }\n          this.highlighter.highlightSelection(classes[item.color]);\n        }\n      });\n    if (!iWin || !iWin.getSelection()) return;\n    iWin.getSelection()!.empty(); // 清除文本选取\n    // this.props.isOpenMenu &&\n    //   window.rangy.deserializeSelection(serial, null, iWin); // （为了选取文本后不被上一行代码清除掉）恢复原本的文本选取\n  };\n  //控制弹窗\n  openMenu = () => {\n    this.setState({ deleteKey: \"\" });\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let sel = doc.getSelection();\n    this.props.handleChangeDirection(false);\n    // 如果 popmenu正在被展示，则隐藏\n    if (this.props.isOpenMenu) {\n      this.props.handleMenuMode(\"menu\");\n      this.props.handleOpenMenu(false);\n      this.props.handleNoteKey(\"\");\n    }\n\n    // 使弹出菜单更加灵活可控;\n    if (sel!.isCollapsed) {\n      this.props.isOpenMenu && this.props.handleOpenMenu(false);\n      this.props.handleMenuMode(\"menu\");\n      this.props.handleNoteKey(\"\");\n      return;\n    }\n    this.showMenu();\n    this.props.handleMenuMode(\"menu\");\n  };\n  //添加高亮\n  handleHighlight() {\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let color = this.props.color;\n    let classes = [\n      \"color-0\",\n      \"color-1\",\n      \"color-2\",\n      \"color-3\",\n      \"line-0\",\n      \"line-1\",\n      \"line-2\",\n      \"line-3\",\n    ];\n    this.highlighter.highlightSelection(classes[color]);\n    this.props.handleMenuMode(\"menu\");\n    this.props.handleOpenMenu(false);\n    doc.getSelection()!.empty();\n    this.props.handleMenuMode(\"menu\");\n    this.highlighter && this.highlighter.removeAllHighlights();\n    new Promise((resolve) => {\n      this.getHighlighter();\n      resolve();\n    }).then(() => {\n      this.renderHighlighters();\n    });\n  }\n  render() {\n    if (this.props.menuMode === \"highlight\") {\n      this.handleHighlight();\n    }\n    const PopupProps = {\n      cfiRange: this.props.cfiRange,\n      contents: this.props.contents,\n      rect: this.props.rect,\n    };\n    return (\n      <div>\n        <div\n          className=\"popup-menu-container\"\n          style={this.props.isOpenMenu ? {} : { display: \"none\" }}\n        >\n          <div className=\"popup-menu-box\">\n            {this.props.menuMode === \"menu\" ? (\n              <PopupOption {...PopupProps} />\n            ) : this.props.menuMode === \"note\" ? (\n              <PopupNote {...PopupProps} />\n            ) : this.props.menuMode === \"trans\" ? (\n              <PopupTrans {...PopupProps} />\n            ) : null}\n          </div>\n          {this.props.isChangeDirection ? (\n            <span\n              className=\"icon-popup popup-menu-triangle-up\"\n              style={\n                this.props.menuMode === \"highlight\" ? { bottom: \"110px\" } : {}\n              }\n            ></span>\n          ) : (\n            <span className=\"icon-popup popup-menu-triangle-down\"></span>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default PopupMenu;\n","//弹出菜单\nimport {\n  handleSelection,\n  handleOpenMenu,\n  handleMenuMode,\n  handleChangeDirection,\n} from \"../../store/actions/viewArea\";\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { handleNoteKey } from \"../../store/actions/reader\";\nimport PopupMenu from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    notes: state.reader.notes,\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    isOpenMenu: state.viewArea.isOpenMenu,\n    menuMode: state.viewArea.menuMode,\n    color: state.reader.color,\n    isChangeDirection: state.viewArea.isChangeDirection,\n  };\n};\nconst actionCreator = {\n  handleSelection,\n  handleOpenMenu,\n  handleMenuMode,\n  handleChangeDirection,\n  handleMessageBox,\n  handleMessage,\n  handleNoteKey,\n};\nexport default connect(mapStateToProps, actionCreator)(PopupMenu);\n","import OtherUtil from \"../utils/otherUtil\";\n\nclass styleUtil {\n  // 为 iframe 添加默认的样式\n  static addDefaultCss() {\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let css = this.getDefaultCss();\n    let style = doc.getElementById(\"default-style\");\n    let background = document.querySelector(\".background\");\n    if (!background) return;\n    background!.setAttribute(\n      \"style\",\n      `background-color:${OtherUtil.getReaderConfig(\"theme\")}`\n    );\n    if (!doc.head) {\n      return;\n    }\n    if (!style) {\n      style = doc.createElement(\"style\");\n      style.id = \"default-style\";\n      style.textContent = css;\n      doc.head.appendChild(style);\n      return;\n    }\n    style.textContent = css;\n  }\n  // 获取为文档默认应用的css样式\n  static getDefaultCss() {\n    let colors = [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"];\n    let lines = [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"];\n    let css1 = `::selection{background:#f3a6a68c}::-moz-selection{background:#f3a6a68c}[class*=color-]:hover{cursor:pointer;background-image:linear-gradient(0,rgba(0,0,0,.075),rgba(0,0,0,.075))}.color-0{background-color:${colors[0]}}.color-1{background-color:${colors[1]}}.color-2{background-color:${colors[2]}}.color-3{background-color:${colors[3]}}.line-0{border-bottom:2px solid ${lines[0]}}.line-1{border-bottom:2px solid ${lines[1]}}.line-2{border-bottom:2px solid ${lines[2]}}.line-3{border-bottom:2px solid ${lines[3]}}}`;\n\n    return css1;\n  }\n}\n\nexport default styleUtil;\n","//阅读器图书内容区域\nimport React from \"react\";\nimport \"./imageViewer.css\";\nimport { ImageViewerProps, ImageViewerStates } from \"./interface\";\nimport StyleUtil from \"../../utils/styleUtil\";\nimport FileSaver from \"file-saver\";\nconst isElectron = require(\"is-electron\");\n\ndeclare var window: any;\n\nclass ImageViewer extends React.Component<ImageViewerProps, ImageViewerStates> {\n  constructor(props: ImageViewerProps) {\n    super(props);\n    this.state = {\n      isShowImage: false,\n      imageRatio: \"horizontal\",\n      zoomIndex: 0,\n      rotateIndex: 0,\n    };\n  }\n\n  componentDidMount() {\n    this.props.rendition.on(\"rendered\", () => {\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\n      if (!iframe) return;\n      let doc = iframe.contentDocument;\n      if (!doc) {\n        return;\n      }\n      StyleUtil.addDefaultCss();\n      doc.addEventListener(\"click\", this.showImage, true);\n    });\n  }\n\n  showImage = (event: any) => {\n    if (this.props.isShow) {\n      this.props.handleLeaveReader(\"left\");\n      this.props.handleLeaveReader(\"right\");\n      this.props.handleLeaveReader(\"top\");\n      this.props.handleLeaveReader(\"bottom\");\n    }\n    let href =\n      event.target.href ||\n      event.target.parentNode.href ||\n      event.target.parentNode.parentNode.href;\n    if (isElectron() && href) {\n      event.preventDefault();\n      window.require(\"electron\").shell.openExternal(href);\n    }\n    if (!event.target.src) {\n      return;\n    }\n    if (this.state.isShowImage) {\n      this.setState({ isShowImage: false });\n    }\n    event.preventDefault();\n    const handleDirection = (direction: string) => {\n      this.setState({ imageRatio: direction });\n    };\n    var img = new Image();\n    img.addEventListener(\"load\", function () {\n      handleDirection(\n        this.naturalWidth / this.naturalHeight > 1 ? \"horizontal\" : \"vertical\"\n      );\n    });\n    img.src = event.target.src;\n    let image: HTMLImageElement | null = document.querySelector(\".image\");\n    if (image) {\n      image.src = event.target.src;\n      this.setState({ isShowImage: true });\n    }\n  };\n  hideImage = (event: any) => {\n    event.preventDefault();\n    if (event.target.src) {\n      let image: HTMLImageElement | null = document.querySelector(\".image\");\n      if (image) image.src = \"\";\n    }\n    this.setState({ isShowImage: false });\n  };\n  handleZoomIn = () => {\n    let image: any = document.querySelector(\".image\");\n    if (image.style.width === \"100vw\" || image.style.height === \"100vh\") return;\n    this.setState({ zoomIndex: this.state.zoomIndex + 1 }, () => {\n      if (this.state.imageRatio === \"horizontal\") {\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\n      } else {\n        image.style.height = `${90 + 10 * this.state.zoomIndex}vh`;\n      }\n    });\n  };\n  handleZoomOut = () => {\n    let image: any = document.querySelector(\".image\");\n    if (image.style.width === \"50vw\" || image.style.height === \"50vh\") return;\n    this.setState({ zoomIndex: this.state.zoomIndex - 1 }, () => {\n      if (this.state.imageRatio === \"horizontal\") {\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\n      } else {\n        image.style.height = `${90 + 10 * this.state.zoomIndex}vh`;\n      }\n    });\n  };\n  handleSave = async () => {\n    let image: any = document.querySelector(\".image\");\n    let blob = await fetch(image.src).then((r) => r.blob());\n    FileSaver.saveAs(blob, `${new Date().toLocaleDateString()}`);\n  };\n  handleClock = () => {\n    let image: any = document.querySelector(\".image\");\n    this.setState({ rotateIndex: this.state.rotateIndex + 1 }, () => {\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\n    });\n  };\n  handleCounterClock = () => {\n    let image: any = document.querySelector(\".image\");\n    this.setState({ rotateIndex: this.state.rotateIndex - 1 }, () => {\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\n    });\n  };\n  render() {\n    return (\n      <div\n        className=\"image-preview\"\n        style={this.state.isShowImage ? {} : { display: \"none\" }}\n      >\n        <div\n          className=\"image-background\"\n          style={\n            this.state.isShowImage\n              ? { backgroundColor: \"rgba(75,75,75,0.3)\" }\n              : {}\n          }\n          onClick={(event) => {\n            this.hideImage(event);\n          }}\n        ></div>\n        <img\n          src=\"\"\n          alt=\"\"\n          className=\"image\"\n          style={\n            this.state.imageRatio === \"horizontal\"\n              ? { width: \"60vw\" }\n              : { height: \"90vh\" }\n          }\n        />\n        <div className=\"image-operation\">\n          <span\n            className=\"icon-zoom-in zoom-in-icon\"\n            onClick={() => {\n              this.handleZoomIn();\n            }}\n          ></span>\n          <span\n            className=\"icon-zoom-out zoom-out-icon\"\n            onClick={() => {\n              this.handleZoomOut();\n            }}\n          ></span>\n          <span\n            className=\"icon-save save-icon\"\n            onClick={() => {\n              this.handleSave();\n            }}\n          ></span>\n          <span\n            className=\"icon-clockwise clockwise-icon\"\n            onClick={() => {\n              this.handleClock();\n            }}\n          ></span>\n          <span\n            className=\"icon-counterclockwise counterclockwise-icon\"\n            onClick={() => {\n              this.handleCounterClock();\n            }}\n          ></span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ImageViewer;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport ImageViewer from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = {};\n\nexport default connect(mapStateToProps, actionCreator)(ImageViewer);\n","//阅读器图书内容区域\nimport React from \"react\";\nimport \"./viewArea.css\";\nimport PopupMenu from \"../popupMenu\";\nimport { ViewAreaProps, ViewAreaStates } from \"./interface\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport BookmarkModel from \"../../model/Bookmark\";\nimport StyleUtil from \"../../utils/styleUtil\";\nimport ImageViewer from \"../../components/imageViewer\";\n\ndeclare var window: any;\n\nclass ViewArea extends React.Component<ViewAreaProps, ViewAreaStates> {\n  isFirst: boolean;\n  constructor(props: ViewAreaProps) {\n    super(props);\n    this.state = {\n      cfiRange: null,\n      contents: null,\n      rect: null,\n      loading: true,\n    };\n    this.isFirst = true;\n  }\n\n  componentDidMount() {\n    let epub = this.props.currentEpub;\n    (window as any).rangy.init(); // 初始化\n    this.props.rendition.on(\"locationChanged\", () => {\n      this.props.handleReadingEpub(epub);\n      this.props.handleOpenMenu(false);\n      const currentLocation = this.props.rendition.currentLocation();\n      const cfi = currentLocation.start.cfi;\n      this.props.handleShowBookmark(\n        this.props.bookmarks &&\n          this.props.bookmarks.filter(\n            (item: BookmarkModel) => item.cfi === cfi\n          )[0]\n          ? true\n          : false\n      );\n      if (!this.isFirst && this.props.locations) {\n        let percentage = this.props.locations.percentageFromCfi(cfi);\n        RecordLocation.recordCfi(this.props.currentBook.key, cfi, percentage);\n        this.props.handlePercentage(percentage);\n      }\n      this.isFirst = false;\n    });\n    this.props.rendition.on(\"rendered\", () => {\n      this.setState({ loading: false });\n      let iframe = document.getElementsByTagName(\"iframe\")[0];\n      if (!iframe) return;\n      let doc = iframe.contentDocument;\n      if (!doc) {\n        return;\n      }\n      StyleUtil.addDefaultCss();\n      this.props.rendition.themes.default({\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\n          \"font-size\": `${\n            OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n              ? \"\"\n              : OtherUtil.getReaderConfig(\"fontSize\") || 17\n          }px !important`,\n          \"line-height\": `${\n            OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n              ? \"\"\n              : OtherUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\n          } !important`,\n          \"font-family\": `${\n            OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n              ? \"\"\n              : OtherUtil.getReaderConfig(\"fontFamily\") || \"Helvetica\"\n          } !important`,\n          color: `${\n            OtherUtil.getReaderConfig(\"theme\") === \"rgba(44,47,49,1)\"\n              ? \"white\"\n              : \"\"\n          } !important`,\n        },\n      });\n    });\n    this.props.rendition.on(\"selected\", (cfiRange: any, contents: any) => {\n      var range = contents.range(cfiRange);\n      var rect = range.getBoundingClientRect();\n      this.setState({ cfiRange, contents, rect });\n    });\n    this.props.rendition.themes.default({\n      \"a, article, cite, code, div, li, p, pre, span, table\": {\n        \"font-size\": `${\n          OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n            ? \"\"\n            : OtherUtil.getReaderConfig(\"fontSize\") || 17\n        }px !important`,\n        \"line-height\": `${\n          OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n            ? \"\"\n            : OtherUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\n        } !important`,\n        \"font-family\": `${\n          OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n            ? \"\"\n            : OtherUtil.getReaderConfig(\"fontFamily\") || \"Helvetica\"\n        } !important`,\n        color: `${\n          OtherUtil.getReaderConfig(\"theme\") === \"rgba(44,47,49,1)\"\n            ? \"white\"\n            : \"\"\n        } !important`,\n      },\n    });\n    this.props.rendition.display(\n      RecordLocation.getCfi(this.props.currentBook.key) === null\n        ? null\n        : RecordLocation.getCfi(this.props.currentBook.key).cfi\n    );\n  }\n\n  previourChapter = () => {\n    const currentLocation = this.props.rendition.currentLocation();\n    if (!currentLocation.start) return;\n    let chapterIndex = currentLocation.start.index;\n    const section = this.props.currentEpub.section(chapterIndex - 1);\n    if (section && section.href) {\n      this.props.currentEpub.rendition.display(section.href);\n    }\n  };\n  nextChapter = () => {\n    const currentLocation = this.props.rendition.currentLocation();\n    if (!currentLocation.start) return;\n    let chapterIndex = currentLocation.start.index;\n    const section = this.props.currentEpub.section(chapterIndex + 1);\n    if (section && section.href) {\n      this.props.currentEpub.rendition.display(section.href);\n    }\n  };\n  render() {\n    const popupMenuProps = {\n      rendition: this.props.rendition,\n      cfiRange: this.state.cfiRange,\n      contents: this.state.contents,\n      rect: this.state.rect,\n    };\n    return (\n      <div className=\"view-area\">\n        {OtherUtil.getReaderConfig(\"readerMode\") &&\n          OtherUtil.getReaderConfig(\"readerMode\") !== \"double\" &&\n          this.props.locations && (\n            <>\n              <div\n                className=\"previous-chapter-single-container\"\n                onClick={() => {\n                  this.previourChapter();\n                }}\n              >\n                <span className=\"icon-dropdown previous-chapter-single\"></span>\n              </div>\n              <div\n                className=\"next-chapter-single-container\"\n                onClick={() => {\n                  this.nextChapter();\n                }}\n              >\n                <span className=\"icon-dropdown next-chapter-single\"></span>\n              </div>\n            </>\n          )}\n        <ImageViewer\n          {...{\n            isShow: this.props.isShow,\n            rendition: this.props.rendition,\n            handleEnterReader: this.props.handleEnterReader,\n            handleLeaveReader: this.props.handleLeaveReader,\n          }}\n        />\n        <PopupMenu {...popupMenuProps} />\n        {this.state.loading ? (\n          <div className=\"spinner\">\n            <div className=\"sk-chase\">\n              <div className=\"sk-chase-dot\"></div>\n              <div className=\"sk-chase-dot\"></div>\n              <div className=\"sk-chase-dot\"></div>\n              <div className=\"sk-chase-dot\"></div>\n              <div className=\"sk-chase-dot\"></div>\n              <div className=\"sk-chase-dot\"></div>\n            </div>\n          </div>\n        ) : null}\n        <>\n          {this.props.isShowBookmark ? <div className=\"bookmark\"></div> : null}\n        </>\n      </div>\n    );\n  }\n}\n\nexport default ViewArea;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport ViewArea from \"./component\";\nimport { handlePercentage } from \"../../store/actions/progressPanel\";\nimport {\n  handleOpenMenu,\n  handleShowBookmark,\n} from \"../../store/actions/viewArea\";\nimport { handleReadingEpub } from \"../../store/actions/book\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    chapters: state.reader.chapters,\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    locations: state.progressPanel.locations,\n    bookmarks: state.reader.bookmarks,\n    isShowBookmark: state.viewArea.isShowBookmark,\n  };\n};\nconst actionCreator = {\n  handlePercentage,\n  handleOpenMenu,\n  handleShowBookmark,\n  handleReadingEpub,\n};\n\nexport default connect(mapStateToProps, actionCreator)(ViewArea);\n","//图书下面的背景，包括页边和书脊\nimport React from \"react\";\nimport \"./background.css\";\nimport { BackgroundProps, BackgroundState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport { Trans } from \"react-i18next\";\n\nclass Background extends React.Component<BackgroundProps, BackgroundState> {\n  isFirst: Boolean;\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      isSingle:\n        OtherUtil.getReaderConfig(\"readerMode\") &&\n        OtherUtil.getReaderConfig(\"readerMode\") !== \"double\",\n      currentChapter: \"\",\n      prevPage: 0,\n      nextPage: 0,\n      scale: OtherUtil.getReaderConfig(\"scale\") || 1,\n      isShowFooter: OtherUtil.getReaderConfig(\"isShowFooter\") !== \"no\",\n      isUseBackground: OtherUtil.getReaderConfig(\"isUseBackground\") === \"yes\",\n    };\n    this.isFirst = true;\n  }\n  componentWillReceiveProps(nextProps: BackgroundProps) {\n    if (\n      nextProps.currentEpub.rendition&&nextProps.currentEpub.rendition.location &&\n      this.isFirst\n    ) {\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\n      if (!currentLocation.start) {\n        return;\n      }\n      this.props.handleFetchLocations(this.props.currentEpub);\n      this.isFirst = false;\n      this.setState({\n        prevPage: currentLocation.start.displayed.page,\n        nextPage: currentLocation.end.displayed.page,\n      });\n      let chapterHref = currentLocation.start.href;\n      let chapter = \"Unknown Chapter\";\n      let currentChapter = this.props.flattenChapters.filter(\n        (item: any) => item.href.split(\"#\")[0] === chapterHref\n      )[0];\n      if (currentChapter) {\n        chapter = currentChapter.label.trim(\" \");\n      }\n      this.setState({ currentChapter: chapter });\n    }\n  }\n  render() {\n    if (this.state.isUseBackground) {\n      return (\n        <div className=\"background\">\n          {this.state.isShowFooter && this.state.currentChapter && (\n            <p\n              className=\"progress-chapter-name\"\n              style={\n                this.state.isSingle\n                  ? {\n                      left: `calc(50vw - \n                      270px)`,\n                    }\n                  : {}\n              }\n            >\n              <Trans>{this.state.currentChapter}</Trans>\n            </p>\n          )}\n          {this.state.isShowFooter && !this.state.isSingle && (\n            <p\n              className=\"progress-book-name\"\n              style={\n                this.state.isSingle\n                  ? {\n                      right: `calc(50vw - \n                      270px)`,\n                    }\n                  : {}\n              }\n            >\n              <Trans>{this.props.currentBook.name}</Trans>\n            </p>\n          )}\n          {this.state.isShowFooter && this.state.prevPage > 0 && (\n            <p\n              className=\"background-page-left\"\n              style={\n                this.state.isSingle\n                  ? {\n                      left: `calc(50vw - \n                      270px)`,\n                    }\n                  : {}\n              }\n            >\n              <Trans i18nKey=\"Book Page\" count={this.state.prevPage}>\n                Page\n                {{\n                  count: this.state.prevPage,\n                }}\n              </Trans>\n            </p>\n          )}\n          {this.state.isShowFooter &&\n            this.state.nextPage > 0 &&\n            !this.state.isSingle && (\n              <p className=\"background-page-right\">\n                <Trans i18nKey=\"Book Page\" count={this.state.nextPage}>\n                  Page\n                  {{\n                    count: this.state.nextPage,\n                  }}\n                </Trans>\n              </p>\n            )}\n        </div>\n      );\n    }\n    return (\n      <div className=\"background\">\n        {this.state.isShowFooter && this.state.currentChapter && (\n          <p\n            className=\"progress-chapter-name\"\n            style={\n              this.state.isSingle\n                ? {\n                    left: `calc(50vw - \n                      270px)`,\n                  }\n                : {}\n            }\n          >\n            <Trans>{this.state.currentChapter}</Trans>\n          </p>\n        )}\n\n        {this.state.isShowFooter && !this.state.isSingle && (\n          <p\n            className=\"progress-book-name\"\n            style={\n              this.state.isSingle\n                ? {\n                    right: `calc(50vw - \n                      270px)`,\n                  }\n                : {}\n            }\n          >\n            <Trans>{this.props.currentBook.name}</Trans>\n          </p>\n        )}\n\n        {this.state.isShowFooter && this.state.prevPage > 0 && (\n          <p\n            className=\"background-page-left\"\n            style={\n              this.state.isSingle\n                ? {\n                    left: `calc(50vw - \n                      270px)`,\n                  }\n                : {}\n            }\n          >\n            <Trans i18nKey=\"Book Page\" count={this.state.prevPage}>\n              Page\n              {{\n                count: this.state.prevPage,\n              }}\n            </Trans>\n          </p>\n        )}\n        {this.state.isShowFooter &&\n          this.state.nextPage > 0 &&\n          !this.state.isSingle && (\n            <p className=\"background-page-right\">\n              <Trans i18nKey=\"Book Page\" count={this.state.nextPage}>\n                Page\n                {{\n                  count: this.state.nextPage,\n                }}\n              </Trans>\n            </p>\n          )}\n        <div\n          className=\"background-box2\"\n          style={\n            this.state.isSingle\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 7px)`,\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\n                }\n              : {}\n          }\n        ></div>\n        <div\n          className=\"background-box3\"\n          style={\n            this.state.isSingle\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 9px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 9px)`,\n                }\n              : {}\n          }\n        >\n          <div\n            className=\"spine-shadow-left\"\n            style={\n              this.state.isSingle ||\n              OtherUtil.getReaderConfig(\"theme\") === \"rgba(44,47,49,1)\"\n                ? { display: \"none\" }\n                : {}\n            }\n          ></div>\n          <div\n            className=\"book-spine\"\n            style={this.state.isSingle ? { display: \"none\" } : {}}\n          ></div>\n          <div\n            className=\"spine-shadow-right\"\n            style={\n              OtherUtil.getReaderConfig(\"theme\") === \"rgba(44,47,49,1)\"\n                ? { display: \"none\" }\n                : this.state.isSingle\n                ? {\n                    position: \"relative\",\n                    right: 0,\n                  }\n                : {}\n            }\n          ></div>\n        </div>\n\n        <div\n          className=\"background-box1\"\n          style={\n            this.state.isSingle\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 5px)`,\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\n                }\n              : {}\n          }\n        ></div>\n      </div>\n    );\n  }\n}\n\nexport default Background;\n","//图书下面的背景，包括页边和书脊\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport Background from \"./component\";\nimport { handleFetchLocations } from \"../../store/actions/progressPanel\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    flattenChapters: state.reader.flattenChapters,\n    locations: state.progressPanel.locations,\n  };\n};\nconst actionCreator = { handleFetchLocations };\nexport default connect(mapStateToProps, actionCreator)(Background);\n","//修改阅读器背景色\nimport React from \"react\";\nimport { themeList } from \"../../constants/readerConfig\";\nimport StyleUtil from \"../../utils/styleUtil\";\nimport \"./themeList.css\";\nimport { Trans } from \"react-i18next\";\nimport { ThemeListProps, ThemeListState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass ThemeList extends React.Component<ThemeListProps, ThemeListState> {\n  constructor(props: ThemeListProps) {\n    super(props);\n    this.state = {\n      currentBackgroundIndex: themeList.findIndex((item) => {\n        return (\n          item.theme ===\n          (OtherUtil.getReaderConfig(\"theme\") || \"rgba(255,255,255,1)\")\n        );\n      }),\n    };\n  }\n  handleChangeColor(theme: string, index: number) {\n    OtherUtil.setReaderConfig(\"theme\", theme);\n    this.setState({\n      currentBackgroundIndex: index,\n    });\n    if (index === 4) {\n      this.props.currentEpub.rendition.themes.default({\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\n          color: `white !important`,\n        },\n      });\n    } else {\n      this.props.currentEpub.rendition.themes.default({\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\n          color: `inherit !important`,\n        },\n      });\n    }\n    StyleUtil.addDefaultCss();\n  }\n  render() {\n    const renderBackgroundColorList = () => {\n      return themeList.map((item, index) => {\n        return (\n          <li\n            key={item.id}\n            className={\n              index === this.state.currentBackgroundIndex\n                ? \"active-color background-color-circle\"\n                : \"background-color-circle\"\n            }\n            onClick={() => {\n              this.handleChangeColor(item.theme, index);\n            }}\n            style={{ backgroundColor: item.theme }}\n          ></li>\n        );\n      });\n    };\n    return (\n      <div className=\"background-color-setting\">\n        <div className=\"background-color-text\">\n          <Trans>Background Color</Trans>\n        </div>\n        <ul className=\"background-color-list\">{renderBackgroundColorList()}</ul>\n      </div>\n    );\n  }\n}\n\nexport default ThemeList;\n","import { connect } from \"react-redux\";\nimport { withNamespaces } from \"react-i18next\";\nimport ThemeList from \"./component\";\nimport { stateType } from \"../../store\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(ThemeList as any));\n","//字体大小选择页面\nimport React from \"react\";\nimport { Trans } from \"react-i18next\";\nimport { SliderListProps, SliderListState } from \"./interface\";\nimport \"./sliderList.css\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass SliderList extends React.Component<SliderListProps, SliderListState> {\n  constructor(props: SliderListProps) {\n    super(props);\n    this.state = {\n      value:\n        this.props.mode === \"fontSize\"\n          ? OtherUtil.getReaderConfig(\"fontSize\") || \"17\"\n          : OtherUtil.getReaderConfig(\"scale\") || \"1\",\n    };\n  }\n\n  onValueChange = (event: any) => {\n    if (this.props.mode === \"fontSize\") {\n      const fontSize = event.target.value;\n      this.setState({ value: fontSize });\n      OtherUtil.setReaderConfig(\"fontSize\", fontSize);\n      this.props.currentEpub.rendition.themes.default({\n        \"a, article, cite, code, div, li, p, pre, span, table\": {\n          \"font-size\": `${fontSize || 17}px !important`,\n        },\n      });\n    } else {\n      const scale = event.target.value;\n      this.setState({ value: scale });\n      OtherUtil.setReaderConfig(\"scale\", scale);\n      this.props.handleMessage(\"Try refresh or restart\");\n      this.props.handleMessageBox(true);\n    }\n  };\n  //使进度百分比随拖动实时变化\n  onValueInput = (event: any) => {\n    this.setState({ value: event.target.value });\n  };\n  render() {\n    return (\n      <div className=\"font-size-setting\">\n        <div className=\"font-size-title\">\n          {this.props.mode === \"fontSize\" ? (\n            <>\n              <Trans>Font Size</Trans>&nbsp;&nbsp; &nbsp;\n              <span>{this.state.value}px</span>\n            </>\n          ) : (\n            <>\n              <Trans>Scale</Trans>&nbsp;&nbsp; &nbsp;\n              <span>\n                {parseInt((parseFloat(this.state.value) * 100).toString())}%\n              </span>\n            </>\n          )}\n        </div>\n\n        <span\n          className=\"ultra-small-size\"\n          style={\n            this.props.mode === \"fontSize\"\n              ? {}\n              : { position: \"relative\", right: 7 }\n          }\n        >\n          {this.props.mode === \"fontSize\" ? \"A\" : `0.5`}\n        </span>\n        <div className=\"font-size-selector\">\n          <input\n            className=\"input-progress\"\n            defaultValue={this.state.value}\n            type=\"range\"\n            max={this.props.maxValue}\n            min={this.props.minValue}\n            step={this.props.mode === \"fontSize\" ? \"1\" : \"0.1\"}\n            onInput={(event) => {\n              this.onValueChange(event);\n            }}\n            onChange={(event) => {\n              this.onValueInput(event);\n            }}\n          />\n        </div>\n        {this.props.mode === \"fontSize\" ? (\n          <span className=\"ultra-large-size\">A</span>\n        ) : (\n          <span\n            className=\"ultra-large-size\"\n            style={{ fontSize: \"16px\", left: 5 }}\n          >\n            1.5\n          </span>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default SliderList;\n","//字体大小选择页面\nimport { connect } from \"react-redux\";\nimport { withNamespaces } from \"react-i18next\";\nimport SliderList from \"./component\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return { currentEpub: state.book.currentEpub };\n};\nconst actionCreator = {\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(SliderList as any));\n","//图书样式设置的下拉菜单页面\nimport React from \"react\";\nimport { dropdownList } from \"../../constants/readerConfig\";\nimport \"./dropdownList.css\";\nimport { Trans } from \"react-i18next\";\nimport { DropdownListProps, DropdownListState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nconst isElectron = require(\"is-electron\");\nif (isElectron()) {\n  const { ipcRenderer } = window.require(\"electron\");\n  dropdownList[0].option = ipcRenderer.sendSync(\"fonts-ready\", \"ping\");\n}\n\nclass DropdownList extends React.Component<\n  DropdownListProps,\n  DropdownListState\n> {\n  constructor(props: DropdownListProps) {\n    super(props);\n    this.state = {\n      currentFontFamilyIndex: dropdownList[0].option.findIndex((item: any) => {\n        return item === (OtherUtil.getReaderConfig(\"fontFamily\") || \"Arial\");\n      }),\n      currentLineHeightIndex: dropdownList[1].option.findIndex((item: any) => {\n        return item === (OtherUtil.getReaderConfig(\"lineHeight\") || \"1.25\");\n      }),\n    };\n  }\n  componentDidMount() {\n    //使下拉菜单选中预设的值\n\n    document\n      .querySelector(\".paragraph-character-setting\")!\n      .children[0].children[1].children[\n        this.state.currentFontFamilyIndex === -1\n          ? 0\n          : this.state.currentFontFamilyIndex\n      ].setAttribute(\"selected\", \"selected\");\n\n    document\n      .querySelector(\".paragraph-character-setting\")!\n      .children[1].children[1].children[\n        this.state.currentLineHeightIndex\n      ].setAttribute(\"selected\", \"selected\");\n  }\n  //切换不同的样式\n  handleView(event: any, option: string) {\n    let arr = event.target.value.split(\",\");\n    OtherUtil.setReaderConfig(option, arr[0]);\n    switch (option) {\n      case \"fontFamily\":\n        this.setState({\n          currentFontFamilyIndex: arr[1],\n        });\n        this.props.currentEpub.rendition.themes.default({\n          \"a, article, cite, code, div, li, p, pre, span, table\": {\n            \"font-family\": `${arr[0] || \"Helvetica\"} !important`,\n          },\n        });\n        break;\n\n      case \"lineHeight\":\n        this.setState({\n          currentLineHeightIndex: arr[1],\n        });\n        this.props.currentEpub.rendition.themes.default({\n          \"a, article, cite, code, div, li, p, pre, span, table\": {\n            \"line-height\": `${arr[0] || \"1.25\"} !important`,\n          },\n        });\n        break;\n\n      default:\n        break;\n    }\n  }\n  render() {\n    const renderParagraphCharacter = () => {\n      return dropdownList.map((item) => (\n        <li className=\"paragraph-character-container\" key={item.id}>\n          <p className=\"general-setting-title\">\n            <Trans>{item.title}</Trans>\n          </p>\n          <select\n            name=\"\"\n            className=\"general-setting-dropdown\"\n            onChange={(event) => {\n              this.handleView(event, item.value);\n            }}\n          >\n            {item.option.map((subItem: string, index: number) => (\n              <option\n                value={[subItem, index.toString()]}\n                className=\"general-setting-option\"\n                key={index}\n                style={item.id === 1 ? { fontFamily: subItem } : {}}\n              >\n                {subItem}\n              </option>\n            ))}\n          </select>\n        </li>\n      ));\n    };\n\n    return (\n      <ul className=\"paragraph-character-setting\">\n        {renderParagraphCharacter()}\n      </ul>\n    );\n  }\n}\n\nexport default DropdownList;\n","//图书样式设置的下拉菜单页面\nimport { connect } from \"react-redux\";\nimport { withNamespaces } from \"react-i18next\";\nimport DropdownList from \"./component\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return { currentEpub: state.book.currentEpub };\n};\nconst actionCreator = {\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(DropdownList as any));\n","//阅读模式切换\nimport React from \"react\";\nimport \"./modeControl.css\";\nimport { Trans } from \"react-i18next\";\nimport { ModeControlProps, ModeControlState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass ModeControl extends React.Component<ModeControlProps, ModeControlState> {\n  constructor(props: ModeControlProps) {\n    super(props);\n    this.state = {\n      readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\n    };\n  }\n\n  handleChangeMode = (mode: string) => {\n    this.setState({ readerMode: mode });\n    OtherUtil.setReaderConfig(\"readerMode\", mode);\n    this.props.handleMessage(\"Try refresh or restart\");\n    this.props.handleMessageBox(true);\n  };\n  render() {\n    return (\n      <div className=\"single-control-container\">\n        <div\n          className=\"single-mode-container\"\n          onClick={() => {\n            this.handleChangeMode(\"single\");\n          }}\n          style={this.state.readerMode === \"single\" ? {} : { opacity: 0.4 }}\n        >\n          <span className=\"icon-single-page single-page-icon\"></span>\n          <div className=\"single-mode-text\">\n            <Trans>Single-Page Mode</Trans>\n          </div>\n        </div>\n        <div\n          className=\"double-mode-container\"\n          onClick={() => {\n            this.handleChangeMode(\"double\");\n          }}\n          style={this.state.readerMode === \"double\" ? {} : { opacity: 0.4 }}\n        >\n          <span className=\"icon-two-page two-page-icon\"></span>\n          <div className=\"double-mode-text\">\n            <Trans>Double-Page Mode</Trans>\n          </div>\n        </div>\n        <div\n          className=\"double-mode-container\"\n          onClick={() => {\n            this.handleChangeMode(\"scroll\");\n          }}\n          style={this.state.readerMode === \"scroll\" ? {} : { opacity: 0.4 }}\n        >\n          <span className=\"icon-scroll1 two-page-icon\"></span>\n          <div className=\"double-mode-text\">\n            <Trans>Chapter Scroll</Trans>\n          </div>\n        </div>\n        <div\n          className=\"double-mode-container\"\n          onClick={() => {\n            this.handleChangeMode(\"continuous\");\n          }}\n          style={this.state.readerMode === \"continuous\" ? {} : { opacity: 0.4 }}\n        >\n          <span className=\"icon-scroll two-page-icon\"></span>\n          <div className=\"double-mode-text\">\n            <Trans>Continuous Scroll</Trans>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\nexport default ModeControl;\n","//单双页切换\nimport { connect } from \"react-redux\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport { withNamespaces } from \"react-i18next\";\nimport ModeControl from \"./component\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = { handleMessageBox, handleMessage };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(ModeControl as any));\n","//右侧阅读选项面板\nimport React from \"react\";\nimport \"./settingPanel.css\";\nimport ThemeList from \"../../components/themeList\";\nimport SliderList from \"../../components/sliderList\";\nimport DropdownList from \"../../components/dropdownList\";\nimport ModeControl from \"../../components/modeControl\";\nimport { SettingPanelProps, SettingPanelState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport OtherUtil from \"../../utils/otherUtil\";\n\nclass SettingPanel extends React.Component<\n  SettingPanelProps,\n  SettingPanelState\n> {\n  constructor(props: SettingPanelProps) {\n    super(props);\n    this.state = {\n      isSupported: false,\n      isAudioOn: false,\n      readerMode: OtherUtil.getReaderConfig(\"readerMode\"),\n    };\n  }\n  componentDidMount() {\n    if (\"speechSynthesis\" in window) {\n      this.setState({ isSupported: true });\n    }\n    if (this.state.isAudioOn) {\n      window.speechSynthesis && window.speechSynthesis.cancel();\n      this.setState({ isAudioOn: false });\n    }\n  }\n  handleChangeAudio = () => {\n    if (this.state.isAudioOn) {\n      window.speechSynthesis.cancel();\n      this.setState({ isAudioOn: false });\n    } else {\n      this.setState({ isAudioOn: true }, () => {\n        this.handleAudio();\n      });\n    }\n  };\n  handleAudio = () => {\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\n    const cfibase = currentLocation.start.cfi\n      .replace(/!.*/, \"\")\n      .replace(\"epubcfi(\", \"\");\n    const cfistart = currentLocation.start.cfi\n      .replace(/.*!/, \"\")\n      .replace(/\\)/, \"\");\n    const cfiend = currentLocation.end.cfi.replace(/.*!/, \"\").replace(/\\)/, \"\");\n    const cfiRange = `epubcfi(${cfibase}!,${cfistart},${cfiend})`;\n    this.props.currentEpub.getRange(cfiRange).then((range: any) => {\n      let text = range.toString();\n      text = text.replace(/\\s\\s/g, \"\");\n      text = text.replace(/\\r/g, \"\");\n      text = text.replace(/\\n/g, \"\");\n      text = text.replace(/\\t/g, \"\");\n      text = text.replace(/\\f/g, \"\");\n      var msg = new SpeechSynthesisUtterance();\n      msg.text = text;\n      window.speechSynthesis.speak(msg);\n      msg.onend = (event) => {\n        console.log(\n          \"Utterance has finished being spoken after \" +\n            event.elapsedTime +\n            \" milliseconds.\"\n        );\n        if (!this.state.isAudioOn || this.props.isReading) {\n          return;\n        }\n        this.props.currentEpub.rendition.next();\n        this.handleAudio();\n      };\n    });\n  };\n  render() {\n    return (\n      <div className=\"setting-panel-parent\">\n        <div className=\"setting-panel\">\n          <div className=\"setting-panel-title\">\n            <Trans>Reading Option</Trans>\n          </div>\n          <ModeControl />\n          {this.state.isSupported && this.props.locations ? (\n            <div className=\"single-control-switch-container\">\n              <span className=\"single-control-switch-title\">\n                {this.state.isAudioOn ? (\n                  <Trans>Turn off audio</Trans>\n                ) : (\n                  <Trans>Turn on audio</Trans>\n                )}\n              </span>\n\n              <span\n                className=\"single-control-switch\"\n                onClick={() => {\n                  this.handleChangeAudio();\n                }}\n              >\n                <span\n                  className=\"single-control-button\"\n                  style={this.state.isAudioOn ? { float: \"right\" } : {}}\n                ></span>\n              </span>\n            </div>\n          ) : null}\n          <ThemeList />\n          <SliderList\n            {...{\n              maxValue: 31,\n              minValue: 13,\n              mode: \"fontSize\",\n            }}\n          />\n          {this.state.readerMode && this.state.readerMode !== \"double\" ? (\n            <SliderList\n              {...{\n                maxValue: 1.5,\n                minValue: 0.5,\n                mode: \"scale\",\n              }}\n            />\n          ) : null}\n\n          <DropdownList />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SettingPanel;\n","import { withNamespaces } from \"react-i18next\";\nimport { connect } from \"react-redux\";\nimport SettingPanel from \"./component\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    locations: state.progressPanel.locations,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(SettingPanel as any));\n","//图书导航栏的目录列表\nimport React from \"react\";\nimport \"./contentList.css\";\nimport { ContentListProps, ContentListState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nclass ContentList extends React.Component<ContentListProps, ContentListState> {\n  constructor(props: ContentListProps) {\n    super(props);\n    this.state = {\n      chapters: [],\n      isCollapsed: true,\n      currentIndex: -1,\n      isExpandContent: OtherUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\n    };\n    this.handleJump = this.handleJump.bind(this);\n  }\n\n  componentWillMount() {\n    //获取目录\n    this.props.currentEpub.loaded.navigation\n      .then((chapters: any) => {\n        this.setState({ chapters: chapters.toc });\n      })\n      .catch(() => {\n        console.log(\"Error occurs\");\n      });\n  }\n  handleJump(event: any) {\n    event.preventDefault();\n    let href = event.target.getAttribute(\"href\");\n    this.props.currentEpub.rendition.display(href);\n  }\n  render() {\n    const renderContentList = (items: any, level: number) => {\n      level++;\n      return items.map((item: any, index: number) => {\n        return (\n          <li key={index} className=\"book-content-list\">\n            {item.subitems.length > 0 &&\n              level <= 2 &&\n              !this.state.isExpandContent && (\n                <span\n                  className=\"icon-dropdown content-dropdown\"\n                  onClick={() => {\n                    this.setState({\n                      currentIndex:\n                        this.state.currentIndex === index ? -1 : index,\n                    });\n                  }}\n                  style={\n                    this.state.currentIndex === index\n                      ? {}\n                      : { transform: \"rotate(-90deg)\" }\n                  }\n                ></span>\n              )}\n\n            <a\n              href={item.href}\n              onClick={this.handleJump}\n              className=\"book-content-name\"\n            >\n              {item.label}\n            </a>\n            {item.subitems.length > 0 &&\n            (this.state.currentIndex === index ||\n              level > 2 ||\n              this.state.isExpandContent) ? (\n              <ul>{renderContentList(item.subitems, level)}</ul>\n            ) : null}\n          </li>\n        );\n      });\n    };\n\n    return (\n      <div className=\"book-content-container\">\n        <ul className=\"book-content\">\n          {this.state.chapters && renderContentList(this.state.chapters, 1)}\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default ContentList;\n","//图书导航栏的目录列表\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport ContentList from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    chapters: state.reader.chapters,\n  };\n};\nconst actionCreator = {};\nexport default connect(mapStateToProps, actionCreator)(ContentList);\n","//图书导航栏页面的书签，笔记，书摘页面\nimport React from \"react\";\nimport \"./navList.css\";\nimport { Trans } from \"react-i18next\";\nimport { NavListProps, NavListState } from \"./interface\";\nimport DeleteIcon from \"../deleteIcon\";\nclass NavList extends React.Component<NavListProps, NavListState> {\n  constructor(props: NavListProps) {\n    super(props);\n    this.state = {\n      deleteIndex: -1,\n    };\n  }\n  //跳转到图书的指定位置\n  handleJump(cfi: string) {\n    if (!cfi) {\n      this.props.handleMessage(\"Wrong bookmark\");\n      this.props.handleMessageBox(true);\n      return;\n    }\n    this.props.currentEpub.rendition.display(cfi);\n  }\n  handleShowDelete = (index: number) => {\n    this.setState({ deleteIndex: index });\n  };\n  render() {\n    let currentData: any = ((this.props.currentTab === \"bookmarks\"\n      ? this.props.bookmarks\n      : this.props.currentTab === \"notes\"\n      ? this.props.notes.filter((item) => item.notes !== \"\")\n      : this.props.digests) as any).filter((item: any) => {\n      return item.bookKey === this.props.currentBook.key;\n    });\n    const renderBookNavList = () => {\n      return currentData.reverse().map((item: any, index: number) => {\n        const bookmarkProps = {\n          itemKey: item.key,\n          mode: this.props.currentTab === \"bookmarks\" ? \"bookmarks\" : \"notes\",\n        };\n        return (\n          <li\n            className=\"book-bookmark-list\"\n            key={item.key}\n            onMouseEnter={() => {\n              this.handleShowDelete(index);\n            }}\n            onMouseLeave={() => {\n              this.handleShowDelete(-1);\n            }}\n          >\n            <p className=\"book-bookmark-digest\">\n              {this.props.currentTab === \"bookmarks\"\n                ? item.label\n                : this.props.currentTab === \"notes\"\n                ? item.notes\n                : item.text}\n            </p>\n            <span className=\"bookmark-page-list-item-title\">\n              <Trans>{item.chapter}</Trans>\n            </span>\n            {this.state.deleteIndex === index ? (\n              <DeleteIcon {...bookmarkProps} />\n            ) : null}\n            <div\n              className=\"book-bookmark-link\"\n              onClick={() => {\n                this.handleJump(item.cfi);\n              }}\n              style={{ cursor: \"pointer\" }}\n            >\n              <Trans>Go To</Trans>\n            </div>\n            <div className=\"book-bookmark-progress\">\n              {Math.floor(item.percentage * 100)}%\n            </div>\n          </li>\n        );\n      });\n    };\n    if (!currentData[0]) {\n      return (\n        <div className=\"navigation-panel-empty-bookmark\">\n          <Trans>Empty</Trans>\n        </div>\n      );\n    }\n    return (\n      <div className=\"book-bookmark-container\">\n        <ul className=\"book-bookmark\">{renderBookNavList()}</ul>\n      </div>\n    );\n  }\n}\n\nexport default NavList;\n","//图书导航栏页面的书签页面\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport NavList from \"./component\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    currentEpub: state.book.currentEpub,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = { handleMessageBox, handleMessage };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(NavList as any));\n","//左侧图书导航面板\nimport React from \"react\";\nimport \"./navigationPanel.css\";\nimport ContentList from \"../../components/contentList\";\nimport BookNavList from \"../../components/navList\";\nimport { Trans } from \"react-i18next\";\nimport { NavigationPanelProps, NavigationPanelState } from \"./interface\";\nimport SearchBox from \"../../components/searchBox\";\nimport Parser from \"html-react-parser\";\n\nclass NavigationPanel extends React.Component<\n  NavigationPanelProps,\n  NavigationPanelState\n> {\n  timer: any;\n  constructor(props: NavigationPanelProps) {\n    super(props);\n    this.state = {\n      currentTab: \"contents\",\n      chapters: [],\n      cover: \"\",\n      isSearch: false,\n      searchList: null,\n      startIndex: 0,\n      currentIndex: 0,\n    };\n  }\n  handleSearchState = (isSearch: boolean) => {\n    this.setState({ isSearch });\n  };\n  handleSearchList = (searchList: any) => {\n    this.setState({ searchList });\n  };\n  componentDidMount() {\n    this.props.currentEpub\n      .coverUrl()\n      .then((url: string) => {\n        this.setState({ cover: url });\n      })\n      .catch(() => {\n        console.log(\"Error occurs\");\n      });\n    this.props.handleFetchBookmarks();\n  }\n\n  handleChangeTab = (currentTab: string) => {\n    this.setState({ currentTab });\n  };\n  renderSearchList = () => {\n    if (!this.state.searchList[0]) {\n      return (\n        <div className=\"navigation-panel-empty-bookmark\">\n          <Trans>Empty</Trans>\n        </div>\n      );\n    }\n    return this.state.searchList\n      .slice(\n        this.state.currentIndex * 10,\n        this.state.currentIndex * 10 + 10 > this.state.searchList.length\n          ? this.state.searchList.length\n          : this.state.currentIndex * 10 + 10\n      )\n      .map((item: any, index: number) => {\n        return (\n          <li\n            className=\"nav-search-list-item\"\n            key={item.cfi}\n            onClick={() => {\n              this.props.currentEpub.rendition.display(item.cfi);\n            }}\n          >\n            {Parser(item.excerpt)}\n          </li>\n        );\n      });\n  };\n  renderSearchPage = () => {\n    let startIndex = this.state.startIndex;\n    let currentIndex =\n      startIndex > 0 ? startIndex + 2 : this.state.currentIndex;\n    let pageList = [];\n    let total = Math.ceil(this.state.searchList.length / 10);\n    if (total <= 5) {\n      for (let i = 0; i < total; i++) {\n        pageList.push(\n          <li\n            className={\n              currentIndex === i\n                ? \"nav-search-page-item active-page \"\n                : \"nav-search-page-item\"\n            }\n            onClick={() => {\n              this.setState({ currentIndex: i });\n            }}\n          >\n            {i + 1}\n          </li>\n        );\n      }\n    } else {\n      for (let i = 0; i < 5; i++) {\n        let isShow = currentIndex > 2 ? i === 2 : currentIndex === i;\n        pageList.push(\n          <li\n            className={\n              isShow\n                ? \"nav-search-page-item active-page \"\n                : \"nav-search-page-item\"\n            }\n            onClick={() => {\n              if (i === 3 && startIndex === 0) {\n                this.setState({\n                  startIndex: 1,\n                  currentIndex: 3,\n                });\n                return;\n              }\n              this.setState({\n                startIndex: currentIndex > 2 ? i + startIndex - 2 : 0,\n                currentIndex: i + startIndex,\n              });\n            }}\n          >\n            {i + startIndex + 1}\n          </li>\n        );\n      }\n    }\n    return pageList;\n  };\n  render() {\n    const searchProps = {\n      mode: this.state.isSearch ? \"\" : \"nav\",\n      width: \"100px\",\n      height: \"35px\",\n      isNavSearch: this.state.isSearch,\n      handleSearchState: this.handleSearchState,\n      handleSearchList: this.handleSearchList,\n    };\n    const bookmarkProps = {\n      currentTab: this.state.currentTab,\n    };\n    return (\n      <div className=\"navigation-panel\">\n        {this.state.isSearch ? (\n          <>\n            <span\n              className=\"icon-close nav-close-icon\"\n              onClick={() => {\n                this.handleSearchState(false);\n                this.props.handleSearch(false);\n                this.setState({ searchList: null });\n              }}\n            ></span>\n            <div\n              className=\"header-search-container\"\n              style={this.state.isSearch ? { left: 40 } : {}}\n            >\n              <div\n                className=\"navigation-search-title\"\n                style={{ height: \"20px\", margin: \"0px 25px 13px\" }}\n              >\n                <Trans>Search the book</Trans>\n              </div>\n              <SearchBox {...searchProps} />\n            </div>\n            <ul className=\"nav-search-list\">\n              {this.state.searchList ? this.renderSearchList() : null}\n            </ul>\n            <ul className=\"nav-search-page\">\n              {this.state.searchList ? this.renderSearchPage() : null}\n            </ul>\n          </>\n        ) : (\n          <>\n            <div className=\"navigation-header\">\n              <img className=\"book-cover\" src={this.state.cover} alt=\"\" />\n              <p className=\"book-title\">{this.props.currentBook.name}</p>\n              <p className=\"book-arthur\">\n                <Trans>Author</Trans>:{\" \"}\n                <Trans>\n                  {this.props.currentBook.author\n                    ? this.props.currentBook.author\n                    : \"Unknown Authur\"}\n                </Trans>\n              </p>\n              <span className=\"reading-duration\">\n                <Trans>Reading Time</Trans>: {Math.floor(this.props.time / 60)}\n                &nbsp;\n                <Trans>Minute</Trans>\n              </span>\n              <div className=\"navigation-search-box\">\n                <SearchBox {...searchProps} />\n              </div>\n\n              <div className=\"navigation-navigation\">\n                <span\n                  className=\"book-content-title\"\n                  onClick={() => {\n                    this.handleChangeTab(\"contents\");\n                  }}\n                  style={\n                    this.state.currentTab === \"contents\"\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\n                      : { color: \"rgba(217, 217, 217, 1)\" }\n                  }\n                >\n                  <Trans>Content</Trans>\n                </span>\n                <span\n                  className=\"book-bookmark-title\"\n                  style={\n                    this.state.currentTab === \"bookmarks\"\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\n                      : { color: \"rgba(217, 217, 217, 1)\" }\n                  }\n                  onClick={() => {\n                    this.handleChangeTab(\"bookmarks\");\n                  }}\n                >\n                  <Trans>Bookmark</Trans>\n                </span>\n                <span\n                  className=\"book-bookmark-title\"\n                  style={\n                    this.state.currentTab === \"notes\"\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\n                      : { color: \"rgba(217, 217, 217, 1)\" }\n                  }\n                  onClick={() => {\n                    this.handleChangeTab(\"notes\");\n                  }}\n                >\n                  <Trans>Note</Trans>\n                </span>\n                <span\n                  className=\"book-bookmark-title\"\n                  style={\n                    this.state.currentTab === \"digests\"\n                      ? { color: \"rgba(112, 112, 112, 1)\" }\n                      : { color: \"rgba(217, 217, 217, 1)\" }\n                  }\n                  onClick={() => {\n                    this.handleChangeTab(\"digests\");\n                  }}\n                >\n                  <Trans>Digest</Trans>\n                </span>\n              </div>\n            </div>\n            <div className=\"navigation-body-parent\">\n              <div className=\"navigation-body\">\n                {this.state.currentTab === \"contents\" ? (\n                  <ContentList />\n                ) : (\n                  <BookNavList {...bookmarkProps} />\n                )}\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default NavigationPanel;\n","//图书导航栏\nimport { connect } from \"react-redux\";\nimport { handleFetchBookmarks } from \"../../store/actions/reader\";\nimport { handleSearch } from \"../../store/actions/manager\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport NavigationPanel from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n  };\n};\nconst actionCreator = { handleFetchBookmarks, handleSearch };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(NavigationPanel as any));\n","class Bookmark {\n  key: string;\n  bookKey: string;\n  cfi: string;\n  label: string;\n  percentage: number;\n  chapter: string;\n  constructor(\n    bookKey: string,\n    cfi: string,\n    label: string,\n    percentage: number,\n    chapter: string\n  ) {\n    this.key = new Date().getTime() + \"\"; // 唯一的键\n    this.bookKey = bookKey; // 所属的书籍的键\n    this.cfi = cfi; // 标记阅读位置的cfi\n    this.label = label; // 此项书签的别名\n    this.percentage = percentage; // 此项书签的摘要\n    this.chapter = chapter; // 此项书签的摘要\n  }\n}\n\nexport default Bookmark;\n","// 记录书本打开记录\nclass ReadingTime {\n  static setTime(bookKey: string, time: number) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!)||{};\n    obj[bookKey] = time;\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\n  }\n\n  static getTime(bookKey: string) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!)||{};\n    return obj[bookKey] || 0;\n  }\n  static clearTime(bookKey: string) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    delete obj[bookKey];\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\n  }\n}\n\nexport default ReadingTime;\n","//顶部图书操作面板\nimport React from \"react\";\nimport \"./operationPanel.css\";\nimport Bookmark from \"../../model/Bookmark\";\nimport { Trans } from \"react-i18next\";\nimport localforage from \"localforage\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport { OperationPanelProps, OperationPanelState } from \"./interface\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport ReadingTime from \"../../utils/readingTime\";\nimport { withRouter } from \"react-router-dom\";\n\ndeclare var document: any;\n\nclass OperationPanel extends React.Component<\n  OperationPanelProps,\n  OperationPanelState\n> {\n  timeStamp: number;\n  speed: number;\n  constructor(props: OperationPanelProps) {\n    super(props);\n    this.state = {\n      isFullScreen:\n        OtherUtil.getReaderConfig(\"isFullScreen\") === \"yes\" ? true : false, // 是否进入全屏模式\n      isBookmark: false, // 是否添加书签\n      time: 0,\n      currentPercentage: RecordLocation.getCfi(this.props.currentBook.key)\n        ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n        : 0,\n      timeLeft: 0,\n    };\n    this.timeStamp = Date.now();\n    this.speed = 30000;\n  }\n  componentWillReceiveProps(nextProps: OperationPanelProps) {\n    if (\n      nextProps.currentEpub.rendition &&\n      nextProps.currentEpub.rendition.location\n    ) {\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\n      if (!currentLocation.start) {\n        return;\n      }\n      if (\n        this.props.currentEpub.rendition.currentLocation().percentage !==\n        nextProps.currentEpub.rendition.currentLocation().percentage\n      ) {\n        this.speed = Date.now() - this.timeStamp;\n        this.timeStamp = Date.now();\n      }\n      this.setState({\n        timeLeft:\n          ((currentLocation.start.displayed.total -\n            currentLocation.start.displayed.page) *\n            this.speed) /\n          1000,\n      });\n      // let nextPercentage = section.start.percentage;\n    }\n  }\n  // 点击切换全屏按钮触发\n  handleScreen() {\n    !this.state.isFullScreen\n      ? this.handleFullScreen()\n      : this.handleExitFullScreen();\n  }\n  //控制进入全屏\n  handleFullScreen() {\n    let de: any = document.documentElement;\n    if (de.requestFullscreen) {\n      de.requestFullscreen();\n    } else if (de.mozRequestFullScreen) {\n      de.mozRequestFullScreen();\n    } else if (de.webkitRequestFullscreen) {\n      de.webkitRequestFullscreen();\n    } else if (de.msRequestFullscreen) {\n      de.msRequestFullscreen();\n    }\n\n    this.setState({ isFullScreen: true });\n    OtherUtil.setReaderConfig(\"isFullScreen\", \"yes\");\n  }\n\n  // 退出全屏模式\n  handleExitFullScreen() {\n    //解决使用esc退出全屏，再退出阅读时发生的bug\n    if (!document.fullscreenElement) return;\n\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen();\n    }\n\n    this.setState({ isFullScreen: false });\n    OtherUtil.setReaderConfig(\"isFullScreen\", \"no\");\n  }\n  handleAddBookmark() {\n    let bookKey = this.props.currentBook.key;\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\n    let chapterHref = currentLocation.start.href;\n    let chapter = \"Unknown Chapter\";\n    let currentChapter = this.props.flattenChapters.filter(\n      (item: any) =>\n        chapterHref.indexOf(item.href.split(\"#\")[0]) > -1 ||\n        item.href.split(\"#\")[0].indexOf(chapterHref) > -1\n    )[0];\n    if (currentChapter) {\n      chapter = currentChapter.label.trim(\" \");\n    }\n    const cfibase = currentLocation.start.cfi\n      .replace(/!.*/, \"\")\n      .replace(\"epubcfi(\", \"\");\n    const cfistart = currentLocation.start.cfi\n      .replace(/.*!/, \"\")\n      .replace(/\\)/, \"\");\n    const cfiend = currentLocation.end.cfi.replace(/.*!/, \"\").replace(/\\)/, \"\");\n    const cfiRange = `epubcfi(${cfibase}!,${cfistart},${cfiend})`;\n    const cfi = RecordLocation.getCfi(this.props.currentBook.key).cfi;\n    this.props.currentEpub.getRange(cfiRange).then((range: any) => {\n      if (!range) return;\n      let text = range.toString();\n      text = text.replace(/\\s\\s/g, \"\");\n      text = text.replace(/\\r/g, \"\");\n      text = text.replace(/\\n/g, \"\");\n      text = text.replace(/\\t/g, \"\");\n      text = text.replace(/\\f/g, \"\");\n      let percentage = RecordLocation.getCfi(this.props.currentBook.key)\n        .percentage\n        ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n        : 0;\n      let bookmark = new Bookmark(bookKey, cfi, text, percentage, chapter);\n      let bookmarkArr = this.props.bookmarks ?? [];\n      bookmarkArr.push(bookmark);\n      this.props.handleBookmarks(bookmarkArr);\n      localforage.setItem(\"bookmarks\", bookmarkArr);\n      this.setState({ isBookmark: true });\n      this.props.handleMessage(\"Add Successfully\");\n      this.props.handleMessageBox(true);\n      this.props.handleShowBookmark(true);\n    });\n  }\n\n  // 点击退出按钮的处理程序\n  handleExit() {\n    OtherUtil.setReaderConfig(\"isFullScreen\", \"no\");\n    window.speechSynthesis && window.speechSynthesis.cancel();\n    if (this.state.isFullScreen) {\n      this.handleExitFullScreen();\n    }\n    this.props.handleSearch(false);\n    this.props.handleOpenMenu(false);\n    window.close();\n    // this.props.history.push(\"/manager/home\");\n  }\n\n  render() {\n    return (\n      <div className=\"book-operation-panel\">\n        <div className=\"book-opeartion-info\">\n          <span>\n            <Trans\n              i18nKey=\"Current Reading Time\"\n              count={Math.floor(\n                (this.props.time -\n                  ReadingTime.getTime(this.props.currentBook.key)) /\n                  60\n              )}\n            >\n              Current Reading Time:\n              {{\n                count: Math.abs(\n                  Math.floor(\n                    (this.props.time -\n                      ReadingTime.getTime(this.props.currentBook.key)) /\n                      60\n                  )\n                ),\n              }}\n              Minutes\n            </Trans>\n          </span>\n          &nbsp;&nbsp;&nbsp;\n          <span>\n            <Trans\n              i18nKey=\"Finish Reading Time\"\n              count={Math.ceil(this.state.timeLeft / 60)}\n            >\n              Finish Reading Time:\n              {{\n                count: `${Math.ceil(this.state.timeLeft / 60)}`,\n              }}\n              Minutes\n            </Trans>\n          </span>\n        </div>\n        <div\n          className=\"exit-reading-button\"\n          onClick={() => {\n            this.handleExit();\n          }}\n        >\n          <span className=\"icon-exit exit-reading-icon\"></span>\n          <span className=\"exit-reading-text\">\n            <Trans>Exit</Trans>\n          </span>\n        </div>\n        <div\n          className=\"add-bookmark-button\"\n          onClick={() => {\n            this.handleAddBookmark();\n          }}\n        >\n          <span className=\"icon-add add-bookmark-icon\"></span>\n          <span className=\"add-bookmark-text\">\n            <Trans>Add Bookmark</Trans>\n          </span>\n        </div>\n        <div\n          className=\"enter-fullscreen-button\"\n          onClick={() => {\n            this.handleScreen();\n          }}\n        >\n          <span className=\"icon-fullscreen enter-fullscreen-icon\"></span>\n          {!this.state.isFullScreen ? (\n            <span className=\"enter-fullscreen-text\">\n              <Trans>Enter Fullscreen</Trans>\n            </span>\n          ) : (\n            <span className=\"enter-fullscreen-text\">\n              <Trans>Exit Fullscreen</Trans>\n            </span>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(OperationPanel);\n","//图书操作页面\nimport { connect } from \"react-redux\";\nimport {\n  handleBookmarks,\n  handleFetchBookmarks,\n} from \"../../store/actions/reader\";\nimport {\n  handleOpenMenu,\n  handleShowBookmark,\n} from \"../../store/actions/viewArea\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport {\n  handleMessageBox,\n  handleMessage,\n  handleSearch,\n} from \"../../store/actions/manager\";\nimport { handleReadingState } from \"../../store/actions/book\";\nimport OperationPanel from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    locations: state.progressPanel.locations,\n    flattenChapters: state.reader.flattenChapters,\n  };\n};\nconst actionCreator = {\n  handleBookmarks,\n  handleReadingState,\n  handleFetchBookmarks,\n  handleMessageBox,\n  handleMessage,\n  handleOpenMenu,\n  handleShowBookmark,\n  handleSearch,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(OperationPanel as any));\n","//底部阅读进度面板\nimport React from \"react\";\nimport \"./progressPanel.css\";\nimport RecordLocation from \"../../utils/recordLocation\";\nimport { Trans } from \"react-i18next\";\nimport { ProgressPanelProps, ProgressPanelState } from \"./interface\";\n\nclass ProgressPanel extends React.Component<\n  ProgressPanelProps,\n  ProgressPanelState\n> {\n  constructor(props: ProgressPanelProps) {\n    super(props);\n    this.state = {\n      displayPercentage: this.props.percentage ? this.props.percentage : 0,\n      currentChapter: \"\",\n      currentPage: 0,\n      totalPage: 0,\n      currentChapterIndex: 0,\n    };\n  }\n\n  componentWillReceiveProps(nextProps: ProgressPanelProps) {\n    if (\n      nextProps.currentEpub.rendition &&\n      nextProps.currentEpub.rendition.location\n    ) {\n      const currentLocation = this.props.currentEpub.rendition.currentLocation();\n      if (!currentLocation.start) {\n        return;\n      }\n      this.setState({\n        currentPage: currentLocation.start.displayed.page,\n        totalPage: currentLocation.start.displayed.total,\n        currentChapterIndex: currentLocation.start.index,\n      });\n      let chapterHref = currentLocation.start.href;\n      let chapter = \"Unknown Chapter\";\n      let currentChapter = this.props.flattenChapters.filter(\n        (item: any) => item.href.split(\"#\")[0] === chapterHref\n      )[0];\n      if (currentChapter) {\n        chapter = currentChapter.label.trim(\" \");\n      }\n      this.setState({ currentChapter: chapter });\n    }\n  }\n  //WARNING! To be deprecated in React v17. Use componentDidMount instead.\n  onProgressChange = (event: any) => {\n    const percentage = event.target.value / 100;\n    const location = percentage\n      ? this.props.locations.cfiFromPercentage(percentage)\n      : 0;\n    this.props.currentEpub.rendition.display(location);\n  };\n  //使进度百分比随拖动实时变化\n  onProgressInput = (event: any) => {\n    this.setState({ displayPercentage: event.target.value / 100 });\n  };\n  previourChapter = () => {\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\n    if (!currentLocation.start) return;\n    let chapterIndex = currentLocation.start.index;\n    this.setState({\n      currentChapterIndex: chapterIndex,\n    });\n    const section = this.props.currentEpub.section(chapterIndex - 1);\n    if (section && section.href) {\n      this.props.currentEpub.rendition.display(section.href).then(() => {\n        let percentage = RecordLocation.getCfi(this.props.currentBook.key)\n          .percentage\n          ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n          : 0;\n\n        this.setState({ displayPercentage: percentage });\n      });\n    }\n  };\n  nextChapter = () => {\n    const currentLocation = this.props.currentEpub.rendition.currentLocation();\n    if (!currentLocation.start) return;\n    let chapterIndex = currentLocation.start.index;\n    this.setState({\n      currentChapterIndex: chapterIndex,\n    });\n    const section = this.props.currentEpub.section(chapterIndex + 1);\n    if (section && section.href) {\n      this.props.currentEpub.rendition.display(section.href).then(() => {\n        let percentage = RecordLocation.getCfi(this.props.currentBook.key)\n          .percentage\n          ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n          : 0;\n        this.setState({ displayPercentage: percentage });\n      });\n    }\n  };\n  handleJumpChapter = (event: any) => {\n    if (!event.target.value) return;\n    const section = this.props.currentEpub.section(event.target.value);\n    if (section && section.href) {\n      this.props.currentEpub.rendition.display(section.href).then(() => {\n        let percentage = RecordLocation.getCfi(this.props.currentBook.key)\n          .percentage\n          ? RecordLocation.getCfi(this.props.currentBook.key).percentage\n          : 0;\n        this.setState({ displayPercentage: percentage });\n      });\n    }\n  };\n  handleJumpPage = (event: any) => {};\n  render() {\n    if (!this.props.locations) {\n      return (\n        <div className=\"progress-panel\">\n          <p className=\"progress-text\">\n            <Trans>Loading</Trans>\n          </p>\n        </div>\n      );\n    }\n    return (\n      <div className=\"progress-panel\">\n        <p className=\"progress-text\" style={{ marginTop: 10 }}>\n          <span>\n            <Trans>Current Progress</Trans>:{\" \"}\n            {Math.round(\n              this.state.displayPercentage > 1\n                ? 100\n                : this.state.displayPercentage * 100\n            )}\n            %&nbsp;&nbsp;&nbsp;\n          </span>\n        </p>\n\n        <p className=\"progress-text\" style={{ marginTop: 0 }}>\n          {this.state.currentPage > 0 ? (\n            <>\n              <Trans>Current Chapter Pages</Trans>\n              <input\n                type=\"text\"\n                name=\"jumpPage\"\n                id=\"jumpPage\"\n                onBlur={(event) => {\n                  this.handleJumpPage(event);\n                }}\n                value={this.state.currentPage}\n              />\n              <span>/ {this.state.totalPage}</span>&nbsp;&nbsp;&nbsp;\n              <Trans>Chapter Redirect</Trans>\n              <input\n                type=\"text\"\n                name=\"jumpChapter\"\n                id=\"jumpChapter\"\n                onBlur={(event) => {\n                  this.handleJumpChapter(event);\n                }}\n                defaultValue={this.state.currentChapterIndex}\n              />\n              <span>\n                / {this.props.currentEpub.rendition.book.spine.length}\n              </span>\n            </>\n          ) : null}\n        </p>\n        <div>\n          <input\n            className=\"input-progress\"\n            defaultValue={Math.round(this.state.displayPercentage * 100)}\n            type=\"range\"\n            max=\"100\"\n            min=\"0\"\n            step=\"1\"\n            onMouseUp={(event) => {\n              this.onProgressChange(event);\n            }}\n            onTouchEnd={(event) => {\n              this.onProgressChange(event);\n            }}\n            onChange={(event) => {\n              this.onProgressInput(event);\n            }}\n            style={{ width: 300, left: 50, top: 73 }}\n          />\n        </div>\n\n        <div\n          className=\"previous-chapter\"\n          onClick={() => {\n            this.previourChapter();\n          }}\n        >\n          <span className=\"icon-dropdown previous-chapter-icon\"> </span>\n        </div>\n        <div\n          className=\"next-chapter\"\n          onClick={() => {\n            this.nextChapter();\n          }}\n        >\n          <span className=\"icon-dropdown next-chapter-icon\"></span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ProgressPanel;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withNamespaces } from \"react-i18next\";\nimport ProgressPanel from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    percentage: state.progressPanel.percentage,\n    locations: state.progressPanel.locations,\n    flattenChapters: state.reader.flattenChapters,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(ProgressPanel as any));\n","import OtherUtil from \"./otherUtil\";\nlet Hammer = (window as any).Hammer;\n\nexport const MouseEvent = (rendition: any) => {\n  let isFirefox = navigator.userAgent.indexOf(\"Firefox\") !== -1;\n  let lock = false; // 暂时锁住翻页快捷键，避免快速点击产生的Bug\n  const arrowKeys = (event: any) => {\n    // event.preventDefault();\n    if (lock) return;\n    if (event.keyCode === 37 || event.keyCode === 38) {\n      rendition.prev();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n    if (event.keyCode === 39 || event.keyCode === 40) {\n      rendition.next();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n  };\n  const mouseFirefox = (event: any) => {\n    event.preventDefault();\n    if (lock) return;\n    if (event.detail < 0) {\n      rendition.prev();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n    if (event.detail > 0) {\n      rendition.next();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n  };\n\n  const mouseChrome = (event: any) => {\n    if (lock) return;\n    if (event.wheelDelta > 0) {\n      rendition.prev();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n    if (event.wheelDelta < 0) {\n      rendition.next();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n  };\n\n  const gesture = (event: any) => {\n    if (lock) return;\n    if (event.type === \"panleft\" || event.type === \"panup\") {\n      rendition.next();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n    if (event.type === \"panright\" || event.type === \"pandown\") {\n      rendition.prev();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    }\n  };\n  const bindEvent = (doc: any) => {\n    doc.addEventListener(\"keydown\", arrowKeys); // 箭头按键翻页\n    // 鼠标滚轮翻页\n    if (isFirefox) {\n      doc.addEventListener(\"DOMMouseScroll\", mouseFirefox, false);\n    } else {\n      doc.addEventListener(\"mousewheel\", mouseChrome, false);\n    }\n  };\n\n  rendition.on(\"rendered\", () => {\n    let iframe = document.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) {\n      return;\n    }\n    if (OtherUtil.getReaderConfig(\"isTouch\") === \"yes\") {\n      const mc = new Hammer(doc);\n      mc.on(\"panleft panright panup pandown\", (event: any) => {\n        gesture(event);\n      });\n    }\n\n    // 鼠标滚轮翻页\n    window.addEventListener(\"keydown\", arrowKeys);\n    bindEvent(doc);\n  });\n};\n","import React from \"react\";\nimport ViewArea from \"../viewArea\";\nimport Background from \"../background\";\nimport SettingPanel from \"../settingPanel\";\nimport NavigationPanel from \"../navigationPanel\";\nimport OperationPanel from \"../operationPanel\";\nimport MessageBox from \"../messageBox\";\nimport ProgressPanel from \"../progressPanel\";\nimport { ReaderProps, ReaderState } from \"./interface\";\nimport { MouseEvent } from \"../../utils/mouseEvent\";\nimport OtherUtil from \"../../utils/otherUtil\";\nimport ReadingTime from \"../../utils/readingTime\";\n\nclass Reader extends React.Component<ReaderProps, ReaderState> {\n  messageTimer!: NodeJS.Timeout;\n  tickTimer!: NodeJS.Timeout;\n  rendition: any;\n\n  constructor(props: ReaderProps) {\n    super(props);\n    this.state = {\n      isOpenSettingPanel: false,\n      isOpenOperationPanel: false,\n      isOpenProgressPanel: false,\n      isOpenNavPanel: false,\n      isMessage: false,\n      rendition: null,\n      scale: OtherUtil.getReaderConfig(\"scale\") || 1,\n      time: ReadingTime.getTime(this.props.currentBook.key),\n      isTouch: OtherUtil.getReaderConfig(\"isTouch\") === \"yes\",\n      readerMode: OtherUtil.getReaderConfig(\"readerMode\") || \"double\",\n    };\n  }\n  componentWillMount() {\n    this.props.handleFetchBookmarks();\n    this.props.handleFetchPercentage(this.props.currentBook);\n    this.props.handleFetchNotes();\n    this.props.handleFetchChapters(this.props.currentEpub);\n  }\n  UNSAFE_componentWillReceiveProps(nextProps: ReaderProps) {\n    this.setState({\n      isMessage: nextProps.isMessage,\n    });\n\n    //控制消息提示两秒之后消失\n    if (nextProps.isMessage) {\n      this.messageTimer = setTimeout(() => {\n        this.props.handleMessageBox(false);\n        this.setState({ isMessage: false });\n      }, 2000);\n    }\n  }\n  componentDidMount() {\n    let page = document.querySelector(\"#page-area\");\n    let epub = this.props.currentEpub;\n    (window as any).rangy.init(); // 初始化\n    this.rendition = epub.renderTo(page, {\n      manager:\n        this.state.readerMode === \"continuous\" ? \"continuous\" : \"default\",\n      flow:\n        this.state.readerMode === \"scroll\"\n          ? \"scrolled-doc\"\n          : this.state.readerMode === \"continuous\"\n          ? \"scrolled\"\n          : \"auto\",\n      width: \"100%\",\n      height: \"100%\",\n      snap: true,\n    });\n    this.setState({ rendition: this.rendition });\n    this.state.readerMode !== \"scroll\" &&\n      this.state.readerMode !== \"continuous\" &&\n      MouseEvent(this.rendition); // 绑定事件\n    this.tickTimer = setInterval(() => {\n      let time = this.state.time;\n      time += 1;\n      this.setState({ time });\n    }, 1000);\n  }\n\n  componentWillUnmount() {\n    //清除上面的计时器\n    clearTimeout(this.messageTimer);\n    setTimeout(() => {}, 5000);\n    clearInterval(this.tickTimer);\n    ReadingTime.setTime(this.props.currentBook.key, this.state.time);\n  }\n  //进入阅读器\n  handleEnterReader = (position: string) => {\n    //控制上下左右的菜单的显示\n    switch (position) {\n      case \"right\":\n        this.setState({\n          isOpenSettingPanel: this.state.isOpenSettingPanel ? false : true,\n        });\n        break;\n      case \"left\":\n        this.setState({\n          isOpenNavPanel: this.state.isOpenNavPanel ? false : true,\n        });\n        break;\n      case \"top\":\n        this.setState({\n          isOpenOperationPanel: this.state.isOpenOperationPanel ? false : true,\n        });\n        break;\n      case \"bottom\":\n        this.setState({\n          isOpenProgressPanel: this.state.isOpenProgressPanel ? false : true,\n        });\n        break;\n      default:\n        break;\n    }\n  };\n  //退出阅读器\n  handleLeaveReader = (position: string) => {\n    //控制上下左右的菜单的显示\n    switch (position) {\n      case \"right\":\n        this.setState({ isOpenSettingPanel: false });\n        break;\n      case \"left\":\n        this.setState({ isOpenNavPanel: false });\n        break;\n      case \"top\":\n        this.setState({ isOpenOperationPanel: false });\n        break;\n      case \"bottom\":\n        this.setState({ isOpenProgressPanel: false });\n        break;\n      default:\n        break;\n    }\n  };\n\n  render() {\n    const renditionProps = {\n      rendition: this.state.rendition,\n      handleLeaveReader: this.handleLeaveReader,\n      handleEnterReader: this.handleEnterReader,\n      isShow:\n        this.state.isOpenNavPanel ||\n        this.state.isOpenOperationPanel ||\n        this.state.isOpenProgressPanel ||\n        this.state.isOpenSettingPanel,\n    };\n    return (\n      <div className=\"viewer\">\n        {this.state.isMessage ? <MessageBox /> : null}\n        <div\n          className=\"left-panel\"\n          onMouseEnter={() => {\n            if (this.state.isTouch || this.state.isOpenNavPanel) {\n              return;\n            }\n            this.handleEnterReader(\"left\");\n          }}\n          onClick={() => {\n            this.handleEnterReader(\"left\");\n          }}\n        ></div>\n        <div\n          className=\"right-panel\"\n          onMouseEnter={() => {\n            if (this.state.isTouch || this.state.isOpenSettingPanel) {\n              return;\n            }\n            this.handleEnterReader(\"right\");\n          }}\n          onClick={() => {\n            this.handleEnterReader(\"right\");\n          }}\n        ></div>\n        <div\n          className=\"top-panel\"\n          onMouseEnter={() => {\n            if (this.state.isTouch || this.state.isOpenOperationPanel) {\n              return;\n            }\n            this.handleEnterReader(\"top\");\n          }}\n          onClick={() => {\n            this.handleEnterReader(\"top\");\n          }}\n        ></div>\n        <div\n          className=\"bottom-panel\"\n          onMouseEnter={() => {\n            if (this.state.isTouch || this.state.isOpenProgressPanel) {\n              return;\n            }\n            this.handleEnterReader(\"bottom\");\n          }}\n          onClick={() => {\n            this.handleEnterReader(\"bottom\");\n          }}\n        ></div>\n\n        {this.state.rendition && this.props.currentEpub.rendition && (\n          <ViewArea {...renditionProps} />\n        )}\n        <div\n          className=\"setting-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"right\");\n          }}\n          style={\n            this.state.isOpenSettingPanel\n              ? {}\n              : {\n                  transform: \"translateX(309px)\",\n                  // transition: \"transform 1s ease\",\n                  // display: \"none\",\n                }\n          }\n        >\n          <SettingPanel />\n        </div>\n        <div\n          className=\"navigation-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"left\");\n          }}\n          style={\n            this.state.isOpenNavPanel\n              ? {}\n              : {\n                  transform: \"translateX(-309px)\",\n                  // transition: \"transform 1s ease\",\n                  // display: \"none\",\n                }\n          }\n        >\n          <NavigationPanel {...{ time: this.state.time }} />\n        </div>\n        <div\n          className=\"progress-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"bottom\");\n          }}\n          style={\n            this.state.isOpenProgressPanel\n              ? {}\n              : {\n                  transform: \"translateY(110px)\",\n                  // transition: \"transform 0.5s ease\",\n                  // display: \"none\",\n                }\n          }\n        >\n          <ProgressPanel {...{ time: this.state.time }} />\n        </div>\n        <div\n          className=\"operation-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"top\");\n          }}\n          style={\n            this.state.isOpenOperationPanel\n              ? {}\n              : {\n                  transform: \"translateY(-110px)\",\n                  // transition: \"transform 0.5s ease\",\n                  // display: \"none\",\n                }\n          }\n        >\n          <OperationPanel {...{ time: this.state.time }} />\n        </div>\n\n        <div\n          className=\"view-area-page\"\n          id=\"page-area\"\n          style={\n            this.state.readerMode === \"scroll\" ||\n            this.state.readerMode === \"continuous\"\n              ? {\n                  left: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\n                  right: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\n                  top: \"75px\",\n                  bottom: \"75px\",\n                }\n              : this.state.readerMode === \"single\"\n              ? {\n                  left: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\n                  right: `calc(50vw - ${270 * parseFloat(this.state.scale)}px)`,\n                }\n              : {}\n          }\n        ></div>\n\n        <Background {...{ time: this.state.time }} />\n      </div>\n    );\n  }\n}\n\nexport default Reader;\n","import {\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchChapters,\n} from \"../../store/actions/reader\";\nimport { handleFetchPercentage } from \"../../store/actions/progressPanel\";\nimport { handleMessageBox } from \"../../store/actions/manager\";\nimport \"./reader.css\";\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport Reader from \"./component\";\nimport { withNamespaces } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentEpub: state.book.currentEpub,\n    currentBook: state.book.currentBook,\n    isMessage: state.manager.isMessage,\n  };\n};\nconst actionCreator = {\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchChapters,\n  handleMessageBox,\n  handleFetchPercentage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withNamespaces()(Reader as any));\n","//卡片模式下的图书显示\nimport React from \"react\";\nimport RecentBooks from \"../../utils/recordRecent\";\n// import \"./bookCardItem.css\";\nimport { EpubReaderProps, EpubReaderState } from \"./interface\";\nimport localforage from \"localforage\";\nimport Reader from \"../../containers/epubViewer\";\nimport { withRouter } from \"react-router-dom\";\nimport _ from \"underscore\";\n\ndeclare var window: any;\n\nclass EpubReader extends React.Component<EpubReaderProps, EpubReaderState> {\n  epub: any;\n  constructor(props: EpubReaderProps) {\n    super(props);\n    this.state = {};\n  }\n\n  componentWillMount() {\n    let url = document.location.href.split(\"/\");\n    let key = url[url.length - 1];\n    localforage.getItem(\"books\").then((result: any) => {\n      let book = result[_.findIndex(result, { key })];\n      localforage.getItem(key).then((result) => {\n        this.props.handleReadingBook(book);\n        this.props.handleReadingEpub(window.ePub(result, {}));\n        this.props.handleReadingState(true);\n        RecentBooks.setRecent(key);\n      });\n    });\n  }\n\n  render() {\n    if (!this.props.isReading) {\n      return (\n        <div className=\"spinner\">\n          <div className=\"sk-chase\">\n            <div className=\"sk-chase-dot\"></div>\n            <div className=\"sk-chase-dot\"></div>\n            <div className=\"sk-chase-dot\"></div>\n            <div className=\"sk-chase-dot\"></div>\n            <div className=\"sk-chase-dot\"></div>\n            <div className=\"sk-chase-dot\"></div>\n          </div>\n        </div>\n      );\n    }\n    return <Reader />;\n  }\n}\nexport default withRouter(EpubReader);\n","//卡片模式下的图书显示\nimport { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingState,\n  handleReadingBook,\n  handleReadingEpub,\n} from \"../../store/actions/book\";\nimport { handleMessageBox, handleMessage } from \"../../store/actions/manager\";\nimport Book from \"./component\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    currentBook: state.book.currentBook,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {\n  handleReadingState,\n  handleReadingBook,\n  handleReadingEpub,\n  handleActionDialog,\n  handleMessageBox,\n  handleMessage,\n};\nexport default connect(mapStateToProps, actionCreator)(Book);\n","export function getParamsFromUrl() {\n  var hashParams: any = {};\n  var e,\n    r = /([^&;=]+)=?([^&;]*)/g,\n    q =\n      window.location.hash.substring(2) ||\n      window.location.search.substring(1).split(\"#\")[0];\n\n  while ((e = r.exec(q))) {\n    hashParams[e[1]] = decodeURIComponent(e[2]);\n  }\n  return hashParams;\n}\n","import React from \"react\";\nimport \"./manager.css\";\nimport { RedirectProps, RedirectState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport { getParamsFromUrl } from \"../../utils/syncUtils/common\";\nimport copy from \"copy-text-to-clipboard\";\nimport { withRouter } from \"react-router-dom\";\nclass Redirect extends React.Component<RedirectProps, RedirectState> {\n  timer!: NodeJS.Timeout;\n  constructor(props: RedirectProps) {\n    super(props);\n    this.state = {\n      isAuthed: false,\n      isError: false,\n      isCopied: false,\n      token: \"\",\n    };\n  }\n\n  componentDidMount() {\n    //判断是否是获取token后的回调页面\n    let url = document.location.href;\n    if (document.location.hash === \"#/\") {\n      this.props.history.push(\"/manager/home\");\n    }\n    if (url.indexOf(\"error\") > -1) {\n      this.setState({ isError: true });\n      return false;\n    }\n    if (url.indexOf(\"code\") > -1) {\n      let params: any = getParamsFromUrl();\n      console.log(params, \"params\");\n      this.setState({ token: params.code });\n      this.setState({ isAuthed: true });\n      return false;\n    }\n    if (url.indexOf(\"access_token\") > -1) {\n      let params: any = getParamsFromUrl();\n      console.log(params, \"params\");\n      this.setState({ token: params.access_token });\n      this.setState({ isAuthed: true });\n      return false;\n    }\n  }\n\n  render() {\n    if (this.state.isError || this.state.isAuthed) {\n      return (\n        <div className=\"backup-page-finish-container\">\n          <div className=\"backup-page-finish\">\n            {this.state.isAuthed ? (\n              <span className=\"icon-message backup-page-finish-icon\"></span>\n            ) : (\n              <span className=\"icon-close auth-page-close-icon\"></span>\n            )}\n\n            <div className=\"backup-page-finish-text\">\n              <Trans>\n                {this.state.isAuthed\n                  ? \"Authorize Successfully\"\n                  : \"Authorize Failed\"}\n              </Trans>\n            </div>\n            {this.state.isAuthed ? (\n              <div\n                className=\"token-dialog-token-text\"\n                onClick={() => {\n                  copy(this.state.token);\n                  this.setState({ isCopied: true });\n                }}\n              >\n                {this.state.isCopied ? (\n                  <Trans>Copied</Trans>\n                ) : (\n                  <Trans>Copy Token</Trans>\n                )}\n              </div>\n            ) : null}\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"manager\">\n        <img\n          src={\n            process.env.NODE_ENV === \"production\"\n              ? \"./assets/logo.png\"\n              : \"../../assets/logo.png\"\n          }\n          alt=\"\"\n          className=\"logo\"\n        />\n        <div className=\"empty-page-info-container\" style={{ margin: 100 }}>\n          <div className=\"empty-page-info-main\">\n            <Trans>It seems like you're lost</Trans>\n          </div>\n          <div\n            className=\"empty-page-info-sub\"\n            onClick={() => {\n              this.props.history.push(\"/manager/home\");\n            }}\n            style={{ marginTop: 10, cursor: \"pointer\" }}\n          >\n            <Trans>Return to home</Trans>\n          </div>\n        </div>\n        <img\n          src={\n            process.env.NODE_ENV === \"production\"\n              ? \"./assets/empty.svg\"\n              : \"../../assets/empty.svg\"\n          }\n          alt=\"\"\n          className=\"empty-page-illustration\"\n        />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(Redirect);\n","import { connect } from \"react-redux\";\nimport \"./manager.css\";\nimport { stateType } from \"../../store\";\nimport Redirect from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = {};\nexport default connect(mapStateToProps, actionCreator)(Redirect);\n","import { hot } from \"react-hot-loader/root\";\nimport React from \"react\";\nimport { Route, Switch, HashRouter } from \"react-router-dom\";\nimport Manager from \"../pages/manager\";\nimport EpubReader from \"../pages/epubReader\";\nimport _Redirect from \"../pages/redirect\";\n\nconst Router = () => {\n  return (\n    <HashRouter>\n      <Switch>\n        <Route component={Manager} path=\"/manager\" />\n        <Route component={EpubReader} path=\"/epub\" />\n        <Route component={_Redirect} path=\"/\" />\n      </Switch>\n    </HashRouter>\n  );\n};\n\nexport default hot(Router);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n// import App from \"./App\";\nimport \"./assets/styles/reset.css\";\nimport \"./assets/styles/global.css\";\nimport \"./assets/styles/style.css\";\nimport { Provider } from \"react-redux\";\nimport \"./i18n\";\nimport store from \"./store\";\nimport Router from \"./router/index\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}