{"version":3,"sources":["webpack:///src/app/reader/reader.module.ts","webpack:///src/app/reader/settings/settings.component.ts","webpack:///src/app/reader/settings/settings.component.html","webpack:///src/app/library/book-cards/book-cards.component.html","webpack:///src/app/library/book-cards/book-cards.component.ts","webpack:///src/app/library/filters/filters.component.ts","webpack:///src/app/library/filters/filters.component.html","webpack:///src/app/models/Book.ts","webpack:///src/environments/environment.ts","webpack:///src/app/config/config.service.ts","webpack:///src/app/library/import-books/import-books.component.html","webpack:///src/app/library/import-books/import-books.component.ts","webpack:///src/app/reader/reader.component.ts","webpack:///src/app/reader/reader.component.html","webpack:///src/app/reader/toc/toc.component.ts","webpack:///src/app/reader/toc/toc.component.html","webpack:///src/app/reader/buttons/buttons.component.ts","webpack:///src/app/reader/buttons/buttons.component.html","webpack:///src/app/reader/reading-location.service.ts","webpack:///src/app/library/library.component.ts","webpack:///src/app/library/library.component.html","webpack:///src/app/message.service.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/library/services/library.service.ts","webpack:///src/app/app.module.ts","webpack:///src/app/reader/background/background.component.ts","webpack:///src/app/reader/background/background.component.html","webpack:///src/app/library/library-routing.module.ts","webpack:///src/app/reader/reader.service.ts","webpack:///src/app/reader/mouse.service.ts","webpack:///src/app/library/buttons/buttons.component.ts","webpack:///src/app/library/buttons/buttons.component.html","webpack:///src/app/reader/navigation/navigation.component.ts","webpack:///src/app/reader/navigation/navigation.component.html","webpack:///src/app/app-routing.module.ts","webpack:///src/app/library/library.module.ts","webpack:///src/app/models/ReadingProgress.ts","webpack:///src/app/reader/reader-routing.module.ts","webpack:///src/main.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["ReaderModule","declarations","imports","controls","SettingsComponent","configService","fb","dialogRef","data","themes","id","theme","pageModes","value","icon","fontFamilies","lineHeights","settings","group","pageMode","pageScale","fontFamily","fontSize","lineHeight","Object","keys","forEach","key","valueChanges","subscribe","console","log","setItem","close","selector","templateUrl","styleUrls","BookCardsComponent","router","msgService","libraryService","isFileOver","book","navigate","files","startSpinner","importedCount","droppedFile","fileEntry","isFile","file","importBookFile","length","stopSpinner","event","droped","fileOver","fileLeave","books","FiltersComponent","Book","name","author","description","md5","cover","environment","production","ConfigService","subject","localStorage","next","getItem","pipe","item","providedIn","ImportBooksComponent","status","uploadProgress","target","ratio","percent","ReaderComponent","route","rlService","readerService","mouseService","subscribesForSettings","readingProgress","snapshot","paramMap","get","getSettings","openBook","buildRenderOptions","read","unwatchSettings","options","manager","flow","width","height","snap","listen","setTheme","setTimeout","currentEpub","setFontSize","Number","setFontFamily","setLineHeight","subscription","unsubscribe","getReadingSettings","epub","renderOptions","fetchLocations","pageArea","document","getElementById","innerHTML","renderTo","watchEpub","bind","applySettings","rendition","display","getCfi","currentBook","cfi","on","touchCurrentChapter","currentLocation","start","locations","percentage","percentageFromCfi","recordCfi","iframe","getElementsByTagName","doc","contentDocument","watchSettings","cfiRange","contents","range","rect","getBoundingClientRect","TocComponent","toc","openedMenus","tocSubject","preventDefault","href","getAttribute","jump","ButtonsComponent","dialog","isFullscreen","e","open","autoFocus","position","top","left","panelClass","backdropClass","right","prev","goLibrary","openNavigation","toggleFullscreen","openSettings","previous","ReadingLocationService","bookKey","json","obj","JSON","parse","stringify","LibraryComponent","booksSubject","MessageService","snackBar","ngZone","spinnerSubject","msg","run","duration","horizontalPosition","verticalPosition","AppComponent","title","showSpinner","show","LibraryService","ePub","window","booksIsLoaded","loadBooks","concat","find","some","progressCallback","p","doIncrementalTest","Promise","resolve","reject","fileName","split","extension","blobSlice","File","prototype","slice","mozSlice","webkitSlice","chunkSize","chunks","Math","ceil","size","currentChunk","spark","fileReader","FileReader","onload","Error","appendBinary","result","loadNext","end","storeFileAndCreateBook","readAsBinaryString","call","message","bookExists","reader","readAsArrayBuffer","loaded","metadata","then","coverUrl","url","createBook","creator","Date","getTime","addBook","coverReader","fetch","r","blob","readAsDataURL","onloadend","err","AppModule","providers","bootstrap","BackgroundComponent","changeDetectorRef","backgroundColor","bookName","chapter","leftPage","rightPage","watchInfo","bookSubject","chapterSubject","detectChanges","leftPageSubject","rightPageSubject","documentElement","click","routes","path","component","LibraryRoutingModule","forChild","exports","ReaderService","flattenedToc","notes","bookmarks","getBook","fetchChapters","nextChapter","step","chapterIndex","index","section","navigation","chapters","flatChapter","displayed","page","chapterHref","chapterSbj","filter","label","trim","mode","color","scale","isUseFont","newChapter","subitems","push","MouseService","isScrollMode","isFirefox","navigator","userAgent","indexOf","lock","arrowKeys","keyCode","mouseFirefox","detail","mouseChrome","wheelDelta","bindEvent","addEventListener","unbindEvent","removeEventListener","hasBackdrop","maxWidth","maxHeight","openImportDialog","NavigationComponent","isSearch","currentTab","tab","AppRoutingModule","forRoot","LibraryModule","ReadingProgress","generate","ReaderRoutingModule","bootstrapModule","error","webpackEmptyAsyncContext","req","code","module"],"mappings":"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","file":"main-es5.js","sourcesContent":["import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { ReaderComponent } from './reader.component';\nimport { BackgroundComponent } from './background/background.component';\nimport { ButtonsComponent } from './buttons/buttons.component';\nimport { SettingsComponent } from './settings/settings.component';\nimport { NavigationComponent } from './navigation/navigation.component';\n\nimport { MatDialogModule } from '@angular/material/dialog';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatSliderModule } from '@angular/material/slider';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { TocComponent } from './toc/toc.component';\n\n@NgModule({\n  declarations: [ReaderComponent, BackgroundComponent, SettingsComponent, ButtonsComponent, NavigationComponent, TocComponent],\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    MatFormFieldModule,\n    MatIconModule,\n    MatButtonModule,\n    MatCheckboxModule,\n    MatInputModule,\n    MatDialogModule,\n    MatSliderModule,\n    MatRadioModule,\n    MatSelectModule\n  ]\n})\nexport class ReaderModule { }\n","import { Component, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { ConfigService } from 'src/app/config/config.service';\nimport { FormGroup, FormBuilder, FormControl } from '@angular/forms';\n\nexport interface SettingsDialogData {\n  theme: string; // background color\n  pageMode: string;\n  pageScale: number;\n  fontFamily: string;\n  fontSize: number;\n  lineHeight: number;\n};\n\ntype Controls = { [key: string]: FormControl };\n\n@Component({\n  selector: 'app-reader-settings',\n  templateUrl: './settings.component.html',\n  styleUrls: ['./settings.component.scss']\n})\nexport class SettingsComponent {\n  public themes = [\n    { id: 1, theme: 'rgba(235,255,231,1)' },\n    { id: 2, theme: 'rgba(244,232,211,0.4)' },\n    { id: 3, theme: 'rgba(242,219,187,0.8)' },\n    { id: 4, theme: 'rgba(255,254,252,1)' },\n    { id: 5, theme: 'rgba(44,47,49,1)' },\n  ];\n\n  public pageModes = [\n    { value: 'single', icon: 'icon-single-page' },\n    { value: 'double', icon: 'icon-two-page' },\n    { value: 'scroll', icon: 'icon-scroll1' },\n    { value: 'continuous', icon: 'icon-scroll' },\n  ];\n\n  public fontFamilies = [\n    'Helvetica',\n    'Times New Roman',\n    'Microsoft YaHei',\n    'SimSun',\n    'SimHei',\n    'Arial',\n  ];\n\n  public lineHeights = ['1', '1.25', '1.5', '1.75', '2'];\n\n  public settings: FormGroup;\n  public controls: Controls = {};\n\n  constructor(\n    private configService: ConfigService,\n    private fb: FormBuilder,\n    public dialogRef: MatDialogRef<SettingsComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: SettingsDialogData\n  ) {\n    this.settings = fb.group({\n      theme: new FormControl(data.theme),\n      pageMode: new FormControl(data.pageMode),\n      pageScale: new FormControl(data.pageScale),\n      fontFamily: new FormControl(data.fontFamily),\n      fontSize: new FormControl(data.fontSize),\n      lineHeight: new FormControl(data.lineHeight),\n    });\n\n    this.controls = this.settings.controls as Controls;\n\n\n    // this.settings.valueChanges.subscribe((value) => {\n    //   console.log('valueChanges ->', value);\n    // });\n\n    // this.theme.valueChanges.subscribe((value) => {\n    //   console.log('theme valueChanges ->', value);\n    // });\n\n    Object.keys(this.controls).forEach(key => {\n      this.controls[key].valueChanges.subscribe(value => {\n        console.log('value change', key, value);\n        this.configService.setItem(`reader.${key}`, value);\n      });\n    });\n\n  }\n\n  onNoClick(): void {\n    this.dialogRef.close();\n  }\n\n}\n","<div class=\"reader-settings\">\n  <h1 mat-dialog-title>阅读设置</h1>\n  <div mat-dialog-content>\n    <form [formGroup]=\"settings\" class=\"settings-form\">\n      <div class=\"settings-form-field\">\n        <mat-label>主题</mat-label>\n        <div class=\"fat-ratio-group\">\n          <button\n            class=\"fat-ratio\"\n            mat-mini-fab\n            *ngFor=\"let t of themes\"\n            (click)=\"controls.theme.setValue(t.theme)\"\n            [ngStyle]=\"{ 'background-color': t.theme, color: 'red' }\">\n            <mat-icon *ngIf=\"t.theme === controls.theme.value\">check</mat-icon>\n          </button>\n        </div>\n      </div>\n\n      <div class=\"settings-form-field\">\n        <mat-label>页面模式</mat-label>\n        <!-- <input matInput [formControl]=\"controls.pageMode\"> -->\n        <div class=\"fat-ratio-group\">\n          <button\n            class=\"fat-ratio\"\n            mat-mini-fab\n            *ngFor=\"let mode of pageModes\"\n            (click)=\"controls.pageMode.setValue(mode.value)\"\n            [ngStyle]=\"{ 'background-color': '#eeeeee33' }\">\n            <span [class]=\"mode.icon\" [ngStyle]=\"{ color: mode.value === controls.pageMode.value ? 'red' : '#aaa' }\"></span>\n          </button>\n        </div>\n      </div>\n\n      <div class=\"settings-form-field\">\n        <mat-label>缩放比例</mat-label>\n        <mat-slider\n          class=\"settings-slider\"\n          min=\"50\"\n          max=\"150\"\n          thumbLabel\n          tickInterval=\"10\"\n          [formControl]=\"controls.pageScale\"\n        ></mat-slider>\n      </div>\n\n      <mat-form-field>\n        <mat-label>字体</mat-label>\n        <mat-select [formControl]=\"controls.fontFamily\">\n          <mat-option *ngFor=\"let ff of fontFamilies\" [value]=\"ff\">\n            {{ff}}\n          </mat-option>\n        </mat-select>\n      </mat-form-field>\n\n      <div class=\"settings-form-field\">\n        <mat-label>字体大小</mat-label>\n        <mat-slider\n          class=\"settings-slider\"\n          min=\"13\"\n          max=\"32\"\n          thumbLabel\n          tickInterval=\"1\"\n          [formControl]=\"controls.fontSize\"\n        ></mat-slider>\n      </div>\n\n      <mat-form-field>\n        <mat-label>行高</mat-label>\n        <mat-select [formControl]=\"controls.lineHeight\">\n          <mat-option *ngFor=\"let lh of lineHeights\" [value]=\"lh\">\n            {{lh}}\n          </mat-option>\n        </mat-select>\n      </mat-form-field>\n\n    </form>\n  </div>\n  <div mat-dialog-actions>\n    <!-- <button mat-button (click)=\"onNoClick()\">No Thanks</button>\n    <button mat-button [mat-dialog-close]=\"settings.value\" cdkFocusInitial>Ok</button> -->\n  </div>\n</div>\n","<div class=\"book-cards\">\n  <ngx-file-drop\n    dropZoneLabel=\"Drop files here\"\n    dropZoneClassName=\"book-cords-drop-zone-class\"\n    contentClassName=\"book-cords-drop-zone-content-class\"\n    (onFileDrop)=\"droped($event)\"\n    (onFileOver)=\"fileOver($event)\"\n    (onFileLeave)=\"fileLeave($event)\"\n    accept=\".epub\"\n  >\n  <ng-template ngx-file-drop-content-tmp let-openFileSelector=\"openFileSelector\">\n    <div class=\"book-card-grid\">\n      <div class=\"book-card\" *ngFor=\"let book of books\">\n        <div class=\"book-card-cover\">\n          <img\n            class=\"book-card-cover-img\"\n            [src]=\"book.cover !== 'noCover' ? book.cover : 'assets/cover.svg'\"\n            alt=\"\"\n            (click)=\"openBook(book)\"\n          />\n          <p class=\"book-card-cover-title\" *ngIf=\"book.cover === 'noCover'\"><span>{{book.name}}</span></p>\n        </div>\n        <div class=\"book-card-title\"><span>{{book.name}}</span></div>\n      </div>\n    </div>\n    <div *ngIf=\"isFileOver\" class=\"drop-over-info\">Release to Add books to Library</div>\n  </ng-template>\n  </ngx-file-drop>\n</div>\n","import { Component, Input, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { FileSystemFileEntry, NgxFileDropEntry } from 'ngx-file-drop';\nimport { Book } from 'src/app/models/Book';\nimport { LibraryService } from '../services/library.service';\nimport { MessageService } from 'src/app/message.service';\n\n@Component({\n  selector: 'app-lib-book-cards',\n  templateUrl: './book-cards.component.html',\n  styleUrls: ['./book-cards.component.scss']\n})\nexport class BookCardsComponent implements OnInit {\n  @Input() public books: Book[];\n\n  public isFileOver = false;\n\n  constructor(\n    private router: Router,\n    private msgService: MessageService,\n    private libraryService: LibraryService\n  ) { }\n\n  ngOnInit(): void {\n  }\n\n  openBook(book: Book) {\n    this.router.navigate(['/reader', book.key]);\n  }\n\n  public droped(files: NgxFileDropEntry[]) {\n    console.log(files);\n    this.isFileOver = false;\n    this.msgService.startSpinner();\n\n    let importedCount = 1;\n    for (const droppedFile of files) {\n      // Is it a file?\n      if (droppedFile.fileEntry.isFile) {\n        const fileEntry = droppedFile.fileEntry as FileSystemFileEntry;\n        fileEntry.file(async (file: File) => {\n          // Here you can access the real file\n          // console.log(droppedFile.relativePath, file);\n          await this.libraryService.importBookFile(file);\n          importedCount += 1;\n          if (importedCount >= files.length) {\n            this.msgService.stopSpinner();\n          }\n        });\n      } else {\n        // It was a directory (empty directories are added, otherwise only files)\n        // const fileEntry = droppedFile.fileEntry as FileSystemDirectoryEntry;\n        // console.log(droppedFile.relativePath, fileEntry);\n      }\n    }\n  }\n\n  public fileOver(event) {\n    console.log('over', event);\n    this.isFileOver = true;\n  }\n\n  public fileLeave(event) {\n    console.log('leave', event);\n    this.isFileOver = false;\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-lib-filters',\n  templateUrl: './filters.component.html',\n  styleUrls: ['./filters.component.scss']\n})\nexport class FiltersComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"lib-filters\">\n  <div class=\"lib-filters-group\">\n    <div class=\"lib-filters-subtitle\">\n      Library\n    </div>\n    <div class=\"lib-filters-item active\">\n      <mat-icon>local_library</mat-icon>\n      All books\n    </div>\n    <div class=\"lib-filters-item\">\n      <mat-icon>favorite</mat-icon>\n      Favorites\n    </div>\n  </div>\n</div>\n","export class Book {\n  key: string;\n  name: string;\n  author: string;\n  description: string;\n  md5: string;\n  cover: string;\n  constructor(\n    key: string,\n    name: string,\n    author: string,\n    description: string,\n    md5: string,\n    cover: string\n  ) {\n    this.key = key; // 数据库的键\n    this.name = name; // 书籍名\n    this.author = author; // 作者\n    this.description = description; // 书籍的描述\n    this.md5 = md5; // epub的md5值，防止重复导入\n    this.cover = cover;\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { Injectable } from '@angular/core';\nimport { Observable, BehaviorSubject } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\n// import * as localforage from 'localforage';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ConfigService {\n\n  private subject = new BehaviorSubject<[string, any]>(['', null]);\n\n  constructor() { }\n\n  save() {}\n\n  load() {}\n\n  setItem(key: string, value: any) {\n    localStorage.setItem(key, value);\n    this.subject.next([key, value]);\n  }\n\n  getItem(key: string) {\n    return localStorage.getItem(key);\n  }\n\n  listen<T>(key: string): Observable<T> {\n    return this.subject\n      .pipe(\n        filter(item => item[0] === key),\n        map(item => item[1])\n      );\n  }\n\n  getReadingSettings() {\n    return {\n      theme: this.getItem('reader.theme'),\n      pageMode: this.getItem('reader.pageMode'),\n      pageScale: this.getItem('reader.pageScale'),\n      fontFamily: this.getItem('reader.fontFamily'),\n      fontSize: this.getItem('reader.fontSize'),\n      lineHeight: this.getItem('reader.lineHeight'),\n    };\n  }\n}\n","<h1 mat-dialog-title>Select Files</h1>\n<div mat-dialog-content [ngClass]=\"isFileOver ? 'file-over' : ''\">\n  <ngx-file-drop\n    dropZoneLabel=\"Drop files here\"\n    dropZoneClassName=\"import-books-drop-zone-class\"\n    contentClassName=\"import-books-drop-zone-content-class\"\n    (onFileDrop)=\"droped($event)\"\n    (onFileOver)=\"fileOver()\"\n    (onFileLeave)=\"fileLeave()\"\n    accept=\".epub\"\n  >\n  <ng-template ngx-file-drop-content-tmp let-openFileSelector=\"openFileSelector\">\n    <!-- <div *ngIf=\"isFileOver\" class=\"drop-over-info\">Release to Add books to Library</div> -->\n    <div *ngIf=\"status === 'waiting'\" class=\"hint-and-actions\">\n      <h1>Drag epub files here</h1>\n      <p>or you can selec files...</p>\n      <button mat-flat-button color=\"accent\">\n        Select files on your device\n        <input class=\"hidden-file-input\" type=\"file\" (change)=\"importBookFromLocal($event)\"/>\n      </button>\n    </div>\n\n    <div *ngIf=\"status === 'uploading'\" class=\"uploading\">\n      <div>Uplading...</div>\n      <mat-progress-bar mode=\"determinate\" [value]=\"uploadProgress\"></mat-progress-bar>\n    </div>\n\n    <div *ngIf=\"status === 'ready'\" class=\"ready\">\n      Ready\n    </div>\n  </ng-template>\n  </ngx-file-drop>\n</div>\n<div mat-dialog-actions>\n  <!-- <button mat-flat-button color=\"accent\" [mat-dialog-close]=\"data\" cdkFocusInitial>Ok</button> -->\n  <button mat-flat-button mat-dialog-close>Cancel</button>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { FileSystemFileEntry, NgxFileDropEntry } from 'ngx-file-drop';\nimport { LibraryService } from '../services/library.service';\n\n@Component({\n  selector: 'app-import-books',\n  templateUrl: './import-books.component.html',\n  styleUrls: ['./import-books.component.scss']\n})\nexport class ImportBooksComponent implements OnInit {\n  public data = {};\n  public isFileOver = false;\n  public status: 'waiting'|'uploading'|'ready' = 'waiting';\n  public uploadProgress = 0;\n\n  constructor(\n    private libraryService: LibraryService,\n    public dialogRef: MatDialogRef<ImportBooksComponent>\n  ) { }\n\n  ngOnInit(): void {}\n\n  async importBookFromLocal(event) {\n    const file = event.target.files[0]\n    await this.libraryService.importBookFile(file);\n  }\n\n  public droped(files: NgxFileDropEntry[]) {\n    this.isFileOver = false;\n    this.status = 'uploading';\n    this.uploadProgress = 0;\n\n    let importedCount = 1;\n    const ratio = 1 / files.length;\n    for (const droppedFile of files) {\n      // Is it a file?\n      if (droppedFile.fileEntry.isFile) {\n        const fileEntry = droppedFile.fileEntry as FileSystemFileEntry;\n        fileEntry.file(async (file: File) => {\n          // Here you can access the real file\n          // console.log(droppedFile.relativePath, file);\n          await this.libraryService.importBookFile(file, (percent: number) => {\n            this.uploadProgress = importedCount * ratio + percent / 100 * ratio;\n          });\n          importedCount += 1;\n          if (importedCount >= files.length) {\n            this.status = 'ready';\n            this.close();\n          }\n        });\n      } else {\n        // It was a directory (empty directories are added, otherwise only files)\n        // const fileEntry = droppedFile.fileEntry as FileSystemDirectoryEntry;\n        // console.log(droppedFile.relativePath, fileEntry);\n      }\n    }\n  }\n\n  fileOver() {\n    this.isFileOver = true;\n  }\n\n  fileLeave() {\n    this.isFileOver = false;\n  }\n\n  close() {\n    this.dialogRef.close();\n  }\n}\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ReaderService } from './reader.service';\nimport { ConfigService } from '../config/config.service';\nimport { ReadingLocationService } from './reading-location.service';\nimport { ReadingProgress } from '../models/ReadingProgress';\nimport { MouseService } from './mouse.service';\nimport { ActivatedRoute } from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { MessageService } from '../message.service';\n\n@Component({\n  selector: 'app-reader',\n  templateUrl: './reader.component.html',\n  styleUrls: ['./reader.component.scss'],\n})\nexport class ReaderComponent implements OnInit, OnDestroy {\n  private subscribesForSettings: Subscription[] = [];\n  private pageMode = 'continuous';\n\n  private readingProgress = new ReadingProgress();\n\n  get isSingleMode() {\n    return this.pageMode !== 'double';\n  }\n\n  constructor(\n    private route: ActivatedRoute,\n    private msgService: MessageService,\n    private rlService: ReadingLocationService,\n    private readerService: ReaderService,\n    private configService: ConfigService,\n    private mouseService: MouseService,\n    ) {}\n\n  async ngOnInit() {\n    const key = this.route.snapshot.paramMap.get('key');\n\n    // this.msgService.startSpinner();\n    const settings = this.getSettings();\n\n    this.read(await this.readerService.openBook(key), this.buildRenderOptions(settings.pageMode), settings);\n  }\n\n  ngOnDestroy() {\n    // 记得，watch settings 变化，避免 read 生成多个 [epub文档dom: 即 .epub-container].\n    this.unwatchSettings();\n  }\n\n  buildRenderOptions(pageMode: string) {\n    const options = {\n      manager:\n        pageMode === 'continuous' ? 'continuous' : 'default',\n      flow:\n        pageMode === 'scroll'\n          ? 'scrolled-doc'\n          : pageMode === 'continuous'\n          ? 'scrolled'\n          : 'auto',\n      width: '100%',\n      height: '100%',\n      snap: true,\n    };\n\n    // console.log('pageMode', this.pageMode);\n    // console.log('isSingleMode', this.isSingleMode);\n    // console.log('options', options);\n\n    return options;\n  }\n\n  /**\n   * 监听阅读设置的变化，同步设置到阅读界面\n   */\n  watchSettings() {\n    // 去掉之前的监听，避免重复\n    this.unwatchSettings();\n\n    this.subscribesForSettings = [\n      this.configService.listen('reader.theme').subscribe((theme: string) => {\n        this.readerService.setTheme(theme);\n      }),\n\n      this.configService.listen('reader.pageMode').subscribe(async (pageMode: string) => {\n        if (this.pageMode === pageMode) {\n          return;\n        }\n\n        this.pageMode = pageMode;\n        setTimeout(async () => {\n          // 书籍内容页面模式变更时，需要重新渲染内容，且使用 setTimeout, 将渲染人物排到\"浏览器重排\"之后\n          // 书籍内容页面模式变化后，书籍内容页面尺寸发生变化，会引起浏览器重排和重绘\n          this.read(this.readerService.currentEpub, this.buildRenderOptions(pageMode), this.getSettings());\n        }, 0);\n      }),\n\n      this.configService.listen('reader.fontSize').subscribe((fontSize: string) => {\n        this.readerService.setFontSize(Number(fontSize));\n      }),\n      this.configService.listen('reader.fontFamily').subscribe((fontFamily: string) => {\n        this.readerService.setFontFamily(fontFamily);\n      }),\n      this.configService.listen('reader.lineHeight').subscribe((lineHeight: string) => {\n        this.readerService.setLineHeight(Number(lineHeight));\n      }),\n    ];\n  }\n\n  unwatchSettings() {\n    this.subscribesForSettings.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n  public getSettings() {\n    const settings = this.configService.getReadingSettings();\n    this.pageMode = settings.pageMode as string;\n    return settings;\n  }\n\n  read(epub, renderOptions, settings) {\n    this.msgService.startSpinner();\n    this.readingProgress.fetchLocations(epub);\n\n    const pageArea = document.getElementById('page-area');\n    // 删除原来的渲染结果，避免渲染多个\n    pageArea.innerHTML = '';\n\n    epub.renderTo('page-area', renderOptions);\n\n    // 监听 epub 事件\n    this.watchEpub(epub, settings);\n\n    // 注册鼠标事件\n    this.mouseService.bind(epub, !(settings.pageMode === 'single' || settings.pageMode === 'double'));\n\n    // 设置 阅读设置\n    this.readerService.applySettings(epub, settings);\n\n    // 根据记录的阅读位置显示\n    epub.rendition.display(\n      this.rlService.getCfi(this.readerService.currentBook.key) === null\n        ? null\n        : this.rlService.getCfi(this.readerService.currentBook.key).cfi\n    );\n  }\n\n  watchEpub(epub, settings) {\n    // (window as any).rangy.init(); // 初始化\n    epub.rendition.on('locationChanged', () => {\n      this.readerService.touchCurrentChapter(epub);\n      // this.props.handleReadingEpub(epub);\n      // this.props.handleOpenMenu(false);\n      const currentLocation = epub.rendition.currentLocation();\n      const cfi = currentLocation.start.cfi;\n      // this.props.handleShowBookmark(\n      //   this.props.bookmarks &&\n      //     this.props.bookmarks.filter(\n      //       (item: BookmarkModel) => item.cfi === cfi\n      //     )[0]\n      //     ? true\n      //     : false\n      // );\n      if (this.readingProgress.locations) {\n        const percentage = this.readingProgress.locations.percentageFromCfi(cfi);\n        this.rlService.recordCfi(this.readerService.currentBook.key, cfi, percentage);\n        this.readingProgress.percentage = percentage;\n      }\n    });\n    epub.rendition.on('rendered', () => {\n      // this.setState({ loading: false });\n      const iframe = document.getElementsByTagName('iframe')[0];\n      if (!iframe) {\n        return;\n      }\n      const doc = iframe.contentDocument;\n      if (!doc) {\n        return;\n      }\n\n      // 要在第一 read 只后再监听 settings, 避免两次“几乎同时” read,\n      // 造成在 [epub 渲染 dom: 即 #page-area] 上生成两个 [epub文档dom: 即 .epub-container].\n      this.watchSettings();\n      // ReaderConfig.addDefaultCss();\n\n      this.msgService.stopSpinner();\n    });\n    epub.rendition.on('selected', (cfiRange: any, contents: any) => {\n      const range = contents.range(cfiRange);\n      const rect = range.getBoundingClientRect();\n      // this.setState({ cfiRange, contents, rect });\n    });\n  }\n\n}\n","<div class=\"viewer\">\n  <div id=\"page-area\" class=\"view-page-area\" [ngClass]=\"isSingleMode ? 'single' : ''\"></div>\n  <app-reader-background></app-reader-background>\n  <app-reader-buttons></app-reader-buttons>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { ReaderService } from '../reader.service';\n\n@Component({\n  selector: 'app-reader-toc',\n  templateUrl: './toc.component.html',\n  styleUrls: ['./toc.component.scss']\n})\nexport class TocComponent implements OnInit {\n  public toc = null;\n  public openedMenus = {};\n\n  constructor(private readerService: ReaderService) { }\n\n  ngOnInit(): void {\n    this.readerService.tocSubject.subscribe((toc) => {\n      this.toc = toc;\n    });\n  }\n\n  jump(event: any) {\n    event.preventDefault();\n    const href = event.target.getAttribute('href');\n    this.readerService.jump(href);\n  }\n\n  toggleSubtree(href: string) {\n    this.openedMenus[href] = !this.openedMenus[href];\n  }\n\n}\n","<!-- see: https://www.bennadel.com/blog/3512-playing-with-recursive-ng-template-references-in-angular-6-1-10.htm -->\n\n<ng-template #listTemplateRef let-list let-index=\"index\">\n<ul class=\"book-content\">\n    <li class=\"book-content-list\" *ngFor=\"let item of list\">\n      <span class=\"content-dropdown\" *ngIf=\"item.subitems.length > 0\">\n        <mat-icon (click)=\"toggleSubtree(item.href)\">navigate_next</mat-icon>\n      </span>\n      <a [href]=\"item.href\" (click)=\"jump($event)\" class=\"book-content-name\">{{item.label}}</a>\n      <div *ngIf=\"item.subitems.length > 0 && openedMenus[item.href]\">\n        <ng-template\n          [ngTemplateOutlet]=\"listTemplateRef\"\n          [ngTemplateOutletContext]=\"{ $implicit: item.subitems }\"\n        ></ng-template>\n      </div>\n    </li>\n  </ul>\n</ng-template>\n\n<div class=\"book-content-container\">\n  <ng-template\n    [ngTemplateOutlet]=\"listTemplateRef\"\n    [ngTemplateOutletContext]=\"{ $implicit: toc }\"\n  ></ng-template>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\nimport * as screenfull from 'screenfull';\nimport { ConfigService } from 'src/app/config/config.service';\nimport { NavigationComponent } from '../navigation/navigation.component';\nimport { ReaderService } from '../reader.service';\nimport { SettingsComponent } from '../settings/settings.component';\n\n@Component({\n  selector: 'app-reader-buttons',\n  templateUrl: './buttons.component.html',\n  styleUrls: ['./buttons.component.scss']\n})\nexport class ButtonsComponent implements OnInit {\n  public isFullscreen = false;\n\n  constructor(\n    private router: Router,\n    public dialog: MatDialog,\n    private configService: ConfigService,\n    private readerService: ReaderService,\n  ) {\n    (screenfull as screenfull.Screenfull).on('change', (e) => {\n      this.isFullscreen = (screenfull as screenfull.Screenfull).isFullscreen;\n    });\n  }\n\n  ngOnInit(): void {}\n\n  openNavigation() {\n    this.dialog.open(NavigationComponent, {\n      autoFocus: false,\n      position: {\n        top: '40px',\n        left: '20px'\n      },\n      panelClass: ['reading-navigation-dialog-panel'],\n      backdropClass: 'reading-navigation-dialog-backdrop', // disable default backgroup styles\n      width: '340px',\n      height: 'calc(100vh - 60px)',\n      data: {}\n    });\n  }\n\n  async openSettings() {\n    this.dialog.open(SettingsComponent, {\n      autoFocus: false,\n      position: {\n        top: '40px',\n        right: '20px',\n      },\n      panelClass: ['reading-settings-dialog-panel'],\n      backdropClass: 'reading-settings-dialog-backdrop', // disable default backgroup styles\n      width: '300px',\n      data: {\n        theme: this.configService.getItem('reader.theme'),\n        pageMode: this.configService.getItem('reader.pageMode'),\n        pageScale: this.configService.getItem('reader.pageScale'),\n        fontFamily: this.configService.getItem('reader.fontFamily'),\n        fontSize: this.configService.getItem('reader.fontSize'),\n        lineHeight: this.configService.getItem('reader.lineHeight'),\n      }\n    });\n  }\n\n  goLibrary() {\n    this.router.navigate(['/']);\n  }\n\n  toggleFullscreen() {\n    (screenfull as screenfull.Screenfull).toggle();\n  }\n\n  previous() {\n    this.readerService.prev(this.configService.getItem('reader.pageMode') as string);\n  }\n\n  next() {\n    this.readerService.next(this.configService.getItem('reader.pageMode') as string);\n  }\n\n}\n","<div class=\"reader-buttons\">\n  <div class=\"buttons-top-left\">\n    <button mat-icon-button (click)=\"goLibrary()\">\n      <mat-icon>local_library</mat-icon>\n    </button>\n    <button mat-icon-button (click)=\"openNavigation()\">\n      <mat-icon>toc</mat-icon>\n    </button>\n    <button mat-icon-button (click)=\"openNavigation()\">\n      <mat-icon>notes</mat-icon>\n    </button>\n  </div>\n\n  <div class=\"buttons-top-right\">\n    <button mat-icon-button (click)=\"toggleFullscreen()\">\n      <mat-icon>{{isFullscreen ? 'fullscreen_exit' : 'fullscreen'}}</mat-icon>\n    </button>\n    <button mat-icon-button (click)=\"openSettings()\">\n      <mat-icon>settings</mat-icon>\n    </button>\n  </div>\n\n  <div class=\"buttons-next-previous\">\n    <button mat-fab (click)=\"previous()\" class=\"button-previous\">\n      <mat-icon>navigate_before</mat-icon>\n    </button>\n    <button mat-fab (click)=\"next()\" class=\"button-next\">\n      <mat-icon>navigate_next</mat-icon>\n    </button>\n  </div>\n</div>\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ReadingLocationService {\n\n  constructor() { }\n\n  public recordCfi(bookKey: string, cfi: string, percentage: number) {\n    const json = localStorage.getItem('readingLocation');\n    const obj = JSON.parse(json!) || {};\n    obj[bookKey] = { cfi, percentage };\n    localStorage.setItem('readingLocation', JSON.stringify(obj));\n  }\n\n  public getCfi(bookKey: string) {\n    const json = localStorage.getItem('readingLocation');\n    const obj = JSON.parse(json!) || {};\n    return obj[bookKey] || {};\n  }\n\n  public clear(bookKey: string) {\n    const json = localStorage.getItem('readingLocation');\n    const obj = JSON.parse(json!) || {};\n    delete obj[bookKey];\n    localStorage.setItem('readingLocation', JSON.stringify(obj));\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Book } from '../models/Book';\nimport { LibraryService } from './services/library.service';\nimport { ReaderService } from '../reader/reader.service';\n\n@Component({\n  selector: 'app-library',\n  templateUrl: './library.component.html',\n  styleUrls: ['./library.component.scss']\n})\nexport class LibraryComponent implements OnInit {\n  public books: Book[] = [];\n\n  constructor(\n    private libraryService: LibraryService,\n  ) {\n    this.libraryService.booksSubject.subscribe(books => {\n      this.books = books;\n      console.log('books', books);\n    });\n  }\n\n  ngOnInit(): void {\n  }\n\n}\n","<div class=\"library\">\n  <app-lib-book-cards [books]=\"books\"></app-lib-book-cards>\n  <app-lib-buttons></app-lib-buttons>\n  <app-lib-filters></app-lib-filters>\n</div>\n","import { Injectable, ChangeDetectorRef, NgZone } from '@angular/core';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MessageService {\n\n  spinnerSubject = new BehaviorSubject(false);\n\n  constructor(private snackBar: MatSnackBar, private ngZone: NgZone) { }\n\n  message(msg: string) {\n    console.log('MSG::', msg);\n    this.ngZone.run(() => {\n      this.snackBar.open(msg, '', {\n        duration: 500,\n        horizontalPosition: 'right',\n        verticalPosition: 'bottom'\n      });\n    });\n  }\n\n  startSpinner(msg?: string) {\n    console.log('START SPINNER::', msg);\n    this.spinnerSubject.next(true);\n  }\n\n  stopSpinner() {\n    console.log('STOP SPINNER::');\n    this.ngZone.run(() => {\n      this.spinnerSubject.next(false);\n    });\n  }\n}\n","import { Component } from '@angular/core';\nimport { MessageService } from './message.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n  title = 'immerse';\n  showSpinner = false;\n\n  constructor(private msgService: MessageService) {\n    this.msgService.spinnerSubject.subscribe(show => {\n      this.showSpinner = show;\n    });\n  }\n}\n","<router-outlet></router-outlet>\n<div class=\"app-spinner\" *ngIf=\"showSpinner\">\n  <mat-spinner strokeWidth=\"2\"></mat-spinner>\n</div>\n","import { Injectable } from '@angular/core';\nimport * as localforage from 'localforage';\nimport { BehaviorSubject } from 'rxjs';\nimport * as SparkMD5 from 'spark-md5';\nimport { MessageService } from 'src/app/message.service';\nimport { Book } from 'src/app/models/Book';\nimport { skip } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LibraryService {\n  private ePub = (window as any).ePub;\n\n  private booksIsLoaded = false;\n  private books: Book[] = [];\n  public booksSubject = new BehaviorSubject([]);\n\n  constructor(\n    private msgService: MessageService\n  ) {\n    this.loadBooks();\n  }\n\n  public addBook(book: Book) {\n    this.books = (this.books || []).concat([book]);\n    this.booksSubject.next(this.books);\n    localforage.setItem('books', this.books);\n  }\n\n  public getBooks() {\n    return this.books;\n  }\n\n  public async getBook(key: string) {\n    if (this.booksIsLoaded) {\n      return this.books.find(book => book.key === key);\n    } else {\n      const books = await this.loadBooks() || [];\n      return books.find(book => book.key === key);\n    }\n  }\n\n  public bookExists(md5: string|Book): boolean {\n    if (typeof md5 !== 'string') {\n      md5 = (md5 as Book).md5;\n    }\n    return this.books.some(book => book.md5 === md5);\n  }\n\n  public async loadBooks() {\n    this.msgService.startSpinner();\n    this.books = await localforage.getItem('books') || [];\n    this.booksSubject.next(this.books);\n    this.booksIsLoaded = true;\n    this.msgService.stopSpinner();\n    return this.books;\n  }\n\n  public async importBookFile(file: File, progressCallback: (percent: number) => void = (p) => {}): Promise<[any, Book]> {\n    return await this.doIncrementalTest(file, progressCallback);\n  }\n\n  // 获取书籍md5\n  private doIncrementalTest(file: any, progressCallback: (percent: number) => void): Promise<[any, Book]> {\n    return new Promise((resolve, reject) => {\n      // 这里假设直接将文件选择框的dom引用传入\n      // 这里需要用到File的slice( )方法，以下是兼容写法\n      const fileName = file.name.split('.');\n      const extension = fileName[fileName.length - 1];\n      if (extension === 'epub') {\n        const blobSlice =\n            (File as any).prototype.slice ||\n            (File as any).prototype.mozSlice ||\n            (File as any).prototype.webkitSlice;\n\n        const chunkSize = 2097152; // 以每片2MB大小来逐次读取\n        const chunks = Math.ceil(file.size / chunkSize);\n        let currentChunk = 0;\n        const spark = new SparkMD5(); // 创建SparkMD5的实例\n        const fileReader = new FileReader();\n\n        fileReader.onload = async (e) => {\n          if (!e.target) {\n            reject();\n            throw new Error();\n          }\n          spark.appendBinary((e.target as any).result as any); // append array buffer\n          currentChunk += 1;\n          if (currentChunk < chunks) {\n            progressCallback(currentChunk / chunks);\n            loadNext();\n          } else {\n            const md5 = spark.end(); // 完成计算，返回结果\n            progressCallback(100);\n            resolve(await this.storeFileAndCreateBook(file, md5));\n          }\n        };\n\n        const loadNext = () => {\n          const start = currentChunk * chunkSize;\n          const end = start + chunkSize >= file.size ? file.size : start + chunkSize;\n\n          fileReader.readAsBinaryString(blobSlice.call(file, start, end));\n        };\n\n        loadNext();\n      } else {\n        this.msgService.message('Import Failed: not epub file');\n        reject();\n      }\n    });\n  }\n\n  private storeFileAndCreateBook(file: any, md5: string): Promise<[any, Book]> {\n    return new Promise((resolve, reject) => {\n      // md5 重复不导入\n      if (this.bookExists(md5)) {\n        this.msgService.message('Duplicate Book');\n        return resolve([null, null]);\n      }\n      // 解析图书，获取图书数据\n      const reader = new FileReader();\n      reader.readAsArrayBuffer(file);\n      reader.onload = (e) => {\n        if (!e.target) {\n          this.msgService.message('Import Failed');\n          reject();\n          throw new Error();\n        }\n        const epub = this.ePub((e.target as any).result);\n        epub.loaded.metadata\n          .then((metadata: any) => {\n            if (!e.target) {\n              this.msgService.message('Import Failed: no metadata');\n              reject();\n              throw new Error();\n            }\n\n            epub\n              .coverUrl()\n              .then(async (url: string) => {\n                const createBook = async (cover: string) => {\n                  const [name, author, description] = [\n                    metadata.title,\n                    metadata.creator,\n                    metadata.description,\n                  ];\n                  const key = new Date().getTime() + '';\n                  const book = new Book(\n                    key,\n                    name,\n                    author,\n                    description,\n                    md5,\n                    cover\n                  );\n                  // await this.handleAddBook(book);\n                  this.addBook(book);\n\n                  localforage.setItem(key, (e.target as any).result);\n                  resolve([epub, book]);\n                };\n\n                if (url) {\n                  const coverReader = new FileReader();\n                  const blob = await fetch(url).then((r) => r.blob());\n                  coverReader.readAsDataURL(blob);\n                  console.log(url, 'url');\n                  coverReader.onloadend = async () => {\n                    await createBook(coverReader.result as string);\n                  };\n                } else {\n                  await createBook('noCover');\n                }\n\n              })\n              .catch((err: any) => {\n                console.log(err, 'err');\n                reject();\n              });\n          })\n          .catch(() => {\n            this.msgService.message('Import Failed');\n            // this.props.handleMessageBox(true);\n            reject();\n          });\n      };\n\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { LibraryModule } from './library/library.module';\nimport { ReaderModule } from './reader/reader.module';\n\n\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    BrowserModule,\n    BrowserAnimationsModule,\n    AppRoutingModule,\n    MatSnackBarModule,\n    MatProgressSpinnerModule,\n    LibraryModule,\n    ReaderModule,\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { ConfigService } from 'src/app/config/config.service';\nimport { ReaderService } from '../reader.service';\n\n@Component({\n  selector: 'app-reader-background',\n  templateUrl: './background.component.html',\n  styleUrls: ['./background.component.scss']\n})\nexport class BackgroundComponent implements OnInit {\n  public backgroundColor = '';\n\n  public bookName = '';\n  public chapter = '';\n  public leftPage = '';\n  public rightPage = '';\n\n  private pageMode: string;\n  public get isSingleMode() {\n    return this.pageMode !== 'double';\n  }\n\n  constructor(\n    private configService: ConfigService,\n    private readerService: ReaderService,\n    private changeDetectorRef: ChangeDetectorRef\n  ) { }\n\n  ngOnInit() {\n    this.watchSettings();\n    this.watchInfo();\n\n    this.backgroundColor = this.configService.getItem('reader.theme') as string;\n    this.pageMode = this.configService.getItem('reader.pageMode') as string;\n   }\n\n   watchSettings() {\n    this.configService.listen('reader.theme').subscribe((theme: string) => {\n      this.backgroundColor = theme;\n    });\n\n    this.configService.listen('reader.pageMode').subscribe((pageMode: string) => {\n      this.pageMode = pageMode;\n    });\n  }\n\n  watchInfo() {\n    this.readerService.bookSubject.subscribe(book => {\n      this.bookName = book.name;\n    });\n\n    this.readerService.chapterSubject.subscribe(chapter => {\n      this.chapter = chapter;\n      // see: https://zhuanlan.zhihu.com/p/100038957\n      this.changeDetectorRef.detectChanges();\n    });\n    this.readerService.leftPageSubject.subscribe(leftPage => {\n      this.leftPage = leftPage;\n    });\n    this.readerService.rightPageSubject.subscribe(rightPage => {\n      this.rightPage = rightPage;\n      document.documentElement.click();\n    });\n  }\n\n}\n","<div\n  class=\"reader-background\"\n  [ngClass]=\"isSingleMode ? 'single' : ''\"\n  [ngStyle]=\"{'background-color': backgroundColor}\"\n>\n  <p class=\"progress-chapter-name\" [ngClass]=\"chapter\">{{chapter}}</p>\n  <p *ngIf=\"!isSingleMode\" class=\"progress-book-name\">{{bookName}}</p>\n  <p class=\"background-page-left\">第 {{leftPage}} 页</p>\n  <p *ngIf=\"!isSingleMode\" class=\"background-page-right\">第 {{rightPage}} 页</p>\n  <!-- <div class=\"background-box2\"></div>\n  <div class=\"background-box3\"></div> -->\n  <div class=\"background-box1\"></div>\n</div>\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { LibraryComponent } from './library.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LibraryComponent\n  }\n]\n\n\n@NgModule({\n  imports: [CommonModule, RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class LibraryRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport * as localforage from 'localforage';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { LibraryService } from '../library/services/library.service';\nimport { Book } from '../models/Book';\nimport { distinct } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ReaderService {\n  private ePub = (window as any).ePub;\n\n  public bookSubject: Subject<Book> = new Subject();\n  public currentBook: Book = null;\n\n  public currentEpub = null;\n\n  public tocSubject = new BehaviorSubject([]);\n  public flattenedToc = null;\n  public notes = [];\n  public bookmarks = [];\n\n  public chapterSubject = new BehaviorSubject('');\n  public leftPageSubject = new BehaviorSubject('');\n  public rightPageSubject = new BehaviorSubject('');\n\n  constructor(\n    private libraryService: LibraryService\n  ) {\n    this.bookSubject.pipe(distinct()).subscribe((book) => {\n      this.currentBook = book;\n    });\n  }\n\n  public async openBook(key: string);\n  public async openBook(url: string);\n  public async openBook(file: any) {\n    if (typeof file === 'string') {\n      this.currentEpub = this.ePub(await localforage.getItem(file));\n      this.bookSubject.next(await this.libraryService.getBook(file));\n    } else {\n      [this.currentEpub, this.currentBook] = await this.libraryService.importBookFile(file);\n      this.bookSubject.next(this.currentBook);\n    }\n    this.fetchChapters(this.currentEpub);\n    return this.currentEpub;\n  }\n\n  /* rendition utils */\n  public jump(href: string) {\n    this.currentEpub.rendition.display(href);\n  }\n\n  public prev(pageMode: string) {\n    if (pageMode === 'single' || pageMode === 'double') {\n      this.currentEpub.rendition.prev();\n    } else {\n      this.nextChapter(-1);\n    }\n  }\n\n  public next(pageMode: string) {\n    if (pageMode === 'single' || pageMode === 'double') {\n      this.currentEpub.rendition.next();\n    } else {\n      this.nextChapter();\n    }\n  }\n\n  public previousChapter() {\n    this.nextChapter(-1);\n  }\n\n  public nextChapter(step: number = 1) {\n    const currentLocation = this.currentEpub.rendition.currentLocation();\n    if (!currentLocation.start) {\n      return;\n    }\n    const chapterIndex = currentLocation.start.index;\n    const section = this.currentEpub.section(chapterIndex + step);\n    if (section && section.href) {\n      this.currentEpub.rendition.display(section.href);\n    }\n  }\n\n  /**\n   * navigation informations\n   * incluces: [chapters, bookmarks, notes]\n   */\n  private async fetchChapters(epub) {\n    epub.loaded.navigation\n      .then((chapters: any) => {\n        // this.toc = chapters.toc;\n        this.tocSubject.next(chapters.toc);\n        this.flattenedToc = flatChapter(chapters.toc);\n      })\n      .catch(() => {\n        console.log('Error occurs');\n      });\n  }\n\n  public touchCurrentChapter(epub) {\n    const currentLocation = epub.rendition.currentLocation();\n    if (!currentLocation.start) {\n      return;\n    }\n\n    this.leftPageSubject.next(currentLocation.start.displayed.page);\n    this.rightPageSubject.next(currentLocation.end.displayed.page);\n\n    const chapterHref = currentLocation.start.href;\n    let chapter = 'Unknown Chapter';\n    const chapterSbj = this.flattenedToc.filter(\n      (item: any) => item.href.split('#')[0] === chapterHref\n    )[0];\n    if (chapterSbj) {\n      chapter = chapterSbj.label.trim();\n    }\n    this.chapterSubject.next(chapter);\n  }\n\n  // settings\n\n  // public setPageMode(mode: 'single' | 'double' | 'scroll' | 'continuous') {\n  public setPageMode(mode: string) {\n    // todo\n    // const rendition = this.currentEpub.rendition;\n    // rendition.viewManager = rendition.requireManager(\n    //   mode === 'continuous' ? 'continuous' : 'default'\n    // );\n\n    // rendition.View = rendition.requireView(rendition.settings.view);\n\n    // rendition.manager = new rendition.ViewManager({\n    //   view: rendition.View,\n    //   queue: rendition.q,\n    //   request: rendition.book.load.bind(rendition.book),\n    //   settings: rendition.settings\n    // });\n\n    // const flow = mode === 'scroll'\n    //   ? 'scrolled-doc'\n    //   : mode === 'continuous'\n    //   ? 'scrolled'\n    //   : 'auto';\n    // // this.currentEpub.rendition.setManager(manager);\n    // this.currentEpub.rendition.flow(flow);\n  }\n\n  public setTheme(theme: string) { // backgorund color\n    // todo: 使用 inherit 后，使一些元素(比如 a, 链接和目录项)失去了原本的颜色\n    console.log('themes', this.currentEpub.rendition.themes);\n    this.currentEpub.rendition.themes.default({\n      'a, article, cite, code, div, li, p, pre, span, table': {\n        color: `${theme === 'rgba(44,47,49,1)' ? 'white' : 'inherit'} !important`,\n        // color: `${theme === 'rgba(44,47,49,1)' ? 'white!important' : 'inherit'}`,\n      },\n    });\n  }\n\n  public setFontSize(size: number) {\n    this.currentEpub.rendition.themes.default({\n      'a, article, cite, code, div, li, p, pre, span, table': {\n      'font-size': `${size || 17}px !important`,\n      },\n    });\n  }\n\n  public setFontFamily(fontFamily: string) {\n    this.currentEpub.rendition.themes.default({\n      'a, article, cite, code, div, li, p, pre, span, table': {\n        'font-family': `${fontFamily || 'Helvetica'} !important`,\n      },\n    });\n  }\n\n  public setLineHeight(lineHeight: number) {\n    this.currentEpub.rendition.themes.default({\n      'a, article, cite, code, div, li, p, pre, span, table': {\n        'line-height': `${lineHeight || '1.25'} !important`,\n      },\n    });\n  }\n\n  public setScale(scale: number) {\n    // todo\n  }\n\n  applySettings(epub, settings) {\n    const isUseFont = false;\n\n    epub.rendition.themes.default({\n      'a, article, cite, code, div, li, p, pre, span, table': {\n        'font-size': `${\n          // OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n          isUseFont\n            ? ''\n            : settings.fontSize || 17\n        }px !important`,\n        'line-height': `${\n          // OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n          isUseFont\n            ? ''\n            : settings.lineHeight || '1.25'\n        } !important`,\n        'font-family': `${\n          // OtherUtil.getReaderConfig(\"isUseFont\") === \"yes\"\n          isUseFont\n            ? ''\n            : settings.fontFamily || 'Helvetica'\n        } !important`,\n        color: `${\n          // OtherUtil.getReaderConfig(\"theme\") === \"rgba(44,47,49,1)\"\n          settings.theme === 'rgba(44,47,49,1)'\n            ? 'white'\n            : ''\n        } !important`,\n      },\n    });\n  }\n\n}\n\nfunction flatChapter(chapters: any) {\n  let newChapter: any = [];\n  for (const chapter of chapters) {\n    if (chapter.subitems[0]) {\n      newChapter.push(chapter);\n      newChapter = newChapter.concat(flatChapter(chapter.subitems));\n    } else {\n      newChapter.push(chapter);\n    }\n  }\n  return newChapter;\n}\n","import { Injectable } from '@angular/core';\nimport { ReaderService } from './reader.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MouseService {\n  private unbindEvent: () => void;\n\n  constructor(private readerService: ReaderService) { }\n\n  bind(epub: any, isScrollMode: boolean) {\n    const isFirefox = navigator.userAgent.indexOf('Firefox') !== -1;\n    let lock = false; // 暂时锁住翻页快捷键，避免快速点击产生的Bug\n    const arrowKeys = (event: any) => {\n      // event.preventDefault();\n      if (lock) {\n        return;\n      }\n\n      if (event.keyCode === 37 || (event.keyCode === 38 && !isScrollMode)) {\n        epub.rendition.prev();\n        lock = true;\n        setTimeout(() => {\n          lock = false;\n        }, 100);\n        return false;\n      }\n      if (event.keyCode === 39 || (event.keyCode === 40 && !isScrollMode)) {\n        epub.rendition.next();\n        lock = true;\n        setTimeout(() => {\n          lock = false;\n        }, 100);\n        return false;\n      }\n    };\n    const mouseFirefox = (event: any) => {\n      event.preventDefault();\n      if (lock) {\n        return;\n      }\n      if (event.detail < 0) {\n        epub.rendition.prev();\n        lock = true;\n        setTimeout(() => {\n          lock = false;\n        }, 100);\n        return false;\n      }\n      if (event.detail > 0) {\n        epub.rendition.next();\n        lock = true;\n        setTimeout(() => {\n          lock = false;\n        }, 100);\n        return false;\n      }\n    };\n\n    const mouseChrome = (event: any) => {\n      if (lock) {\n        return;\n      }\n      if (event.wheelDelta > 0) {\n        epub.rendition.prev();\n        lock = true;\n        setTimeout(() => {\n          lock = false;\n        }, 100);\n        return false;\n      }\n      if (event.wheelDelta < 0) {\n        epub.rendition.next();\n        lock = true;\n        setTimeout(() => {\n          lock = false;\n        }, 100);\n        return false;\n      }\n    };\n\n    // const gesture = (event: any) => {\n    //   if (lock) {\n    //     return;\n    //   }\n    //   if (event.type === 'panleft' || event.type === 'panup') {\n    //     epub.rendition.next();\n    //     lock = true;\n    //     setTimeout(() => {\n    //       lock = false;\n    //     }, 100);\n    //     return false;\n    //   }\n    //   if (event.type === 'panright' || event.type === 'pandown') {\n    //     epub.rendition.prev();\n    //     lock = true;\n    //     setTimeout(() => {\n    //       lock = false;\n    //     }, 100);\n    //     return false;\n    //   }\n    // };\n\n    const bindEvent = (doc: any) => {\n      window.addEventListener('keydown', arrowKeys);\n      doc.addEventListener('keydown', arrowKeys); // 箭头按键翻页\n      // 鼠标滚轮翻页\n      if (!isScrollMode) {\n        if (isFirefox) {\n          doc.addEventListener('DOMMouseScroll', mouseFirefox, false);\n        } else {\n          doc.addEventListener('mousewheel', mouseChrome, false);\n        }\n      }\n\n      this.unbindEvent = () => {\n        window.removeEventListener('keydown', arrowKeys);\n        doc.removeEventListener('keydown', arrowKeys); // 箭头按键翻页\n        // 鼠标滚轮翻页\n        if (isFirefox) {\n          doc.removeEventListener('DOMMouseScroll', mouseFirefox, false);\n        } else {\n          doc.removeEventListener('mousewheel', mouseChrome, false);\n        }\n      };\n    };\n\n    epub.rendition.on('rendered', () => {\n      const iframe = document.getElementsByTagName('iframe')[0];\n      if (!iframe){\n        return;\n      }\n      const doc = iframe.contentDocument;\n      if (!doc) {\n        return;\n      }\n\n      // if (OtherUtil.getReaderConfig('isTouch') === 'yes') {\n      //   const mc = new Hammer(doc);\n      //   mc.on('panleft panright panup pandown', (event: any) => {\n      //     gesture(event);\n      //   });\n      // }\n\n      if (this.unbindEvent) {\n        this.unbindEvent();\n      }\n      bindEvent(doc);\n    });\n  }\n\n  unbind() {\n    if (this.unbindEvent) {\n      this.unbindEvent();\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ImportBooksComponent } from '../import-books/import-books.component';\n\n@Component({\n  selector: 'app-lib-buttons',\n  templateUrl: './buttons.component.html',\n  styleUrls: ['./buttons.component.scss']\n})\nexport class ButtonsComponent implements OnInit {\n\n  constructor(\n    private dialog: MatDialog,\n  ) { }\n\n  ngOnInit(): void {\n  }\n\n  openImportDialog() {\n    this.dialog.open(ImportBooksComponent, {\n      hasBackdrop: false,\n      autoFocus: false,\n      width: 'calc(100vw - 460px)',\n      height: 'calc(100vh - 200px)',\n      maxWidth: '1000px',\n      maxHeight: '600px',\n    });\n  }\n}\n","<div class=\"lib-buttons\">\n  <div class=\"app-name\">Immerse</div>\n  <div class=\"buttons-right\">\n    <button mat-icon-button color=\"accent\" (click)=\"openImportDialog()\">\n      <mat-icon>note_add</mat-icon>\n    </button>\n  </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { ReaderService } from '../reader.service';\nimport { ConfigService } from 'src/app/config/config.service';\n\n@Component({\n  selector: 'app-reader-navigation',\n  templateUrl: './navigation.component.html',\n  styleUrls: ['./navigation.component.scss']\n})\nexport class NavigationComponent implements OnInit {\n  // public backgroundColor = '';\n  public isSearch = false;\n  public currentTab = 'contents';\n\n  public get bookName () { return this.readerService.currentBook ? this.readerService.currentBook.name : ''; }\n  public get author () { return this.readerService.currentBook ? this.readerService.currentBook.author : ''; }\n\n  constructor(\n    // private configService: ConfigService,\n    public readerService: ReaderService\n  ) { }\n\n  ngOnInit(): void {\n    // this.backgroundColor = this.configService.getItem('reader.theme') as string;\n    // this.configService.listen('reader.theme').subscribe((theme: string) => {\n    //   this.backgroundColor = theme;\n    // });\n  }\n\n  changeTab(tab: string) {}\n\n}\n","<div class=\"reader-navigation\">\n  <ng-template [ngIf]=\"isSearch\" [ngIfElse]=\"nav\">\n    <span\n      class=\"icon-close nav-close-icon\"\n    ></span>\n    <div\n      class=\"header-search-container\"\n      [ngStyle]=\"isSearch ? { left: 40 } : {}\"\n    >\n      <div\n        class=\"navigation-search-title\"\n        [ngStyle]=\"{height: '20px', margin: '0px 25px 13px'}\"\n      >\n        Search the book\n      </div>\n      <!-- <SearchBox {...searchProps} /> -->\n    </div>\n    <ul class=\"nav-search-list\">\n      <!-- {this.state.searchList ? this.renderSearchList() : null} -->\n    </ul>\n    <ul class=\"nav-search-page\">\n      <!-- {this.state.searchList ? this.renderSearchPage() : null} -->\n    </ul>\n  </ng-template>\n\n  <ng-template #nav>\n    <div class=\"navigation-header\">\n      <!-- <img class=\"book-cover\" src={this.state.cover} alt=\"\" /> -->\n      <p class=\"book-title\">{{bookName}}</p>\n      <p class=\"book-arthur\">\n        Author: {{author}}\n        <!-- <Trans>\n        </Trans> -->\n      </p>\n      <span class=\"reading-duration\">\n        <!-- <Trans>Reading Time</Trans>: {Math.floor(this.props.time / 60)}\n        &nbsp;\n        <Trans>Minute</Trans> -->\n      </span>\n      <div class=\"navigation-search-box\">\n        <!-- <SearchBox {...searchProps} /> -->\n      </div>\n\n      <div class=\"navigation-navigation\">\n        <span\n          class=\"book-content-title\"\n          [ngStyle]=\"currentTab === 'contents' ? { color: 'rgba(112, 112, 112, 1)' } : { color: 'rgba(217, 217, 217, 1)' }\"\n          (click)=\"changeTab('contents')\"\n        >\n          <!-- <Trans>Content</Trans> -->\n          Contents\n        </span>\n        <span\n          class=\"book-bookmark-title\"\n          [ngStyle]=\"currentTab === 'bookmarks' ? { color: 'rgba(112, 112, 112, 1)' } : { color: 'rgba(217, 217, 217, 1)' }\"\n          (click)=\"changeTab('bookmarks')\"\n        >\n          <!-- <Trans>Bookmark</Trans> -->\n          Bookmark\n        </span>\n        <span\n          class=\"book-bookmark-title\"\n          [ngStyle]=\"currentTab === 'notes' ? { color: 'rgba(112, 112, 112, 1)' } : { color: 'rgba(217, 217, 217, 1)' }\"\n          (click)=\"changeTab('notes')\"\n        >\n          <!-- <Trans>Note</Trans> -->\n          Notes\n        </span>\n        <span\n          class=\"book-bookmark-title\"\n          [ngStyle]=\"currentTab === 'digest' ? { color: 'rgba(112, 112, 112, 1)' } : { color: 'rgba(217, 217, 217, 1)' }\"\n          (click)=\"changeTab('digest')\"\n        >\n          <!-- <Trans>Digest</Trans> -->\n          Digests\n        </span>\n      </div>\n    </div>\n    <div class=\"navigation-body-parent\">\n      <div class=\"navigation-body\">\n        <app-reader-toc></app-reader-toc>\n        <!-- {this.state.currentTab === \"contents\" ? (\n          <ContentList />\n        ) : (\n          <BookNavList {...bookmarkProps} />\n        )} -->\n      </div>\n    </div>\n  </ng-template>\n</div>\n\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { LibraryRoutingModule } from './library/library-routing.module';\nimport { ReaderRoutingModule } from './reader/reader-routing.module';\n\n\nconst routes: Routes = [];\n\n@NgModule({\n  imports: [\n    RouterModule.forRoot(routes),\n    LibraryRoutingModule,\n    ReaderRoutingModule\n  ],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { LibraryComponent } from './library.component';\nimport { BookCardsComponent } from './book-cards/book-cards.component';\nimport { FiltersComponent } from './filters/filters.component';\nimport { ButtonsComponent } from './buttons/buttons.component';\nimport { ImportBooksComponent } from './import-books/import-books.component';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { NgxFileDropModule } from 'ngx-file-drop';\n\n@NgModule({\n  declarations: [LibraryComponent, BookCardsComponent, ButtonsComponent, FiltersComponent, ImportBooksComponent],\n  imports: [\n    CommonModule,\n    MatButtonModule,\n    MatIconModule,\n    MatDialogModule,\n    MatProgressBarModule,\n    NgxFileDropModule\n  ]\n})\nexport class LibraryModule { }\n","import { ReadingLocationService } from '../reader/reading-location.service';\n\nexport class ReadingProgress {\n  constructor(\n    public percentage: number = null,\n    public locations: any = null\n  ) {}\n\n  restorePercentage(rlService: ReadingLocationService, book: { key: string }) {\n    this.percentage = rlService.getCfi(book.key).percentage;\n  }\n\n  fetchLocations(epub: any) {\n    epub.locations\n      .generate()\n      .then(() => {\n        this.locations = epub.locations;\n      })\n      .catch(() => {\n        console.log('Error occurs');\n      });\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ReaderComponent } from './reader.component';\n\nconst routes: Routes = [\n  {\n    path: 'reader/:key',\n    component: ReaderComponent\n  }\n];\n\n@NgModule({\n  imports: [CommonModule, RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class ReaderRoutingModule { }\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}